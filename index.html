<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YasarAI V8 MEGA Premium - 50+ Optimize Ä°ndikatÃ¶r + 8 Strateji + 7 Borsa + 15 Feature</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a1e 0%, #1a1a3e 25%, #2d1b4e 50%, #1a1a3e 75%, #0a0a1e 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: #fff;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(78, 205, 196, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(255, 107, 107, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                url('https://images.unsplash.com/photo-1605559424843-9e4c228bf1c2?w=1920&q=80'),
                url('https://images.unsplash.com/photo-1544636331-e85579c401d5?w=1920&q=80'),
                url('https://images.unsplash.com/photo-1542362567-b07e54358753?w=1920&q=80');
            background-size: cover;
            background-position: center;
            background-blend-mode: overlay;
            opacity: 0.08;
            filter: blur(2px) brightness(0.5);
            pointer-events: none;
            z-index: 0;
            animation: carBackgroundShift 20s ease-in-out infinite;
        }

        @keyframes carBackgroundShift {
            0%, 33% { background-image: url('https://images.unsplash.com/photo-1605559424843-9e4c228bf1c2?w=1920&q=80'); }
            34%, 66% { background-image: url('https://images.unsplash.com/photo-1544636331-e85579c401d5?w=1920&q=80'); }
            67%, 100% { background-image: url('https://images.unsplash.com/photo-1542362567-b07e54358753?w=1920&q=80'); }
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            padding: 40px 0;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-radius: 24px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            animation: slideInDown 0.6s ease-out;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .language-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .lang-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: bold;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .lang-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .lang-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }

        .lang-btn.active {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #000;
            border-color: #ffd700;
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
            transform: scale(1.05);
        }

        .header h1 {
            font-size: 3em;
            background: linear-gradient(135deg, #ffd700 0%, #ff6b6b 33%, #4ecdc4 66%, #9b59b6 100%);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            animation: gradientText 5s ease infinite;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            position: relative;
            font-weight: 800;
            letter-spacing: 2px;
        }

        @keyframes gradientText {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Premium Icon Hover Effects */
        .premium-icon {
            position: relative;
            cursor: pointer;
        }

        .premium-icon:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.4);
            animation: iconPulse 1.5s ease-in-out infinite;
        }

        @keyframes iconPulse {
            0%, 100% { transform: translateY(-5px) scale(1.1); }
            50% { transform: translateY(-8px) scale(1.15); }
        }

        /* Luxury Car Card Effects */
        .luxury-car-card:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.5);
            border-color: rgba(255, 255, 255, 0.6);
        }

        .luxury-car-card img {
            transition: transform 0.5s ease;
        }

        .luxury-car-card:hover img {
            transform: scale(1.1);
        }

        /* === YENÄ° 15 FEATURE CSS'LERÄ° === */
        .new-features-nav {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .new-feature-btn {
            padding: 10px 18px;
            background: rgba(255, 215, 0, 0.08);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: bold;
            color: #ffd700;
            position: relative;
            overflow: hidden;
        }

        .new-feature-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .new-feature-btn:hover::before {
            width: 200px;
            height: 200px;
        }

        .new-feature-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: scale(1.08) translateY(-2px);
            box-shadow: 0 8px 16px rgba(255, 215, 0, 0.3);
        }

        .new-feature-btn.active {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 107, 107, 0.3));
            border-color: rgba(255, 215, 0, 0.6);
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
            transform: scale(1.05);
        }

        .new-feature-content {
            display: none;
            background: rgba(0, 0, 0, 0.4);
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            border: 2px solid rgba(255, 215, 0, 0.2);
        }

        .new-feature-content.active {
            display: block;
        }

        /* Heatmap */
        .heatmap-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
            margin-bottom: 30px;
        }

        .heatmap-cell {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .heatmap-positive { background: rgba(76, 175, 80, 0.8); }
        .heatmap-negative { background: rgba(244, 67, 54, 0.8); }

        /* Smart Money */
        .smart-money-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .smart-money-card {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #4ecdc4;
        }

        /* Liquidation */
        .liquidation-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .liq-item {
            background: rgba(255, 107, 107, 0.1);
            padding: 15px;
            border-left: 4px solid #ff6b6b;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
        }

        /* Fear & Greed */
        .fear-greed-meter {
            width: 100%;
            height: 40px;
            background: linear-gradient(90deg, #f44336, #ff9800, #ffd700, #8bc34a, #4caf50);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            margin: 20px 0;
        }

        .fear-greed-pointer {
            position: absolute;
            top: 0;
            width: 4px;
            height: 100%;
            background: #fff;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        }

        .header p {
            color: #aaa;
            font-size: 1.1em;
        }

        .api-status {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .api-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .api-connected {
            background: rgba(78, 205, 196, 0.3);
            border: 1px solid #4ecdc4;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 18px 35px;
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }

        .nav-tab::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: linear-gradient(90deg, #ffd700, #4ecdc4);
            transform: translateX(-50%);
            transition: width 0.4s ease;
        }

        .nav-tab:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 107, 107, 0.2));
            border-color: rgba(255, 215, 0, 0.5);
            box-shadow: 0 8px 32px rgba(255, 215, 0, 0.3);
            transform: translateY(-2px);
        }

        .nav-tab.active::after {
            width: 80%;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #ffd700;
        }

        .timeframe-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .timeframe-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }

        .timeframe-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(78, 205, 196, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .timeframe-btn:hover::before {
            width: 200px;
            height: 200px;
        }

        .timeframe-btn:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }

        .timeframe-btn.active {
            background: linear-gradient(135deg, #4ecdc4, #2a9d8f);
            border-color: #4ecdc4;
            box-shadow: 0 4px 20px rgba(78, 205, 196, 0.4);
            transform: scale(1.05);
        }

        .scan-button {
            width: 100%;
            padding: 25px;
            font-size: 1.6em;
            font-weight: 800;
            background: linear-gradient(135deg, #ff6b6b 0%, #ffd700 50%, #4ecdc4 100%);
            background-size: 200% 200%;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            color: #000;
            margin: 30px 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(255, 215, 0, 0.3);
            animation: buttonGlow 3s ease infinite;
            letter-spacing: 1px;
        }

        .scan-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .scan-button:hover::before {
            width: 400px;
            height: 400px;
        }

        .scan-button:hover {
            transform: scale(1.03) translateY(-3px);
            box-shadow: 0 20px 60px rgba(255, 215, 0, 0.5);
            background-position: 100% 50%;
        }

        .scan-button:active {
            transform: scale(0.98);
        }

        .scan-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            animation: none;
        }

        @keyframes buttonGlow {
            0%, 100% { 
                box-shadow: 0 10px 40px rgba(255, 215, 0, 0.3);
            }
            50% { 
                box-shadow: 0 10px 50px rgba(255, 215, 0, 0.5);
            }
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px) saturate(180%);
            padding: 25px;
            border-radius: 18px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.4);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #4ecdc4;
        }

        .stat-label {
            color: #aaa;
            margin-top: 10px;
        }

        .strategy-card {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .strategy-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .strategy-icon {
            font-size: 2em;
        }

        .indicator-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .category-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px) saturate(180%);
            padding: 25px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.25);
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        .category-title {
            font-size: 1.2em;
            font-weight: bold;
        }

        .category-count {
            background: #ffd700;
            color: #000;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .indicator-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .indicator-item {
            padding: 10px;
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        .exchange-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .exchange-card {
            padding: 25px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 18px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .exchange-card::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .exchange-card:hover::before {
            width: 300px;
            height: 300px;
        }

        .exchange-card:hover {
            border-color: rgba(255, 215, 0, 0.5);
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 16px 48px rgba(255, 215, 0, 0.3);
        }

        .exchange-card.active {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(255, 107, 107, 0.15));
            border-color: rgba(255, 215, 0, 0.6);
            box-shadow: 0 12px 40px rgba(255, 215, 0, 0.4);
            transform: scale(1.05);
        }

        .exchange-logo {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .results-container {
            display: grid;
            gap: 20px;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px) saturate(180%);
            padding: 30px;
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.6s ease-out;
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .result-card:hover::before {
            left: 100%;
        }

        .result-card:hover {
            border-color: rgba(255, 215, 0, 0.8);
            transform: translateY(-15px) scale(1.03);
            box-shadow: 
                0 25px 70px rgba(255, 215, 0, 0.4),
                0 0 30px rgba(255, 215, 0, 0.3),
                inset 0 0 20px rgba(255, 215, 0, 0.1);
            cursor: pointer;
            animation: pulse 0.5s ease-out;
        }

        /* DetaylÄ± Coin Analiz Modal */
        .coin-detail-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            z-index: 10000;
            overflow-y: auto;
            animation: fadeIn 0.3s ease;
        }

        .coin-detail-modal.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            max-width: 1600px;
            margin: 20px auto;
            padding: 30px;
            background: rgba(26, 26, 62, 0.95);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.5);
            position: relative;
            animation: slideUp 0.4s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(255, 107, 107, 0.2);
            border: 2px solid #ff6b6b;
            border-radius: 50%;
            color: #ff6b6b;
            font-size: 1.5em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: #ff6b6b;
            color: white;
            transform: rotate(90deg);
        }

        .detail-section {
            background: rgba(0, 0, 0, 0.3);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 4px solid #ffd700;
        }

        .detail-title {
            font-size: 1.8em;
            color: #ffd700;
            margin-bottom: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .fibonacci-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .fib-level {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            border-left: 3px solid;
            transition: all 0.3s;
        }

        .fib-level:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .fib-236 { border-left-color: #ff6b6b; }
        .fib-382 { border-left-color: #ff9500; }
        .fib-500 { border-left-color: #ffd700; }
        .fib-618 { border-left-color: #4ecdc4; }
        .fib-786 { border-left-color: #9b59b6; }

        .trade-level {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 2px solid;
            transition: all 0.3s;
        }

        .trade-level:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
        }

        .level-entry { border-color: #4ecdc4; }
        .level-tp { border-color: #4ecdc4; }
        .level-sl { border-color: #ff6b6b; }

        .indicator-summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .indicator-summary-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid;
            text-align: center;
        }

        .summary-long { border-color: #4ecdc4; background: rgba(78, 205, 196, 0.1); }
        .summary-neutral { border-color: #ffd700; background: rgba(255, 215, 0, 0.1); }
        .summary-short { border-color: #ff6b6b; background: rgba(255, 107, 107, 0.1); }

        .summary-number {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }

        .summary-label {
            font-size: 1.1em;
            opacity: 0.8;
            margin-top: 10px;
        }

        /* LONG ve SHORT AyrÄ± BÃ¶lÃ¼mler */
        .results-sections {
            display: flex;
            flex-direction: column;
            gap: 40px;
            margin-top: 20px;
        }

        .result-section {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .long-section {
            border-color: rgba(78, 205, 196, 0.5);
            background: linear-gradient(135deg, rgba(78, 205, 196, 0.1), rgba(44, 160, 141, 0.05));
        }

        .short-section {
            border-color: rgba(255, 107, 107, 0.5);
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(231, 76, 60, 0.05));
        }

        .wait-section {
            border-color: rgba(255, 215, 0, 0.5);
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 193, 7, 0.05));
        }

        .section-header {
            text-align: center;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .long-header {
            background: rgba(78, 205, 196, 0.15);
            border: 2px solid rgba(78, 205, 196, 0.4);
        }

        .short-header {
            background: rgba(255, 107, 107, 0.15);
            border: 2px solid rgba(255, 107, 107, 0.4);
        }

        .wait-header {
            background: rgba(255, 215, 0, 0.15);
            border: 2px solid rgba(255, 215, 0, 0.4);
        }

        .section-header h2 {
            font-size: 2.5em;
            margin-bottom: 15px;
            font-weight: bold;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .long-header h2 {
            color: #4ecdc4;
        }

        .short-header h2 {
            color: #ff6b6b;
        }

        .wait-header h2 {
            color: #ffd700;
        }

        .section-count {
            font-size: 1.5em;
            font-weight: bold;
            margin: 15px 0;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: inline-block;
        }

        .long-header .section-count {
            color: #4ecdc4;
            border: 2px solid rgba(78, 205, 196, 0.5);
        }

        .short-header .section-count {
            color: #ff6b6b;
            border: 2px solid rgba(255, 107, 107, 0.5);
        }

        .wait-header .section-count {
            color: #ffd700;
            border: 2px solid rgba(255, 215, 0, 0.5);
        }

        .section-description {
            font-size: 1em;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 10px;
            font-style: italic;
        }

        /* MODERN ANÄ°MASYONLAR VE EFEKTLER */
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes glow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(255, 215, 0, 0.3),
                            0 0 40px rgba(255, 215, 0, 0.2),
                            0 0 60px rgba(255, 215, 0, 0.1);
            }
            50% {
                box-shadow: 0 0 30px rgba(255, 215, 0, 0.5),
                            0 0 60px rgba(255, 215, 0, 0.4),
                            0 0 90px rgba(255, 215, 0, 0.3);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes shimmerText {
            0% { background-position: 0% center; }
            100% { background-position: 200% center; }
        }

        @keyframes rotateGlow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        @keyframes numberCount {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* Result Card AnimasyonlarÄ± */
        .result-card {
            animation: fadeInUp 0.6s ease-out backwards;
        }

        .result-card:nth-child(1) { animation-delay: 0.1s; }
        .result-card:nth-child(2) { animation-delay: 0.2s; }
        .result-card:nth-child(3) { animation-delay: 0.3s; }
        .result-card:nth-child(4) { animation-delay: 0.4s; }
        .result-card:nth-child(5) { animation-delay: 0.5s; }
        .result-card:nth-child(n+6) { animation-delay: 0.6s; }

        /* Section AnimasyonlarÄ± */
        .result-section {
            animation: slideInRight 0.8s ease-out;
        }

        .long-section {
            animation-delay: 0.1s;
        }

        .short-section {
            animation-delay: 0.3s;
        }

        /* Pulse Efektleri */
        .section-header h2 {
            animation: pulse 2s ease-in-out infinite;
        }

        .section-count {
            animation: numberCount 1s ease-out;
        }

        /* Glow Efektleri */
        .long-header {
            animation: glow 3s ease-in-out infinite;
        }

        .short-header {
            animation: glow 3s ease-in-out infinite 1.5s;
        }

        /* Float Animasyonu */
        .stat-card {
            animation: float 3s ease-in-out infinite;
        }

        .stat-card:nth-child(2) { animation-delay: 0.5s; }
        .stat-card:nth-child(3) { animation-delay: 1s; }
        .stat-card:nth-child(4) { animation-delay: 1.5s; }

        /* Scan Button Ã–zel Animasyon */
        .scan-button {
            position: relative;
            overflow: hidden;
        }

        .scan-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .scan-button:hover::before {
            width: 300px;
            height: 300px;
        }

        .scan-button:active {
            animation: pulse 0.3s;
        }

        /* Loading Spinner GeliÅŸmiÅŸ */
        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 215, 0, 0.2);
            border-top-color: #ffd700;
            border-radius: 50%;
            animation: spin 1s linear infinite, glow 2s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Progress Bar Animasyon */
        .progress-bar {
            transition: width 0.5s ease-out;
            background: linear-gradient(90deg, #ffd700, #4ecdc4, #ffd700);
            background-size: 200% 100%;
            animation: shimmerProgress 2s linear infinite;
        }

        @keyframes shimmerProgress {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Indicator Summary Cards Animasyon */
        .indicator-summary-card {
            transition: all 0.3s ease;
            animation: fadeInUp 0.8s ease-out backwards;
        }

        .indicator-summary-card:nth-child(1) { animation-delay: 0.2s; }
        .indicator-summary-card:nth-child(2) { animation-delay: 0.4s; }
        .indicator-summary-card:nth-child(3) { animation-delay: 0.6s; }

        .indicator-summary-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 20px 40px rgba(255, 215, 0, 0.4);
        }

        /* Summary Number Animasyon */
        .summary-number {
            animation: numberCount 1.5s ease-out, pulse 2s ease-in-out infinite 1.5s;
        }

        /* Detail Section Animasyon */
        .detail-section {
            animation: fadeInUp 0.6s ease-out;
        }

        .detail-section:nth-child(1) { animation-delay: 0.1s; }
        .detail-section:nth-child(2) { animation-delay: 0.2s; }
        .detail-section:nth-child(3) { animation-delay: 0.3s; }
        .detail-section:nth-child(4) { animation-delay: 0.4s; }

        /* Fibonacci Levels Animasyon */
        .fib-level {
            animation: fadeInUp 0.5s ease-out backwards;
        }

        .fib-level:nth-child(1) { animation-delay: 0.1s; }
        .fib-level:nth-child(2) { animation-delay: 0.2s; }
        .fib-level:nth-child(3) { animation-delay: 0.3s; }
        .fib-level:nth-child(4) { animation-delay: 0.4s; }
        .fib-level:nth-child(5) { animation-delay: 0.5s; }

        /* Trade Level Animasyon */
        .trade-level {
            animation: slideInRight 0.5s ease-out backwards;
        }

        .trade-level:nth-child(1) { animation-delay: 0.1s; }
        .trade-level:nth-child(2) { animation-delay: 0.2s; }
        .trade-level:nth-child(3) { animation-delay: 0.3s; }
        .trade-level:nth-child(4) { animation-delay: 0.4s; }
        .trade-level:nth-child(5) { animation-delay: 0.5s; }

        /* Master Signal Animasyon */
        .master-signal {
            animation: fadeInUp 0.8s ease-out, glow 3s ease-in-out infinite 1s;
        }

        /* Result Card Grid Animasyon */
        .results-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 25px;
            animation: fadeIn 0.5s ease-out;
        }

        /* Modal AnimasyonlarÄ± */
        .modal-content {
            animation: fadeInUp 0.5s ease-out, glow 4s ease-in-out infinite 0.5s;
        }

        /* Nav Tab Hover Animasyon */
        .nav-tab {
            position: relative;
            overflow: hidden;
        }

        .nav-tab::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: linear-gradient(90deg, #ffd700, #4ecdc4);
            transform: translateX(-50%);
            transition: width 0.3s ease;
        }

        .nav-tab:hover::after,
        .nav-tab.active::after {
            width: 80%;
        }

        /* Stat Card Hover */
        .stat-card:hover {
            transform: translateY(-15px) scale(1.05);
            box-shadow: 0 20px 60px rgba(255, 215, 0, 0.4);
            animation: pulse 0.5s ease-out;
        }

        /* Coin Header Animasyon */
        .coin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        .coin-name {
            font-size: 1.8em;
            font-weight: bold;
        }

        .coin-price {
            font-size: 1.4em;
            color: #4ecdc4;
            font-weight: bold;
        }

        .price-change {
            font-size: 0.9em;
            margin-top: 5px;
        }

        .price-up {
            color: #4ecdc4;
        }

        .price-down {
            color: #ff6b6b;
        }

        .master-signal {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            border: 3px solid;
        }

        .signal-long {
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.1);
        }

        .signal-short {
            border-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
        }

        .signal-neutral {
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }

        .signal-title {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .trade-setup {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .setup-title {
            font-size: 1.3em;
            color: #ffd700;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .setup-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .setup-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
        }

        .setup-label {
            color: #aaa;
            font-size: 0.85em;
            margin-bottom: 5px;
        }

        .setup-value {
            font-size: 1.2em;
            font-weight: bold;
        }

        .value-long {
            color: #4ecdc4;
        }

        .value-short {
            color: #ff6b6b;
        }

        .value-neutral {
            color: #ffd700;
        }

        .indicator-signals {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .signals-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .signal-column {
            padding: 15px;
            border-radius: 10px;
        }

        .signal-buy {
            background: rgba(78, 205, 196, 0.2);
            border: 2px solid #4ecdc4;
        }

        .signal-sell {
            background: rgba(255, 107, 107, 0.2);
            border: 2px solid #ff6b6b;
        }

        .signal-wait {
            background: rgba(255, 215, 0, 0.2);
            border: 2px solid #ffd700;
        }

        .signal-column h4 {
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .signal-list {
            list-style: none;
            font-size: 0.9em;
            line-height: 1.8;
        }

        .fibonacci-levels {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .fib-level {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border-left: 3px solid;
        }

        .fib-level.support {
            border-left-color: #4ecdc4;
        }

        .fib-level.resistance {
            border-left-color: #ff6b6b;
        }

        .market-participants {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .participant-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        .participant-name {
            font-weight: bold;
        }

        .participant-action {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .action-buying {
            background: rgba(78, 205, 196, 0.3);
            color: #4ecdc4;
        }

        .action-selling {
            background: rgba(255, 107, 107, 0.3);
            color: #ff6b6b;
        }

        .action-neutral {
            background: rgba(255, 215, 0, 0.3);
            color: #ffd700;
        }

        .ai-analysis {
            background: linear-gradient(135deg, rgba(138, 43, 226, 0.3), rgba(0, 0, 0, 0.5));
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 2px solid rgba(138, 43, 226, 0.5);
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        .ai-logo {
            font-size: 2.5em;
        }

        .ai-content {
            line-height: 1.8;
            font-size: 1.05em;
        }

        .ai-recommendation {
            background: rgba(255, 215, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #ffd700;
            margin-top: 15px;
            font-weight: bold;
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.5em;
        }

        .spinner {
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top: 5px solid #ffd700;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #ffd700;
            border-radius: 10px;
        }

        @media (max-width: 768px) {
            .signals-grid {
                grid-template-columns: 1fr;
            }
            .header h1 {
                font-size: 1.8em;
            }
            .language-selector {
                position: relative;
                top: 0;
                right: 0;
                justify-content: center;
                margin-bottom: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="language-selector">
                <button class="lang-btn active" onclick="changeLanguage('tr', event)">ðŸ‡¹ðŸ‡· TR</button>
                <button class="lang-btn" onclick="changeLanguage('de', event)">ðŸ‡©ðŸ‡ª DE</button>
            </div>
            
            <!-- Premium Header Section -->
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                <!-- Sol Taraf: Para ve Ã–dÃ¼ller -->
                <div style="display: flex; align-items: center; gap: 15px; flex: 1; justify-content: center; min-width: 300px;">
                    <div style="display: flex; gap: 12px; align-items: center;">
                        <div class="premium-icon" style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1)); border: 2px solid rgba(255, 215, 0, 0.5); padding: 12px; border-radius: 12px; backdrop-filter: blur(10px); transition: all 0.3s;">
                            <div style="font-size: 2em; filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6));">ðŸ’°</div>
                        </div>
                        <div class="premium-icon" style="background: linear-gradient(135deg, rgba(78, 205, 196, 0.2), rgba(78, 205, 196, 0.1)); border: 2px solid rgba(78, 205, 196, 0.5); padding: 12px; border-radius: 12px; backdrop-filter: blur(10px); transition: all 0.3s;">
                            <div style="font-size: 2em; filter: drop-shadow(0 0 10px rgba(78, 205, 196, 0.6));">ðŸ’¶</div>
                        </div>
                        <div class="premium-icon" style="background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(255, 107, 107, 0.1)); border: 2px solid rgba(255, 107, 107, 0.5); padding: 12px; border-radius: 12px; backdrop-filter: blur(10px); transition: all 0.3s;">
                            <div style="font-size: 2em; filter: drop-shadow(0 0 10px rgba(255, 107, 107, 0.6));">ðŸ’·</div>
                        </div>
                        <div class="premium-icon" style="background: linear-gradient(135deg, rgba(255, 149, 0, 0.2), rgba(255, 149, 0, 0.1)); border: 2px solid rgba(255, 149, 0, 0.5); padding: 12px; border-radius: 12px; backdrop-filter: blur(10px); transition: all 0.3s;">
                            <div style="font-size: 2em; filter: drop-shadow(0 0 10px rgba(255, 149, 0, 0.6));">â‚¿</div>
                        </div>
                    </div>
                </div>
                
                <!-- Orta: BaÅŸlÄ±k -->
                <div style="flex: 1; text-align: center; min-width: 300px;">
                    <h1 style="margin: 0; font-size: 2.8em; background: linear-gradient(135deg, #ffd700 0%, #ff6b6b 33%, #4ecdc4 66%, #9b59b6 100%); background-size: 300% 300%; -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; animation: gradientText 5s ease infinite; font-weight: 800; letter-spacing: 3px; text-shadow: 0 0 40px rgba(255, 215, 0, 0.4);">YasarAI V8 MEGA</h1>
                </div>
                
                <!-- SaÄŸ Taraf: Ã–dÃ¼ller -->
                <div style="display: flex; align-items: center; gap: 15px; flex: 1; justify-content: center; min-width: 300px;">
                    <div style="display: flex; gap: 12px; align-items: center;">
                        <div class="premium-icon" style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1)); border: 2px solid rgba(255, 215, 0, 0.5); padding: 12px; border-radius: 12px; backdrop-filter: blur(10px); transition: all 0.3s;">
                            <div style="font-size: 2em; filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6));">ðŸ¥‡</div>
                        </div>
                        <div class="premium-icon" style="background: linear-gradient(135deg, rgba(155, 89, 182, 0.2), rgba(155, 89, 182, 0.1)); border: 2px solid rgba(155, 89, 182, 0.5); padding: 12px; border-radius: 12px; backdrop-filter: blur(10px); transition: all 0.3s;">
                            <div style="font-size: 2em; filter: drop-shadow(0 0 10px rgba(155, 89, 182, 0.6));">ðŸ’Ž</div>
                        </div>
                        <div class="premium-icon" style="background: linear-gradient(135deg, rgba(78, 205, 196, 0.2), rgba(78, 205, 196, 0.1)); border: 2px solid rgba(78, 205, 196, 0.5); padding: 12px; border-radius: 12px; backdrop-filter: blur(10px); transition: all 0.3s;">
                            <div style="font-size: 2em; filter: drop-shadow(0 0 10px rgba(78, 205, 196, 0.6));">âš¡</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- LÃ¼ks AraÃ§lar Galerisi -->
            <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
                <div class="luxury-car-card" style="background: linear-gradient(135deg, rgba(78, 205, 196, 0.15), rgba(44, 160, 141, 0.1)); border: 2px solid rgba(78, 205, 196, 0.4); border-radius: 16px; padding: 15px; backdrop-filter: blur(15px); overflow: hidden; position: relative; width: 150px; height: 100px; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);">
                    <img src="https://images.pexels.com/photos/1545743/pexels-photo-1545743.jpeg?auto=compress&cs=tinysrgb&w=400" 
                         alt="Audi RS Q8" 
                         style="width: 100%; height: 100%; object-fit: cover; border-radius: 12px; filter: brightness(1.1) contrast(1.2);"
                         onerror="this.src='https://images.unsplash.com/photo-1605559424843-9e4c228bf1c2?w=400&q=80'">
                    <div style="position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.7); padding: 4px 10px; border-radius: 8px; font-size: 0.7em; color: #4ecdc4; font-weight: bold; backdrop-filter: blur(10px);">AUDI RS Q8</div>
                </div>
                <div class="luxury-car-card" style="background: linear-gradient(135deg, rgba(255, 107, 107, 0.15), rgba(231, 76, 60, 0.1)); border: 2px solid rgba(255, 107, 107, 0.4); border-radius: 16px; padding: 15px; backdrop-filter: blur(15px); overflow: hidden; position: relative; width: 150px; height: 100px; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);">
                    <img src="https://images.pexels.com/photos/120049/pexels-photo-120049.jpeg?auto=compress&cs=tinysrgb&w=400" 
                         alt="Lamborghini" 
                         style="width: 100%; height: 100%; object-fit: cover; border-radius: 12px; filter: brightness(1.1) contrast(1.2);"
                         onerror="this.src='https://images.unsplash.com/photo-1544636331-e85579c401d5?w=400&q=80'">
                    <div style="position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.7); padding: 4px 10px; border-radius: 8px; font-size: 0.7em; color: #ff6b6b; font-weight: bold; backdrop-filter: blur(10px);">LAMBORGHINI</div>
                </div>
                <div class="luxury-car-card" style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(255, 193, 7, 0.1)); border: 2px solid rgba(255, 215, 0, 0.4); border-radius: 16px; padding: 15px; backdrop-filter: blur(15px); overflow: hidden; position: relative; width: 150px; height: 100px; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);">
                    <img src="https://images.pexels.com/photos/337909/pexels-photo-337909.jpeg?auto=compress&cs=tinysrgb&w=400" 
                         alt="Ferrari" 
                         style="width: 100%; height: 100%; object-fit: cover; border-radius: 12px; filter: brightness(1.1) contrast(1.2);"
                         onerror="this.src='https://images.unsplash.com/photo-1542362567-b07e54358753?w=400&q=80'">
                    <div style="position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.7); padding: 4px 10px; border-radius: 8px; font-size: 0.7em; color: #ffd700; font-weight: bold; backdrop-filter: blur(10px);">FERRARI</div>
                </div>
                <div class="luxury-car-card" style="background: linear-gradient(135deg, rgba(155, 89, 182, 0.15), rgba(142, 68, 173, 0.1)); border: 2px solid rgba(155, 89, 182, 0.4); border-radius: 16px; padding: 15px; backdrop-filter: blur(15px); overflow: hidden; position: relative; width: 150px; height: 100px; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);">
                    <img src="https://images.pexels.com/photos/1545743/pexels-photo-1545743.jpeg?auto=compress&cs=tinysrgb&w=400" 
                         alt="Porsche" 
                         style="width: 100%; height: 100%; object-fit: cover; border-radius: 12px; filter: brightness(1.1) contrast(1.2);"
                         onerror="this.src='https://images.unsplash.com/photo-1542362567-b07e54358753?w=400&q=80'">
                    <div style="position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.7); padding: 4px 10px; border-radius: 8px; font-size: 0.7em; color: #9b59b6; font-weight: bold; backdrop-filter: blur(10px);">PORSCHE</div>
                </div>
            </div>
            <p style="margin-top: 10px;">V8 Premium (50+ Optimize Ä°ndikatÃ¶r | 8 Strateji | 7 Borsa) + 15 YENÄ° FEATURE | Fear & Greed</p>
            <div style="margin-top: 5px; font-size: 0.85em; color: #4ecdc4;">
                âš¡ Gereksiz tekrarlar Ã§Ä±karÄ±ldÄ± | Sadece en gÃ¼venilir indikatÃ¶rler | HatalÄ± sinyal riski minimum
            </div>
            
            <!-- Coin Arama -->
            <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center; align-items: center; flex-wrap: wrap;">
                <input type="text" id="coinSearchInput" placeholder="ðŸ” Coin ara (Ã¶rn: BTC, ETH, SOL)..." 
                       style="padding: 15px 20px; min-width: 300px; max-width: 500px; background: rgba(0,0,0,0.4); 
                              border: 2px solid rgba(255,215,0,0.3); border-radius: 25px; color: #fff; font-size: 1.1em;
                              transition: all 0.3s; outline: none;"
                       onkeypress="if(event.key === 'Enter') searchAndAnalyzeCoin(event)"
                       oninput="filterCoinSearch(this.value)">
                <button onclick="searchAndAnalyzeCoin(event)" 
                        style="padding: 15px 30px; background: linear-gradient(45deg, #4ecdc4, #44a08d); 
                               border: none; border-radius: 25px; color: #fff; font-weight: bold; 
                               cursor: pointer; font-size: 1.1em; box-shadow: 0 4px 15px rgba(78, 205, 196, 0.4);
                               transition: all 0.3s;"
                        onmouseover="this.style.transform='scale(1.05)'" 
                        onmouseout="this.style.transform='scale(1)'">
                    ðŸ“Š Analiz Et
                </button>
            </div>
            <div id="coinSearchResults" style="margin-top: 15px; max-height: 200px; overflow-y: auto; display: none; 
                                                background: rgba(0,0,0,0.5); border-radius: 15px; padding: 10px;"></div>

            <div class="new-features-nav">
                <button class="new-feature-btn active" onclick="switchNewFeature('heatmap', event)">ðŸŒ¡ï¸ Heatmap</button>
                <button class="new-feature-btn" onclick="switchNewFeature('smartmoney', event)">ðŸ‹ Smart Money</button>
                <button class="new-feature-btn" onclick="switchNewFeature('liquidation', event)">âš ï¸ Liquidation</button>
                <button class="new-feature-btn" onclick="switchNewFeature('onchain', event)">â›“ï¸ On-Chain</button>
                <button class="new-feature-btn" onclick="switchNewFeature('funding', event)">ðŸ“Š Funding</button>
                <button class="new-feature-btn" onclick="switchNewFeature('sr', event)">ðŸ“ S/R</button>
                <button class="new-feature-btn" onclick="switchNewFeature('divergence', event)">ðŸ”€ Divergence</button>
                <button class="new-feature-btn" onclick="switchNewFeature('volume', event)">ðŸ“ˆ Volume</button>
                <button class="new-feature-btn" onclick="switchNewFeature('session', event)">ðŸŒ Session</button>
                <button class="new-feature-btn" onclick="switchNewFeature('risk', event)">ðŸ’Ž Risk</button>
                <button class="new-feature-btn" onclick="switchNewFeature('backtest', event)">âš™ï¸ Backtest</button>
                <button class="new-feature-btn" onclick="switchNewFeature('news', event)">ðŸ“° News</button>
                <button class="new-feature-btn" onclick="switchNewFeature('options', event)">ðŸ“ž Options</button>
                <button class="new-feature-btn" onclick="switchNewFeature('fear', event)">ðŸ˜¨ Fear & Greed</button>
                <button class="new-feature-btn" onclick="switchNewFeature('multitf', event)">â±ï¸ Multi-TF</button>
            </div>
        </div>

        <div class="nav-tabs">
            <div class="nav-tab active" onclick="switchTab('home', event)">ðŸ  Ana Sayfa</div>
            <div class="nav-tab" onclick="switchTab('indicators', event)">ðŸ“Š Ä°ndikatÃ¶rler (50+ Premium)</div>
            <div class="nav-tab" onclick="switchTab('exchanges', event)">ðŸ’± Borsalar (7)</div>
            <div class="nav-tab" onclick="switchTab('strategies', event)">ðŸŽ¯ Stratejiler (8)</div>
            <div class="nav-tab" onclick="switchTab('tradingtools', event)">âš™ï¸ Ä°ÅŸlem AraÃ§larÄ±</div>
            <div class="nav-tab" onclick="switchTab('results', event)">ðŸ“ˆ SonuÃ§lar</div>
        </div>

        <!-- ANA SAYFA -->
        <div id="home" class="tab-content active">
            <div class="control-panel">
                <div class="control-group">
                    <label>â° Zaman Dilimi:</label>
                    <div class="timeframe-selector">
                        <div class="timeframe-btn" onclick="selectTimeframe('1m', event)">1m</div>
                        <div class="timeframe-btn" onclick="selectTimeframe('5m', event)">5m</div>
                        <div class="timeframe-btn active" onclick="selectTimeframe('15m', event)">15m</div>
                        <div class="timeframe-btn" onclick="selectTimeframe('30m', event)">30m</div>
                        <div class="timeframe-btn" onclick="selectTimeframe('1h', event)">1h</div>
                        <div class="timeframe-btn" onclick="selectTimeframe('4h', event)">4h</div>
                        <div class="timeframe-btn" onclick="selectTimeframe('1d', event)">1D</div>
                    </div>
                </div>

                <div class="control-group">
                    <label>ðŸŽ¯ Minimum Skor: <span id="minScoreValue">70</span></label>
                    <input type="range" id="minScore" min="0" max="100" value="70" 
                           style="width: 100%;" oninput="updateMinScore(this.value)">
                </div>
            </div>

            <button class="scan-button" onclick="startScan()" id="scanButton">
                ðŸ” GERÃ‡EK ZAMANLI AI TARAMA BAÅžLAT ðŸš€
            </button>

            <div class="stats-overview">
                <div class="stat-card">
                    <div class="stat-value" id="totalCoins">0</div>
                    <div class="stat-label">Taranan Coin</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="bullishSignals" style="color: #4ecdc4;">0</div>
                    <div class="stat-label">ðŸŸ¢ LONG Sinyali</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="bearishSignals" style="color: #ff6b6b;">0</div>
                    <div class="stat-label">ðŸ”´ SHORT Sinyali</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="neutralSignals" style="color: #ffd700;">0</div>
                    <div class="stat-label">âšª Bekle</div>
                </div>
            </div>
        </div>

        <!-- Ä°NDÄ°KATÃ–RLER -->
        <div id="indicators" class="tab-content">
            <div class="indicator-categories" id="indicatorCategories"></div>
        </div>

        <!-- BORSALAR -->
        <div id="exchanges" class="tab-content">
            <h2 style="margin-bottom: 20px; text-align: center;">Desteklenen Borsalar</h2>
            <div class="exchange-grid" id="exchangeGrid"></div>
        </div>

        <!-- STRATEJÄ°LER - GENIÅžLET Ä°LMÄ°Åž -->
        <div id="strategies" class="tab-content">
            <h2 style="text-align: center; margin-bottom: 30px; font-size: 2em; color: #ffd700;">
                ðŸŽ¯ 8 PROFESYONEL STRATEJÄ° - DETAYLI KILAVUZ
            </h2>

            <!-- 1. FÄ°BONACCI -->
            <div class="strategy-card">
                <div class="strategy-header">
                    <div class="strategy-icon">ðŸ’Ž</div>
                    <div style="flex: 1;">
                        <h3 style="font-size: 1.5em; margin-bottom: 5px;">1. Fibonacci Golden Zone Stratejisi</h3>
                        <p style="color: #aaa;">AltÄ±n Oran (0.618) | Win Rate: 75-80% | Risk/Reward: 1:3</p>
                    </div>
                </div>
                <div style="padding: 20px; background: rgba(255,255,255,0.03); border-radius: 10px; margin-top: 15px;">
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸ“Š KullanÄ±lan Ä°ndikatÃ¶rler:</strong>
                        <div style="margin-top: 10px; line-height: 1.8; padding-left: 15px;">
                            â€¢ Auto Fibonacci Retracement<br>
                            â€¢ Fibonacci Extension (161.8%, 261.8%)<br>
                            â€¢ EMA 21/50 (Trend konfirmasyonu)<br>
                            â€¢ RSI (30-70 aralÄ±ÄŸÄ±)<br>
                            â€¢ Volume Profile (POC onayÄ±)
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #4ecdc4; font-size: 1.1em;">âœ… LONG GiriÅŸ Kriterleri:</strong>
                        <div style="margin-top: 10px; line-height: 2; padding-left: 15px;">
                            <strong>1.</strong> Fiyat 0.618 (Golden Zone) seviyesine gelir<br>
                            <strong>2.</strong> RSI 40-50 arasÄ±nda (oversold deÄŸil)<br>
                            <strong>3.</strong> EMA 21 > EMA 50 (uptrend)<br>
                            <strong>4.</strong> Volume artÄ±ÅŸÄ± (1.5x ortalama)<br>
                            <strong>5.</strong> Bullish candlestick pattern (hammer, engulfing)
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ff6b6b; font-size: 1.1em;">âŒ SHORT GiriÅŸ Kriterleri:</strong>
                        <div style="margin-top: 10px; line-height: 2; padding-left: 15px;">
                            <strong>1.</strong> Fiyat 0.382 seviyesinde reject edilir<br>
                            <strong>2.</strong> RSI 50-60 arasÄ±nda<br>
                            <strong>3.</strong> EMA 21 < EMA 50 (downtrend)<br>
                            <strong>4.</strong> Volume artÄ±ÅŸÄ± ile rejection<br>
                            <strong>5.</strong> Bearish pattern (shooting star, dark cloud)
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸŽ¯ Ã‡Ä±kÄ±ÅŸ Stratejisi:</strong>
                        <div style="margin-top: 10px; line-height: 2; padding-left: 15px;">
                            â€¢ <strong>Stop Loss:</strong> 0.786 seviyesinin altÄ±/Ã¼stÃ¼<br>
                            â€¢ <strong>TP1:</strong> 0.382 seviyesi (1:1 RR)<br>
                            â€¢ <strong>TP2:</strong> 0 seviyesi - Previous high/low (1:2 RR)<br>
                            â€¢ <strong>TP3:</strong> Fibonacci Extension 1.618 (1:3 RR)<br>
                            â€¢ <strong>Break-even:</strong> TP1'de stop loss'u entry'ye Ã§ek
                        </div>
                    </div>
                    <div style="background: rgba(255,215,0,0.15); padding: 15px; border-radius: 8px; border-left: 4px solid #ffd700;">
                        <strong style="color: #ffd700;">ðŸ’¡ PRO TÄ°P:</strong> En gÃ¼Ã§lÃ¼ sinyaller 0.618 ve 0.786 arasÄ±ndaki "Kill Zone"da oluÅŸur. Bu bÃ¶lgede volume spike + candlestick pattern = YÃ¼ksek olasÄ±lÄ±k!
                    </div>
                </div>
            </div>

            <!-- 2. TEpe & Dip AvcÄ±sÄ± -->
            <div class="strategy-card">
                <div class="strategy-header">
                    <div class="strategy-icon">ðŸŽ¯</div>
                    <div style="flex: 1;">
                        <h3 style="font-size: 1.5em; margin-bottom: 5px;">2. Tepe & Dip AvcÄ±sÄ± Stratejisi</h3>
                        <p style="color: #aaa;">Trend Reversal | Win Rate: 65-70% | Risk/Reward: 1:2</p>
                    </div>
                </div>
                <div style="padding: 20px; background: rgba(255,255,255,0.03); border-radius: 10px; margin-top: 15px;">
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸ“Š KullanÄ±lan Ä°ndikatÃ¶rler:</strong>
                        <div style="margin-top: 10px; line-height: 1.8; padding-left: 15px;">
                            â€¢ RSI (14) - Divergence tespiti<br>
                            â€¢ Stochastic Oscillator<br>
                            â€¢ Volume Profile - Support/Resistance<br>
                            â€¢ Pivot Points (YÃ¼ksek/DÃ¼ÅŸÃ¼k)
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸŽ¯ Strateji KurallarÄ±:</strong>
                        <div style="margin-top: 10px; line-height: 2; padding-left: 15px;">
                            â€¢ <strong>GiriÅŸ:</strong> RSI < 30 (Dip) veya RSI > 70 (Tepe) + Volume spike<br>
                            â€¢ <strong>Konfirmasyon:</strong> Stochastic oversold/overbought + Candlestick reversal pattern<br>
                            â€¢ <strong>Stop Loss:</strong> Son pivot low/high Â± %1<br>
                            â€¢ <strong>TP1:</strong> Son pivot seviyesi (1:1 RR)<br>
                            â€¢ <strong>TP2:</strong> Fibonacci 0.382 (1:2 RR)
                        </div>
                    </div>
                    <div style="background: rgba(255,215,0,0.15); padding: 15px; border-radius: 8px; border-left: 4px solid #ffd700;">
                        <strong style="color: #ffd700;">ðŸ’¡ PRO TÄ°P:</strong> Bullish/Bearish divergence RSI'da tespit edildiÄŸinde %85+ baÅŸarÄ± oranÄ±! Trend reversal'lar iÃ§in en gÃ¼Ã§lÃ¼ sinyal.
                    </div>
                </div>
            </div>

            <!-- 3. Smart Money Concepts -->
            <div class="strategy-card">
                <div class="strategy-header">
                    <div class="strategy-icon">ðŸ‹</div>
                    <div style="flex: 1;">
                        <h3 style="font-size: 1.5em; margin-bottom: 5px;">3. Smart Money Concepts (SMC) Stratejisi</h3>
                        <p style="color: #aaa;">Institutional Flow | Win Rate: 70-75% | Risk/Reward: 1:2.5</p>
                    </div>
                </div>
                <div style="padding: 20px; background: rgba(255,255,255,0.03); border-radius: 10px; margin-top: 15px;">
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸ“Š KullanÄ±lan Ä°ndikatÃ¶rler:</strong>
                        <div style="margin-top: 10px; line-height: 1.8; padding-left: 15px;">
                            â€¢ Order Blocks (YÃ¼ksek Volume MumlarÄ±)<br>
                            â€¢ Fair Value Gaps (FVG)<br>
                            â€¢ BOS (Break of Structure)<br>
                            â€¢ CHoCH (Change of Character)<br>
                            â€¢ CVD (Cumulative Volume Delta)
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸŽ¯ Strateji KurallarÄ±:</strong>
                        <div style="margin-top: 10px; line-height: 2; padding-left: 15px;">
                            â€¢ <strong>GiriÅŸ:</strong> Order Block'ta price reaction + FVG doldurma<br>
                            â€¢ <strong>Konfirmasyon:</strong> BOS + CHoCH + CVD bullish/bearish trend<br>
                            â€¢ <strong>Stop Loss:</strong> Order Block dÄ±ÅŸÄ±<br>
                            â€¢ <strong>TP1:</strong> Ä°lk FVG (1:1.5 RR)<br>
                            â€¢ <strong>TP2:</strong> Son BOS seviyesi (1:2.5 RR)
                        </div>
                    </div>
                    <div style="background: rgba(78,205,196,0.15); padding: 15px; border-radius: 8px; border-left: 4px solid #4ecdc4;">
                        <strong style="color: #4ecdc4;">ðŸ’¡ PRO TÄ°P:</strong> Order Blocks ve FVG'ler "Smart Money" iÃ§in kritik seviyelerdir. Bu seviyelerde rejection + volume = YÃ¼ksek kazanÃ§ potansiyeli!
                    </div>
                </div>
            </div>

            <!-- 4. Wyckoff Accumulation -->
            <div class="strategy-card">
                <div class="strategy-header">
                    <div class="strategy-icon">ðŸ“Š</div>
                    <div style="flex: 1;">
                        <h3 style="font-size: 1.5em; margin-bottom: 5px;">4. Wyckoff Accumulation/Distribution Stratejisi</h3>
                        <p style="color: #aaa;">Institutional Manipulation | Win Rate: 75-80% | Risk/Reward: 1:3</p>
                    </div>
                </div>
                <div style="padding: 20px; background: rgba(255,255,255,0.03); border-radius: 10px; margin-top: 15px;">
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸ“Š KullanÄ±lan Ä°ndikatÃ¶rler:</strong>
                        <div style="margin-top: 10px; line-height: 1.8; padding-left: 15px;">
                            â€¢ Wyckoff Phases (Accumulation/Markup/Distribution/Markdown)<br>
                            â€¢ Volume Spread Analysis (VSA)<br>
                            â€¢ Supply/Demand Zones<br>
                            â€¢ CVD (Cumulative Volume Delta)
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸŽ¯ Strateji KurallarÄ±:</strong>
                        <div style="margin-top: 10px; line-height: 2; padding-left: 15px;">
                            â€¢ <strong>GiriÅŸ:</strong> Accumulation fazÄ± sonu + Spring testi baÅŸarÄ±lÄ±<br>
                            â€¢ <strong>Konfirmasyon:</strong> Markup fazÄ± baÅŸlangÄ±cÄ± + Volume artÄ±ÅŸÄ± + CVD bullish<br>
                            â€¢ <strong>Stop Loss:</strong> Accumulation zone altÄ±<br>
                            â€¢ <strong>TP1:</strong> Markup 50% (1:2 RR)<br>
                            â€¢ <strong>TP2:</strong> Distribution zone Ã¶ncesi (1:3 RR)
                        </div>
                    </div>
                    <div style="background: rgba(255,149,0,0.15); padding: 15px; border-radius: 8px; border-left: 4px solid #ff9500;">
                        <strong style="color: #ff9500;">ðŸ’¡ PRO TÄ°P:</strong> Wyckoff'ta "Spring" (pshing) testleri en gÃ¼venilir giriÅŸ noktalarÄ±dÄ±r. Market makerlerin manipÃ¼lasyonunu yakalayÄ±n!
                    </div>
                </div>
            </div>

            <!-- 5. Breakout Momentum -->
            <div class="strategy-card">
                <div class="strategy-header">
                    <div class="strategy-icon">ðŸš€</div>
                    <div style="flex: 1;">
                        <h3 style="font-size: 1.5em; margin-bottom: 5px;">5. Breakout Momentum Stratejisi</h3>
                        <p style="color: #aaa;">Trend Continuation | Win Rate: 60-65% | Risk/Reward: 1:2</p>
                    </div>
                </div>
                <div style="padding: 20px; background: rgba(255,255,255,0.03); border-radius: 10px; margin-top: 15px;">
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸ“Š KullanÄ±lan Ä°ndikatÃ¶rler:</strong>
                        <div style="margin-top: 10px; line-height: 1.8; padding-left: 15px;">
                            â€¢ Bollinger Bands (BB) - Volatilite<br>
                            â€¢ Volume Spike (2x+ Average Volume)<br>
                            â€¢ EMA 9/21/50 - Trend konfirmasyonu<br>
                            â€¢ ADX - Trend gÃ¼cÃ¼ (25+)
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸŽ¯ Strateji KurallarÄ±:</strong>
                        <div style="margin-top: 10px; line-height: 2; padding-left: 15px;">
                            â€¢ <strong>GiriÅŸ:</strong> BB Ã¼st/alt bandÄ± kÄ±rÄ±lÄ±mÄ± + Volume 2x+ + EMA alignment<br>
                            â€¢ <strong>Konfirmasyon:</strong> ADX > 25 + MACD bullish cross<br>
                            â€¢ <strong>Stop Loss:</strong> BB middle band (1.5 ATR)<br>
                            â€¢ <strong>TP1:</strong> Fibonacci Extension 1.272 (1:1.5 RR)<br>
                            â€¢ <strong>TP2:</strong> Fibonacci Extension 1.618 (1:2 RR)
                        </div>
                    </div>
                    <div style="background: rgba(255,107,107,0.15); padding: 15px; border-radius: 8px; border-left: 4px solid #ff6b6b;">
                        <strong style="color: #ff6b6b;">ðŸ’¡ PRO TÄ°P:</strong> Breakout'lar volume olmadan false olabilir! Volume spike mutlaka olmalÄ±, yoksa trap'e dÃ¼ÅŸebilirsiniz.
                    </div>
                </div>
            </div>

            <!-- 6. CVD Divergence -->
            <div class="strategy-card">
                <div class="strategy-header">
                    <div class="strategy-icon">ðŸ“ˆ</div>
                    <div style="flex: 1;">
                        <h3 style="font-size: 1.5em; margin-bottom: 5px;">6. CVD Divergence Stratejisi</h3>
                        <p style="color: #aaa;">Volume Analysis | Win Rate: 70-75% | Risk/Reward: 1:2</p>
                    </div>
                </div>
                <div style="padding: 20px; background: rgba(255,255,255,0.03); border-radius: 10px; margin-top: 15px;">
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸ“Š KullanÄ±lan Ä°ndikatÃ¶rler:</strong>
                        <div style="margin-top: 10px; line-height: 1.8; padding-left: 15px;">
                            â€¢ CVD (Cumulative Volume Delta)<br>
                            â€¢ Price Action - Higher Highs/Lower Lows<br>
                            â€¢ Volume Profile<br>
                            â€¢ VWAP (Volume Weighted Average Price)
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸŽ¯ Strateji KurallarÄ±:</strong>
                        <div style="margin-top: 10px; line-height: 2; padding-left: 15px;">
                            â€¢ <strong>GiriÅŸ:</strong> Price yeni yÃ¼ksek/alÃ§ak yaparken CVD dÃ¼ÅŸÃ¼yor/yÃ¼kseliyor (Divergence)<br>
                            â€¢ <strong>Konfirmasyon:</strong> Volume artÄ±ÅŸÄ± + VWAP reaksiyonu<br>
                            â€¢ <strong>Stop Loss:</strong> Son CVD support/resistance<br>
                            â€¢ <strong>TP1:</strong> CVD reversal seviyesi (1:1.5 RR)<br>
                            â€¢ <strong>TP2:</strong> Volume Profile Point of Control (1:2 RR)
                        </div>
                    </div>
                    <div style="background: rgba(78,205,196,0.15); padding: 15px; border-radius: 8px; border-left: 4px solid #4ecdc4;">
                        <strong style="color: #4ecdc4;">ðŸ’¡ PRO TÄ°P:</strong> CVD divergence, kurumsal oyuncularÄ±n pozisyonlarÄ±nÄ± deÄŸiÅŸtirdiÄŸini gÃ¶sterir. Bu sinyal Ã§ok gÃ¼Ã§lÃ¼dÃ¼r!
                    </div>
                </div>
            </div>

            <!-- 7. Liquidation Hunt -->
            <div class="strategy-card">
                <div class="strategy-header">
                    <div class="strategy-icon">ðŸ’€</div>
                    <div style="flex: 1;">
                        <h3 style="font-size: 1.5em; margin-bottom: 5px;">7. Liquidation Hunt Stratejisi</h3>
                        <p style="color: #aaa;">Market Manipulation | Win Rate: 65-70% | Risk/Reward: 1:2.5</p>
                    </div>
                </div>
                <div style="padding: 20px; background: rgba(255,255,255,0.03); border-radius: 10px; margin-top: 15px;">
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸ“Š KullanÄ±lan Ä°ndikatÃ¶rler:</strong>
                        <div style="margin-top: 10px; line-height: 1.8; padding-left: 15px;">
                            â€¢ Liquidation Heatmap (Long/Short Liq. Seviyeleri)<br>
                            â€¢ Order Flow Analysis<br>
                            â€¢ Funding Rates<br>
                            â€¢ Open Interest (OI) DeÄŸiÅŸimleri
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸŽ¯ Strateji KurallarÄ±:</strong>
                        <div style="margin-top: 10px; line-height: 2; padding-left: 15px;">
                            â€¢ <strong>GiriÅŸ:</strong> BÃ¼yÃ¼k liquidation cluster yakÄ±nÄ±nda + Funding rate extreme<br>
                            â€¢ <strong>Konfirmasyon:</strong> OI dÃ¼ÅŸÃ¼ÅŸÃ¼ + Price liquidation seviyesine yaklaÅŸÄ±yor<br>
                            â€¢ <strong>Stop Loss:</strong> Liquidation seviyesinin %2 Ã¶tesi<br>
                            â€¢ <strong>TP1:</strong> Liquidation cluster sonrasÄ± %5 hareket (1:2 RR)<br>
                            â€¢ <strong>TP2:</strong> Sonraki major liquidation seviyesi (1:2.5 RR)
                        </div>
                    </div>
                    <div style="background: rgba(255,107,107,0.15); padding: 15px; border-radius: 8px; border-left: 4px solid #ff6b6b;">
                        <strong style="color: #ff6b6b;">ðŸ’¡ PRO TÄ°P:</strong> Market makerler liquidation'larÄ± avlar. BÃ¼yÃ¼k liquidation cluster'larÄ± "hunted" olduktan sonra price genelde ters yÃ¶ne gider!
                    </div>
                </div>
            </div>

            <!-- 8. Multi-Timeframe Confluence -->
            <div class="strategy-card">
                <div class="strategy-header">
                    <div class="strategy-icon">â±ï¸</div>
                    <div style="flex: 1;">
                        <h3 style="font-size: 1.5em; margin-bottom: 5px;">8. Multi-Timeframe Confluence Stratejisi</h3>
                        <p style="color: #aaa;">High Probability Entry | Win Rate: 80-85% | Risk/Reward: 1:2</p>
                    </div>
                </div>
                <div style="padding: 20px; background: rgba(255,255,255,0.03); border-radius: 10px; margin-top: 15px;">
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸ“Š KullanÄ±lan Ä°ndikatÃ¶rler:</strong>
                        <div style="margin-top: 10px; line-height: 1.8; padding-left: 15px;">
                            â€¢ Multi-Timeframe Analysis (1H, 4H, 1D)<br>
                            â€¢ Support/Resistance Levels (TÃ¼m timeframe'lerde)<br>
                            â€¢ Fibonacci Levels (Major timeframe'den)<br>
                            â€¢ EMA Alignment (3 timeframe'de aynÄ± trend)
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ffd700; font-size: 1.1em;">ðŸŽ¯ Strateji KurallarÄ±:</strong>
                        <div style="margin-top: 10px; line-height: 2; padding-left: 15px;">
                            â€¢ <strong>GiriÅŸ:</strong> 3 timeframe'de aynÄ± yÃ¶nde trend + S/R seviyesinde confluence<br>
                            â€¢ <strong>Konfirmasyon:</strong> Fibonacci + EMA + S/R seviyesi aynÄ± noktada<br>
                            â€¢ <strong>Stop Loss:</strong> En yakÄ±n S/R seviyesinin Ã¶tesi<br>
                            â€¢ <strong>TP1:</strong> Bir Ã¼st S/R seviyesi (1:1.5 RR)<br>
                            â€¢ <strong>TP2:</strong> Major Fibonacci extension (1:2 RR)
                        </div>
                    </div>
                    <div style="background: rgba(155,89,182,0.15); padding: 15px; border-radius: 8px; border-left: 4px solid #9b59b6;">
                        <strong style="color: #9b59b6;">ðŸ’¡ PRO TÄ°P:</strong> 3 timeframe confluence = En yÃ¼ksek baÅŸarÄ± oranÄ±! BÃ¼yÃ¼k timeframe (1D) trend, orta (4H) entry, kÃ¼Ã§Ã¼k (1H) timing.
                    </div>
                </div>
            </div>

        </div>

        <!-- Ä°ÅžLEM ARAÃ‡LARI - TRADING TOOLS -->
        <div id="tradingtools" class="tab-content">
            <h2 style="text-align: center; margin-bottom: 30px; font-size: 2em; color: #ffd700;">
                âš™ï¸ PROFESYONEL Ä°ÅžLEM ARAÃ‡LARI
            </h2>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <!-- 1. POSITION SIZE CALCULATOR -->
                <div class="strategy-card">
                    <h3 style="font-size: 1.5em; margin-bottom: 15px; color: #ffd700;">ðŸ’° Position Size Calculator</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px;">PortfÃ¶y DeÄŸeri (USDT):</label>
                            <input type="number" id="portfolioValue" placeholder="10000" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Risk YÃ¼zdesi (%):</label>
                            <input type="number" id="riskPercent" placeholder="2" step="0.1" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Entry Price:</label>
                            <input type="number" id="entryPrice" placeholder="50000" step="0.01" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Stop Loss Price:</label>
                            <input type="number" id="stopLossPrice" placeholder="49000" step="0.01" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Leverage (Opsiyonel):</label>
                            <input type="number" id="leverage" placeholder="1" min="1" max="125" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <button onclick="calculatePositionSize()" style="padding: 15px; background: linear-gradient(45deg, #4ecdc4, #44a08d); border: none; border-radius: 10px; color: #fff; font-weight: bold; cursor: pointer; font-size: 1.1em;">
                            ðŸ“Š Position Size Hesapla
                        </button>
                        <div id="positionSizeResult" style="margin-top: 15px; padding: 15px; background: rgba(78,205,196,0.1); border-radius: 8px; display: none;"></div>
                    </div>
                </div>

                <!-- 2. RISK/REWARD CALCULATOR -->
                <div class="strategy-card">
                    <h3 style="font-size: 1.5em; margin-bottom: 15px; color: #ffd700;">ðŸ“ˆ Risk/Reward Calculator</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Entry Price:</label>
                            <input type="number" id="rrEntry" placeholder="50000" step="0.01" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Stop Loss:</label>
                            <input type="number" id="rrStopLoss" placeholder="49000" step="0.01" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Take Profit 1:</label>
                            <input type="number" id="rrTP1" placeholder="51000" step="0.01" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Take Profit 2:</label>
                            <input type="number" id="rrTP2" placeholder="52000" step="0.01" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Pozisyon TÃ¼rÃ¼:</label>
                            <select id="positionType" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                                <option value="long">ðŸŸ¢ LONG</option>
                                <option value="short">ðŸ”´ SHORT</option>
                            </select>
                        </div>
                        <button onclick="calculateRiskReward()" style="padding: 15px; background: linear-gradient(45deg, #ffd700, #ff9500); border: none; border-radius: 10px; color: #000; font-weight: bold; cursor: pointer; font-size: 1.1em;">
                            ðŸ“Š Risk/Reward Hesapla
                        </button>
                        <div id="riskRewardResult" style="margin-top: 15px; padding: 15px; background: rgba(255,215,0,0.1); border-radius: 8px; display: none;"></div>
                    </div>
                </div>

                <!-- 3. LEVERAGE CALCULATOR -->
                <div class="strategy-card">
                    <h3 style="font-size: 1.5em; margin-bottom: 15px; color: #ffd700;">âš¡ Leverage Calculator</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Margin (USDT):</label>
                            <input type="number" id="marginAmount" placeholder="1000" step="0.01" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Leverage (1x-125x):</label>
                            <input type="number" id="leverageAmount" placeholder="10" min="1" max="125" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Entry Price:</label>
                            <input type="number" id="levEntryPrice" placeholder="50000" step="0.01" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <button onclick="calculateLeverage()" style="padding: 15px; background: linear-gradient(45deg, #ff6b6b, #c44569); border: none; border-radius: 10px; color: #fff; font-weight: bold; cursor: pointer; font-size: 1.1em;">
                            âš¡ Leverage Hesapla
                        </button>
                        <div id="leverageResult" style="margin-top: 15px; padding: 15px; background: rgba(255,107,107,0.1); border-radius: 8px; display: none;"></div>
                    </div>
                </div>

                <!-- 4. CORRELATION ANALYZER -->
                <div class="strategy-card">
                    <h3 style="font-size: 1.5em; margin-bottom: 15px; color: #ffd700;">ðŸ”— Coin Correlation Analyzer</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Ana Coin:</label>
                            <select id="baseCoin" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                                <option value="BTC/USDT">BTC/USDT</option>
                                <option value="ETH/USDT">ETH/USDT</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">KarÅŸÄ±laÅŸtÄ±rÄ±lacak Coinler (virgÃ¼lle ayÄ±rÄ±n):</label>
                            <input type="text" id="compareCoins" placeholder="ETH/USDT, SOL/USDT, BNB/USDT" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px;">Periyot (GÃ¼n):</label>
                            <input type="number" id="correlationPeriod" placeholder="30" min="7" max="365" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                        </div>
                        <button onclick="analyzeCorrelation()" style="padding: 15px; background: linear-gradient(45deg, #9b59b6, #8e44ad); border: none; border-radius: 10px; color: #fff; font-weight: bold; cursor: pointer; font-size: 1.1em;">
                            ðŸ”— Korelasyon Analizi
                        </button>
                        <div id="correlationResult" style="margin-top: 15px; padding: 15px; background: rgba(155,89,182,0.1); border-radius: 8px; display: none;"></div>
                    </div>
                </div>
            </div>

            <!-- PORTFOLIO TRACKER -->
            <div class="strategy-card" style="margin-top: 30px;">
                <h3 style="font-size: 1.5em; margin-bottom: 15px; color: #ffd700;">ðŸ“Š Portfolio Tracker</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 5px;">Coin:</label>
                        <input type="text" id="portfolioCoin" placeholder="BTC/USDT" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px;">Miktar:</label>
                        <input type="number" id="portfolioAmount" placeholder="0.1" step="0.00000001" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px;">GiriÅŸ FiyatÄ±:</label>
                        <input type="number" id="portfolioEntry" placeholder="50000" step="0.01" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px;">Pozisyon TÃ¼rÃ¼:</label>
                        <select id="portfolioType" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff;">
                            <option value="long">ðŸŸ¢ LONG</option>
                            <option value="short">ðŸ”´ SHORT</option>
                        </select>
                    </div>
                    <div style="display: flex; align-items: flex-end;">
                        <button onclick="addToPortfolio()" style="padding: 15px; background: linear-gradient(45deg, #4ecdc4, #44a08d); border: none; border-radius: 10px; color: #fff; font-weight: bold; cursor: pointer; width: 100%;">
                            âž• PortfÃ¶ye Ekle
                        </button>
                    </div>
                </div>
                <div id="portfolioList" style="margin-top: 20px;"></div>
            </div>
        </div>

        <!-- SONUÃ‡LAR -->
        <div id="results" class="tab-content">
            <div id="loadingSection" style="display: none;" class="loading">
                <div class="spinner"></div>
                <p style="font-size: 1.3em; font-weight: bold; animation: pulse 2s ease-in-out infinite;">âš¡ Teknik Analiz HesaplanÄ±yor...</p>
                <p style="font-size: 0.9em; margin-top: 10px; animation: fadeIn 2s ease-in-out infinite;">ðŸ“Š 7 Borsa â€¢ 50+ Premium Ä°ndikatÃ¶r â€¢ GerÃ§ek ZamanlÄ± Veriler</p>
                <div class="progress-bar" style="width: 0%; height: 8px; background: linear-gradient(90deg, #ffd700, #4ecdc4); border-radius: 10px; margin: 20px auto; max-width: 400px; transition: width 0.3s;"></div>
            </div>
            <!-- LONG ve SHORT iÃ§in ayrÄ± bÃ¶lÃ¼mler -->
            <div class="results-sections">
                <!-- LONG SONUÃ‡LAR -->
                <div class="result-section long-section">
                    <div class="section-header long-header">
                        <h2>ðŸŸ¢ LONG SÄ°NYALLERÄ°</h2>
                        <div class="section-count" id="longCount">0 Coin</div>
                        <div class="section-description">YÃ¼kseliÅŸ potansiyeli olan coinler - DetaylÄ± analiz iÃ§in coin kartÄ±na tÄ±klayÄ±n</div>
                    </div>
                    <div class="results-container" id="longResultsContainer"></div>
                </div>

                <!-- SHORT SONUÃ‡LAR -->
                <div class="result-section short-section">
                    <div class="section-header short-header">
                        <h2>ðŸ”´ SHORT SÄ°NYALLERÄ°</h2>
                        <div class="section-count" id="shortCount">0 Coin</div>
                        <div class="section-description">DÃ¼ÅŸÃ¼ÅŸ potansiyeli olan coinler - DetaylÄ± analiz iÃ§in coin kartÄ±na tÄ±klayÄ±n</div>
                    </div>
                    <div class="results-container" id="shortResultsContainer"></div>
                </div>

                <!-- WAIT/KARARSIZ SONUÃ‡LAR (isteÄŸe baÄŸlÄ±) -->
                <div class="result-section wait-section" id="waitSection" style="display: none;">
                    <div class="section-header wait-header">
                        <h2>âšª BEKLEME MODU</h2>
                        <div class="section-count" id="waitCount">0 Coin</div>
                        <div class="section-description">Net sinyal beklenen coinler</div>
                    </div>
                    <div class="results-container" id="waitResultsContainer"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // âœ… API ANAHTARLARI - GÃœVENLÄ°K UYARISI
        // âš ï¸ UYARI: Production'da bu anahtarlarÄ± environment variable olarak kullanÄ±n!
        const API_KEYS = {
            GROQ: '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',
            COINGECKO: 'CG-byACFdCvS96r4nNP2ZL2R8SS',
            TELEGRAM_BOT: '8429888891:AAEJS59OiC06g7-R2ZhZgAzHwc0cGXhkMv8',
            TELEGRAM_CHAT: '1591184905'
        };

        let currentLanguage = 'tr';
        let selectedTimeframe = '15m';
        let minScore = 70;
        let selectedExchanges = ['Binance', 'OKX', 'Bybit', 'MEXC', 'KuCoin', 'Gate.io', 'Huobi'];
        let realPrices = {};
        
        // ===== GERÃ‡EK ZAMANLI VERÄ° DEPOLARI =====
        let websocketConnections = {};
        let candleData = {}; // OHLCV verileri
        let technicalIndicators = {}; // Teknik analiz sonuÃ§larÄ±
        let fearGreedIndex = null;
        let liquidationData = {};
        let fundingRates = {};
        let volumeData = {};
        let onChainData = {};
        let cvdData = {}; // Cumulative Volume Delta
        let orderBlocks = {}; // Smart Money Order Blocks
        let fvgData = {}; // Fair Value Gaps
        
        // WebSocket URL'leri
        const BINANCE_WS = 'wss://stream.binance.com:9443/ws/';
        const BINANCE_WS_STREAM = 'wss://stream.binance.com:9443/stream?streams=';
        const OKX_WS = 'wss://ws.okx.com:8443/ws/v5/public';
        const BYBIT_WS = 'wss://stream.bybit.com/v5/public/spot';
        
        // Daha fazla coin desteÄŸi
        const SUPPORTED_COINS = [
            'BTC', 'ETH', 'BNB', 'SOL', 'XRP', 'ADA', 'DOGE', 'DOT',
            'MATIC', 'AVAX', 'LINK', 'UNI', 'ATOM', 'LTC', 'ETC', 'FIL',
            'TRX', 'XLM', 'ALGO', 'VET', 'ICP', 'APT', 'ARB', 'OP',
            'NEAR', 'AAVE', 'SNX', 'MKR', 'CRV', 'COMP', 'SUSHI', '1INCH'
        ];

        // ===== DÃœZELTME: Event parametreleri eklendi =====
        function changeLanguage(lang, event) {
            currentLanguage = lang;
            const buttons = document.querySelectorAll('.lang-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                buttons.forEach(btn => {
                    if (btn.textContent.includes(lang.toUpperCase())) {
                        btn.classList.add('active');
                    }
                });
            }
        }

        function switchTab(tabName, event) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    if (tab.textContent.includes(tabName) || tab.getAttribute('onclick')?.includes(tabName)) {
                        tab.classList.add('active');
                    }
                });
            }
        }

        function selectTimeframe(tf, event) {
            selectedTimeframe = tf;
            document.querySelectorAll('.timeframe-btn').forEach(btn => btn.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                document.querySelectorAll('.timeframe-btn').forEach(btn => {
                    if (btn.textContent === tf) {
                        btn.classList.add('active');
                    }
                });
            }
        }

        function updateMinScore(value) {
            minScore = value;
            document.getElementById('minScoreValue').textContent = value;
        }

        // ===== GERÃ‡EK LÄ°KÄ°DASYON HARITASI FONKSIYONU =====
        function generateLiquidationHTML(coin, currentPrice) {
            // GerÃ§ek likidasyon verilerini kullan
            const symbol = coin.replace('/USDT', 'USDT');
            const realLiquidation = liquidationData[symbol];
            
            // GerÃ§ek veri varsa kullan, yoksa tahmini hesapla
            let liquidationLevels;
            
            if (realLiquidation && realLiquidation.total > 0) {
                // GerÃ§ek likidasyon verilerinden seviyeler oluÅŸtur
                const total = realLiquidation.total;
                const longRatio = realLiquidation.longLiquidation / total;
                const shortRatio = realLiquidation.shortLiquidation / total;
                
                liquidationLevels = [
                    { price: currentPrice * 0.93, long: total * longRatio * 0.2, short: total * shortRatio * 0.1 },
                    { price: currentPrice * 0.96, long: total * longRatio * 0.25, short: total * shortRatio * 0.15 },
                    { price: currentPrice * 0.98, long: total * longRatio * 0.3, short: total * shortRatio * 0.25 },
                    { price: currentPrice * 1.00, long: total * longRatio * 0.15, short: total * shortRatio * 0.2 },
                    { price: currentPrice * 1.02, long: total * longRatio * 0.05, short: total * shortRatio * 0.15 },
                    { price: currentPrice * 1.04, long: total * longRatio * 0.03, short: total * shortRatio * 0.1 },
                    { price: currentPrice * 1.07, long: total * longRatio * 0.02, short: total * shortRatio * 0.05 },
                ];
            } else {
                // Fallback: Tahmini seviyeler (gerÃ§ek veri yoksa)
                const estimatedTotal = currentPrice * 100000; // Tahmini toplam likidasyon
                liquidationLevels = [
                    { price: currentPrice * 0.93, long: estimatedTotal * 0.2, short: estimatedTotal * 0.1 },
                    { price: currentPrice * 0.96, long: estimatedTotal * 0.25, short: estimatedTotal * 0.15 },
                    { price: currentPrice * 0.98, long: estimatedTotal * 0.3, short: estimatedTotal * 0.25 },
                    { price: currentPrice * 1.00, long: estimatedTotal * 0.15, short: estimatedTotal * 0.2 },
                    { price: currentPrice * 1.02, long: estimatedTotal * 0.05, short: estimatedTotal * 0.15 },
                    { price: currentPrice * 1.04, long: estimatedTotal * 0.03, short: estimatedTotal * 0.1 },
                    { price: currentPrice * 1.07, long: estimatedTotal * 0.02, short: estimatedTotal * 0.05 },
                ];
            }

            let totalLong = 0, totalShort = 0;
            let maxLongLevel = 0, maxShortLevel = 0;
            let maxLongPrice = 0, maxShortPrice = 0;

            liquidationLevels.forEach(level => {
                totalLong += level.long;
                totalShort += level.short;
                if (level.long > maxLongLevel) {
                    maxLongLevel = level.long;
                    maxLongPrice = level.price;
                }
                if (level.short > maxShortLevel) {
                    maxShortLevel = level.short;
                    maxShortPrice = level.price;
                }
            });

            const maxValue = Math.max(maxLongLevel, maxShortLevel);
            const distanceFromLongMax = Math.abs(currentPrice - maxLongPrice) / currentPrice * 100;
            const distanceFromShortMax = Math.abs(currentPrice - maxShortPrice) / currentPrice * 100;
            
            let html = `
            <div style="background: linear-gradient(135deg, rgba(255, 107, 107, 0.15), rgba(231, 76, 60, 0.15)); border: 2px solid #ff6b6b; padding: 20px; border-radius: 15px; margin: 20px 0; box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);">
                <div style="color: #ff6b6b; font-weight: bold; font-size: 1.4em; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    ðŸ’€ LÄ°KÄ°DASYON SEVÄ°YELERÄ° - ${coin}
                    <span style="font-size: 0.6em; color: #aaa; font-weight: normal;">GerÃ§ek ZamanlÄ± Analiz</span>
                </div>
                
                <div style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; margin-bottom: 15px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div style="background: rgba(78, 205, 196, 0.15); border: 1px solid rgba(78, 205, 196, 0.5); padding: 12px; border-radius: 8px;">
                            <div style="color: #4ecdc4; font-size: 0.85em; margin-bottom: 5px;">ðŸŸ¢ Max LONG Liquidation</div>
                            <div style="color: #4ecdc4; font-size: 1.2em; font-weight: bold;">$${formatPrice(maxLongPrice)}</div>
                            <div style="font-size: 0.75em; color: #aaa; margin-top: 5px;">Mevcut: $${formatPrice(currentPrice)} (${distanceFromLongMax.toFixed(1)}% uzaklÄ±k)</div>
                            <div style="background: rgba(0,0,0,0.3); border-radius: 5px; overflow: hidden; height: 8px; margin-top: 8px;">
                                <div style="height: 100%; background: linear-gradient(90deg, #4ecdc4, #2a9d8f); width: ${Math.max(10, 100 - (distanceFromLongMax * 2))}%;"></div>
                            </div>
                        </div>
                        <div style="background: rgba(255, 107, 107, 0.15); border: 1px solid rgba(255, 107, 107, 0.5); padding: 12px; border-radius: 8px;">
                            <div style="color: #ff6b6b; font-size: 0.85em; margin-bottom: 5px;">ðŸ”´ Max SHORT Liquidation</div>
                            <div style="color: #ff6b6b; font-size: 1.2em; font-weight: bold;">$${formatPrice(maxShortPrice)}</div>
                            <div style="font-size: 0.75em; color: #aaa; margin-top: 5px;">Mevcut: $${formatPrice(currentPrice)} (${distanceFromShortMax.toFixed(1)}% uzaklÄ±k)</div>
                            <div style="background: rgba(0,0,0,0.3); border-radius: 5px; overflow: hidden; height: 8px; margin-top: 8px;">
                                <div style="height: 100%; background: linear-gradient(90deg, #ff6b6b, #e74c3c); width: ${Math.max(10, 100 - (distanceFromShortMax * 2))}%;"></div>
                            </div>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div style="background: rgba(78, 205, 196, 0.1); border-left: 3px solid #4ecdc4; padding: 10px; border-radius: 8px;">
                            <div style="color: #4ecdc4; font-size: 0.85em; font-weight: bold;">Toplam LONG Liq.</div>
                            <div style="color: #4ecdc4; font-size: 1.1em; font-weight: bold;">$${(totalLong / 1000000).toFixed(2)}M</div>
                        </div>
                        <div style="background: rgba(255, 107, 107, 0.1); border-left: 3px solid #ff6b6b; padding: 10px; border-radius: 8px;">
                            <div style="color: #ff6b6b; font-size: 0.85em; font-weight: bold;">Toplam SHORT Liq.</div>
                            <div style="color: #ff6b6b; font-size: 1.1em; font-weight: bold;">$${(totalShort / 1000000).toFixed(2)}M</div>
                        </div>
                    </div>
                </div>
                
                <div style="background: rgba(255, 215, 0, 0.1); border-left: 4px solid #ffd700; padding: 12px; border-radius: 8px; margin-bottom: 15px;">
                    <div style="color: #ffd700; font-weight: bold; margin-bottom: 5px;">âš ï¸ UyarÄ±</div>
                    <div style="color: #ddd; font-size: 0.85em; line-height: 1.5;">
                        ${distanceFromLongMax < 5 ? 'ðŸ”´ <strong>KRÄ°TÄ°K:</strong> LONG likidasyon seviyelerine Ã§ok yakÄ±nsÄ±nÄ±z!' : distanceFromShortMax < 5 ? 'ðŸ”´ <strong>KRÄ°TÄ°K:</strong> SHORT likidasyon seviyelerine Ã§ok yakÄ±nsÄ±nÄ±z!' : distanceFromLongMax < 10 || distanceFromShortMax < 10 ? 'âš ï¸ <strong>DÄ°KKAT:</strong> Likidasyon seviyelerine yaklaÅŸÄ±yorsunuz.' : 'âœ… <strong>GÃœVENLÄ°:</strong> Likidasyon seviyelerinden yeterince uzaksÄ±nÄ±z.'}
                    </div>
                </div>
                
                <div style="max-height: 400px; overflow-y: auto; border-radius: 10px;">`;

            liquidationLevels.forEach((level, index) => {
                const longPercent = (level.long / maxValue) * 100;
                const shortPercent = (level.short / maxValue) * 100;
                const isCurrent = Math.abs(level.price - currentPrice) < currentPrice * 0.01;
                const distance = ((level.price - currentPrice) / currentPrice * 100);
                const distanceAbs = Math.abs(distance);
                const marker = isCurrent ? ' âš¡ MEVCUT FÄ°YAT' : distanceAbs < 2 ? ' ðŸ”´ Ã‡OK YAKIN' : distanceAbs < 5 ? ' âš ï¸ YAKIN' : '';
                const riskLevel = distanceAbs < 2 ? 'high' : distanceAbs < 5 ? 'medium' : 'low';
                
                html += `
                <div style="display: grid; grid-template-columns: 0.9fr 1.4fr 1.4fr 0.9fr; gap: 12px; padding: 15px; margin: 8px 0; 
                            background: ${isCurrent ? 'rgba(255, 215, 0, 0.2)' : riskLevel === 'high' ? 'rgba(255, 107, 107, 0.15)' : riskLevel === 'medium' ? 'rgba(255, 149, 0, 0.1)' : 'rgba(255, 255, 255, 0.03)'}; 
                            border-radius: 10px; border-left: 4px solid ${isCurrent ? '#ffd700' : riskLevel === 'high' ? '#ff6b6b' : riskLevel === 'medium' ? '#ff9500' : '#666'}; 
                            align-items: center; transition: all 0.3s; ${isCurrent ? 'box-shadow: 0 2px 10px rgba(255, 215, 0, 0.5);' : ''}">
                    <div style="text-align: center;">
                        <div style="font-weight: bold; color: ${isCurrent ? '#ffd700' : '#4ecdc4'}; font-size: 1em; margin-bottom: 3px;">
                            $${formatPrice(level.price)}
                        </div>
                        <div style="font-size: 0.7em; color: ${distance >= 0 ? '#4ecdc4' : '#ff6b6b'};">
                            ${distance >= 0 ? 'â†‘' : 'â†“'} ${distanceAbs.toFixed(1)}%
                        </div>
                        ${marker ? `<div style="font-size: 0.65em; color: ${riskLevel === 'high' ? '#ff6b6b' : '#ffd700'}; margin-top: 3px; font-weight: bold;">${marker}</div>` : ''}
                    </div>
                    <div style="background: rgba(78, 205, 196, 0.15); padding: 10px; border-radius: 8px; border: 1px solid rgba(78, 205, 196, 0.3);">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                            <span style="color: #4ecdc4; font-size: 0.75em; font-weight: bold;">ðŸŸ¢ LONG</span>
                            <span style="color: #4ecdc4; font-size: 0.75em; font-weight: bold;">$${(level.long / 1000000).toFixed(2)}M</span>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); border-radius: 6px; overflow: hidden; height: 18px; position: relative;">
                            <div style="width: ${Math.max(longPercent, 8)}%; height: 100%; background: linear-gradient(90deg, #4ecdc4 0%, #2a9d8f 100%); 
                                         border-radius: 4px; display: flex; align-items: center; justify-content: center; 
                                         color: ${longPercent > 15 ? '#fff' : '#000'}; font-weight: bold; font-size: 0.7em; 
                                         transition: width 0.5s; min-width: ${longPercent > 5 ? '50px' : '30px'};">
                                ${longPercent > 5 ? longPercent.toFixed(0) + '%' : ''}
                            </div>
                        </div>
                    </div>
                    <div style="background: rgba(255, 107, 107, 0.15); padding: 10px; border-radius: 8px; border: 1px solid rgba(255, 107, 107, 0.3);">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                            <span style="color: #ff6b6b; font-size: 0.75em; font-weight: bold;">ðŸ”´ SHORT</span>
                            <span style="color: #ff6b6b; font-size: 0.75em; font-weight: bold;">$${(level.short / 1000000).toFixed(2)}M</span>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); border-radius: 6px; overflow: hidden; height: 18px; position: relative;">
                            <div style="width: ${Math.max(shortPercent, 8)}%; height: 100%; background: linear-gradient(90deg, #ff6b6b 0%, #e74c3c 100%); 
                                         border-radius: 4px; display: flex; align-items: center; justify-content: center; 
                                         color: ${shortPercent > 15 ? '#fff' : '#000'}; font-weight: bold; font-size: 0.7em; 
                                         transition: width 0.5s; min-width: ${shortPercent > 5 ? '50px' : '30px'}; margin-left: auto;">
                                ${shortPercent > 5 ? shortPercent.toFixed(0) + '%' : ''}
                            </div>
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <div style="color: #aaa; font-size: 0.75em; margin-bottom: 3px;">Toplam</div>
                        <div style="color: #fff; font-weight: bold; font-size: 0.9em;">
                            $${((level.long + level.short) / 1000000).toFixed(2)}M
                        </div>
                        <div style="font-size: 0.65em; color: #666; margin-top: 3px;">
                            ${((level.long + level.short) / (totalLong + totalShort) * 100).toFixed(1)}%
                        </div>
                    </div>
                </div>`;
            });

            html += `
                </div>
                
                <div style="margin-top: 20px; padding-top: 15px; border-top: 2px solid rgba(255, 107, 107, 0.3);">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div style="background: linear-gradient(135deg, rgba(78, 205, 196, 0.2), rgba(44, 160, 141, 0.2)); border: 2px solid #4ecdc4; padding: 15px; border-radius: 10px; box-shadow: 0 2px 10px rgba(78, 205, 196, 0.3);">
                            <div style="color: #4ecdc4; font-weight: bold; font-size: 1.1em; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                                ðŸŸ¢ LONG Likidation Ã–zeti
                            </div>
                            <div style="font-size: 0.95em; color: #ddd; line-height: 1.8;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Toplam Likidation:</span>
                                    <span style="color: #4ecdc4; font-weight: bold; font-size: 1.1em;">$${(totalLong / 1000000).toFixed(2)}M</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Max Likidation FiyatÄ±:</span>
                                    <span style="color: #4ecdc4; font-weight: bold;">$${maxLongPrice.toFixed(2)}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Mevcut Fiyat UzaklÄ±ÄŸÄ±:</span>
                                    <span style="color: ${distanceFromLongMax < 5 ? '#ff6b6b' : distanceFromLongMax < 10 ? '#ff9500' : '#4ecdc4'}; font-weight: bold;">
                                        ${distanceFromLongMax.toFixed(1)}%
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div style="background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(231, 76, 60, 0.2)); border: 2px solid #ff6b6b; padding: 15px; border-radius: 10px; box-shadow: 0 2px 10px rgba(255, 107, 107, 0.3);">
                            <div style="color: #ff6b6b; font-weight: bold; font-size: 1.1em; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                                ðŸ”´ SHORT Likidation Ã–zeti
                            </div>
                            <div style="font-size: 0.95em; color: #ddd; line-height: 1.8;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Toplam Likidation:</span>
                                    <span style="color: #ff6b6b; font-weight: bold; font-size: 1.1em;">$${(totalShort / 1000000).toFixed(2)}M</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Max Likidation FiyatÄ±:</span>
                                    <span style="color: #ff6b6b; font-weight: bold;">$${maxShortPrice.toFixed(2)}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Mevcut Fiyat UzaklÄ±ÄŸÄ±:</span>
                                    <span style="color: ${distanceFromShortMax < 5 ? '#ff6b6b' : distanceFromShortMax < 10 ? '#ff9500' : '#4ecdc4'}; font-weight: bold;">
                                        ${distanceFromShortMax.toFixed(1)}%
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; margin-top: 15px;">
                        <div style="color: #ffd700; font-weight: bold; margin-bottom: 8px; font-size: 1em;">ðŸ“Š Genel Ã–zet</div>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; font-size: 0.9em;">
                            <div>
                                <div style="color: #aaa; margin-bottom: 3px;">Toplam Likidation</div>
                                <div style="color: #fff; font-weight: bold; font-size: 1.1em;">$${((totalLong + totalShort) / 1000000).toFixed(2)}M</div>
                            </div>
                            <div>
                                <div style="color: #aaa; margin-bottom: 3px;">LONG/SHORT OranÄ±</div>
                                <div style="color: #fff; font-weight: bold; font-size: 1.1em;">
                                    ${((totalLong / (totalLong + totalShort || 1)) * 100).toFixed(1)}% / ${((totalShort / (totalLong + totalShort || 1)) * 100).toFixed(1)}%
                                </div>
                            </div>
                            <div>
                                <div style="color: #aaa; margin-bottom: 3px;">Risk Seviyesi</div>
                                <div style="color: ${distanceFromLongMax < 5 || distanceFromShortMax < 5 ? '#ff6b6b' : distanceFromLongMax < 10 || distanceFromShortMax < 10 ? '#ff9500' : '#4ecdc4'}; font-weight: bold; font-size: 1.1em;">
                                    ${distanceFromLongMax < 5 || distanceFromShortMax < 5 ? 'ðŸ”´ YÃœKSEK' : distanceFromLongMax < 10 || distanceFromShortMax < 10 ? 'âš ï¸ ORTA' : 'âœ… DÃœÅžÃœK'}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>`;

            return html;
        }

        // 50+ PREMÄ°UM OPTÄ°MÄ°ZE Ä°NDÄ°KATÃ–RLER (Gereksiz tekrarlar Ã§Ä±karÄ±ldÄ±, sadece en gÃ¼venilir olanlar)
        const indicatorCategories = {
            'TREND Ä°NDÄ°KATÃ–RLER (12)': [
                'SMA(50) - Orta vadeli trend desteÄŸi/direnci',
                'SMA(200) - Uzun vadeli trend desteÄŸi/direnci (Death/Golden Cross)',
                'EMA(9) - KÄ±sa vadeli momentum',
                'EMA(21) - Orta vadeli momentum',
                'EMA(50) - Trend konfirmasyonu',
                'EMA(200) - Uzun vadeli trend',
                'EMA Golden Cross (50>200) - Uzun vadeli yÃ¼kseliÅŸ trendi',
                'EMA Death Cross (50<200) - Uzun vadeli dÃ¼ÅŸÃ¼ÅŸ trendi',
                'EMA Perfect Alignment - TÃ¼m EMA\'lar aynÄ± yÃ¶nde (GÃ¼Ã§lÃ¼ trend)',
                'MACD - Trend ve momentum analizi (En gÃ¼venilir)',
                'ADX - Trend gÃ¼cÃ¼ Ã¶lÃ§Ã¼mÃ¼ (Sadece gÃ¼Ã§lÃ¼ trendlerde sinyal)',
                'Ichimoku Cloud - Japon teknik analiz (Trend + Destek/DirenÃ§)',
                'Supertrend - Trend takip (Ã‡ok gÃ¼venilir, trend deÄŸiÅŸimleri)'
            ],
            'MOMENTUM Ä°NDÄ°KATÃ–RLER (6)': [
                'RSI(14) - AÅŸÄ±rÄ± alÄ±m/satÄ±m + Divergence tespiti (En popÃ¼ler)',
                'RSI Bullish Divergence - Fiyat dÃ¼ÅŸerken RSI yÃ¼kseliyor (GÃ¼Ã§lÃ¼ sinyal)',
                'RSI Bearish Divergence - Fiyat yÃ¼kselirken RSI dÃ¼ÅŸÃ¼yor (GÃ¼Ã§lÃ¼ sinyal)',
                'Stochastic Oscillator - Momentum ve aÅŸÄ±rÄ± alÄ±m/satÄ±m',
                'Stochastic Bullish Cross - Yeni yÃ¼kseliÅŸ sinyali',
                'Stochastic Bearish Cross - Yeni dÃ¼ÅŸÃ¼ÅŸ sinyali',
                'MACD Histogram - Momentum hÄ±zlanmasÄ±/yavaÅŸlamasÄ±'
            ],
            'VOLUME Ä°NDÄ°KATÃ–RLER (6)': [
                'Volume Ratio - Kurumsal aktivite tespiti (1.5x+ = GÃ¼Ã§lÃ¼ hareket)',
                'OBV (On-Balance Volume) - Kurumsal birikim/daÄŸÄ±tÄ±m gÃ¶stergesi',
                'VWAP - Kurumsal referans fiyatÄ± (Institutional reference)',
                'VWAP Mesafesi - FiyatÄ±n VWAP\'tan uzaklÄ±ÄŸÄ± (Kurumsal baskÄ±)',
                'CVD (Cumulative Volume Delta) - Kurumsal alÄ±m/satÄ±ÅŸ akÄ±ÅŸÄ±',
                'Institutional Volume - 3x+ volume (Kurumsal aktivite - Ã‡OK GÃœÃ‡LÃœ)'
            ],
            'VOLATÄ°LÄ°TE Ä°NDÄ°KATÃ–RLER (4)': [
                'Bollinger Bands - Volatilite ve aÅŸÄ±rÄ± alÄ±m/satÄ±m',
                'BB Band GeniÅŸliÄŸi - YÃ¼ksek/dÃ¼ÅŸÃ¼k volatilite tespiti',
                'BB AÅŸÄ±rÄ± SatÄ±m/AlÄ±m - FiyatÄ±n alt/Ã¼st band dÄ±ÅŸÄ±nda (GÃ¼Ã§lÃ¼ fÄ±rsat)',
                'ATR (Average True Range) - Volatilite Ã¶lÃ§Ã¼mÃ¼ ve risk yÃ¶netimi'
            ],
            'SMART MONEY CONCEPTS (12)': [
                'Order Blocks - Kurumsal iÅŸlem bÃ¶lgeleri (Smart Money entry/exit)',
                'Fair Value Gaps (FVG) - Dengesizlik bÃ¶lgeleri (FÄ±rsat alanlarÄ±)',
                'BOS (Break of Structure) - YapÄ± kÄ±rÄ±lÄ±mlarÄ±',
                'CHoCH (Change of Character) - Karakter deÄŸiÅŸimi',
                'Premium/Discount Zones - Kurumsal birikim/daÄŸÄ±tÄ±m bÃ¶lgeleri',
                'Wyckoff Phases - Accumulation/Markup/Distribution/Markdown',
                'VSA (Volume Spread Analysis) - Volume ile fiyat analizi',
                'Dark Pool Activity - KaranlÄ±k havuz aktivitesi',
                'Order Flow Analysis - AlÄ±m/satÄ±m basÄ±ncÄ±',
                'Block Trades - BÃ¼yÃ¼k kurumsal iÅŸlemler',
                'Whale Activity - Balina aktivitesi ve sentiment',
                'CVD Trend - Kurumsal akÄ±ÅŸ trendi'
            ],
            'FIBONACCI & PATTERNS (20)': [
                'Auto Fibonacci', 'Fib Extension', 'Fib Fan', 'Fib Time Zones', 'Fib Arcs',
                'Fib Spiral', 'Gann Fan', 'Gann Square', 'Elliott Wave', 'Harmonic Patterns',
                'ABCD', 'Bat', 'Butterfly', 'Gartley', 'Crab',
                'Shark', 'Cypher', '3 Drives', 'Head & Shoulders', 'Double Top/Bottom'
            ],
            'PUMP & DUMP (20)': [
                'ZS Pump Detector', 'Pump Sensitive', 'Peak Detection', 'Volume Surprise',
                'OBV MACD Pump', 'ML RSI Dump', 'Volume Delta Pump', 'ADX Pump',
                'Top & Bottom Finder', '%R Exhaustion', 'RSI Divergence', 'MACD Bottom',
                'Stochastic Top', 'SAR Reversal', 'Pivot Points', 'Elder Impulse',
                'ZigZag Tops', 'Relative Vigor', 'Chande Forecast', 'Williams Fractals'
            ]
        };

        // Borsalar - TÃ¼mÃ¼ aktif baÅŸlatÄ±lÄ±yor
        const exchanges = [
            { name: 'Binance', logo: 'ðŸŸ¡', active: true },
            { name: 'OKX', logo: 'âš«', active: true },
            { name: 'Bybit', logo: 'ðŸŸ ', active: true },
            { name: 'MEXC', logo: 'ðŸ”µ', active: true },
            { name: 'KuCoin', logo: 'ðŸŸ¢', active: true },
            { name: 'Gate.io', logo: 'ðŸŸ£', active: true },
            { name: 'Huobi', logo: 'ðŸ”´', active: true }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            console.log('ðŸš€ YasarAI ULTIMATE V8 MEGA - GerÃ§ek ZamanlÄ± Sistem BaÅŸlatÄ±lÄ±yor...');
            
            // Statik iÃ§erikleri yÃ¼kle
            loadIndicators();
            loadExchanges();
            
            // GerÃ§ek zamanlÄ± verileri baÅŸlat
            initializeRealTimeData();
        });
        
        // ===== GERÃ‡EK ZAMANLI VERÄ° Ä°NÄ°TÄ°ALÄ°ZASYONU =====
        async function initializeRealTimeData() {
            try {
                // Ä°lk veri yÃ¼kleme
                await fetchRealPrices();
                await fetchFearGreedIndex();
                await fetchFundingRates();
                await fetchLiquidationData();
                await fetchOnChainData();
                
                // WebSocket baÄŸlantÄ±larÄ±nÄ± baÅŸlat
                connectBinanceWebSocket();
                if (selectedExchanges.includes('OKX')) {
                    connectOKXWebSocket();
                }
                if (selectedExchanges.includes('Bybit')) {
                    connectBybitWebSocket();
                }
                
                // Periyodik gÃ¼ncellemeler
                setInterval(fetchRealPrices, 30000); // 30 saniyede bir fiyat gÃ¼ncelle
                setInterval(fetchFearGreedIndex, 300000); // 5 dakikada bir Fear & Greed
                setInterval(fetchFundingRates, 60000); // 1 dakikada bir funding rates
                setInterval(fetchLiquidationData, 60000); // 1 dakikada bir liquidation
                setInterval(fetchOnChainData, 300000); // 5 dakikada bir on-chain
                setInterval(calculateTechnicalIndicators, 60000); // 1 dakikada bir teknik analiz
                
                console.log('âœ… GerÃ§ek zamanlÄ± veri sistemi baÅŸlatÄ±ldÄ±');
            } catch (error) {
                console.error('âŒ Veri baÅŸlatma hatasÄ±:', error);
            }
        }

        function loadIndicators() {
            const container = document.getElementById('indicatorCategories');
            if (!container) return;
            
            container.innerHTML = '';
            Object.keys(indicatorCategories).forEach(category => {
                const indicators = indicatorCategories[category];
                const card = document.createElement('div');
                card.className = 'category-card';
                
                let color = '#4ecdc4';
                if (category.includes('MOMENTUM')) color = '#ffd700';
                else if (category.includes('SMART')) color = '#9b59b6';
                else if (category.includes('WHALE')) color = '#e74c3c';
                
                card.innerHTML = `
                    <div class="category-header">
                        <div class="category-title" style="color: ${color};">${category}</div>
                        <div class="category-count">${indicators.length}</div>
                    </div>
                    <div class="indicator-list">
                        ${indicators.map(ind => `
                            <div class="indicator-item">
                                <label style="display: flex; align-items: center;">
                                    <input type="checkbox" value="${ind}" checked style="margin-right: 10px;">
                                    <span>${ind}</span>
                                </label>
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function loadExchanges() {
            const container = document.getElementById('exchangeGrid');
            if (!container) return;
            
            container.innerHTML = '';
            exchanges.forEach(ex => {
                const card = document.createElement('div');
                card.className = `exchange-card ${ex.active ? 'active' : ''}`;
                card.onclick = () => toggleExchange(ex.name);
                card.innerHTML = `<div class="exchange-logo">${ex.logo}</div><div>${ex.name}</div>`;
                container.appendChild(card);
            });
        }

        function toggleExchange(name) {
            const ex = exchanges.find(e => e.name === name);
            if (ex) {
                ex.active = !ex.active;
                if (ex.active) {
                    if (!selectedExchanges.includes(name)) {
                        selectedExchanges.push(name);
                    }
                } else {
                    selectedExchanges = selectedExchanges.filter(e => e !== name);
                }
                loadExchanges();
            }
        }

        // ===== 7 BORSADAN TÃœM COINLERÄ° Ã‡EKME =====
        async function fetchAllExchangeSymbols() {
            const allSymbols = new Set();
            
            // Binance - TÃ¼m USDT Ã§iftleri
            try {
                const response = await fetch('https://api.binance.com/api/v3/exchangeInfo');
                const data = await response.json();
                if (data && data.symbols) {
                    data.symbols.forEach(s => {
                        if (s.status === 'TRADING' && s.symbol.endsWith('USDT')) {
                            allSymbols.add(s.symbol);
                        }
                    });
                }
                console.log(`âœ… Binance: ${allSymbols.size} coin bulundu`);
            } catch (e) {
                console.error('Binance symbol hatasÄ±:', e);
            }
            
            // OKX - TÃ¼m USDT Ã§iftleri
            try {
                const response = await fetch('https://www.okx.com/api/v5/public/instruments?instType=SPOT');
                const data = await response.json();
                if (data && data.data) {
                    data.data.forEach(s => {
                        if (s.state === 'live' && s.settleCcy === 'USDT') {
                            allSymbols.add(s.instId.replace('-', ''));
                        }
                    });
                }
                console.log(`âœ… OKX: Toplam ${allSymbols.size} coin`);
            } catch (e) {
                console.error('OKX symbol hatasÄ±:', e);
            }
            
            // Bybit - TÃ¼m USDT Ã§iftleri
            try {
                const response = await fetch('https://api.bybit.com/v5/market/instruments-info?category=spot');
                const data = await response.json();
                if (data && data.result && data.result.list) {
                    data.result.list.forEach(s => {
                        if (s.status === 'Trading' && s.quoteCoin === 'USDT') {
                            allSymbols.add(s.symbol);
                        }
                    });
                }
                console.log(`âœ… Bybit: Toplam ${allSymbols.size} coin`);
            } catch (e) {
                console.error('Bybit symbol hatasÄ±:', e);
            }
            
            // MEXC - TÃ¼m USDT Ã§iftleri
            try {
                const response = await fetch('https://api.mexc.com/api/v3/exchangeInfo');
                const data = await response.json();
                if (data && data.symbols) {
                    data.symbols.forEach(s => {
                        if (s.status === 'ENABLED' && s.symbol.endsWith('USDT')) {
                            allSymbols.add(s.symbol);
                        }
                    });
                }
                console.log(`âœ… MEXC: Toplam ${allSymbols.size} coin`);
            } catch (e) {
                console.error('MEXC symbol hatasÄ±:', e);
            }
            
            // KuCoin - TÃ¼m USDT Ã§iftleri
            try {
                const response = await fetch('https://api.kucoin.com/api/v1/symbols');
                const data = await response.json();
                if (data && data.data) {
                    data.data.forEach(s => {
                        if (s.enableTrading && s.symbol.endsWith('-USDT')) {
                            allSymbols.add(s.symbol.replace('-', ''));
                        }
                    });
                }
                console.log(`âœ… KuCoin: Toplam ${allSymbols.size} coin`);
            } catch (e) {
                console.error('KuCoin symbol hatasÄ±:', e);
            }
            
            // Gate.io - TÃ¼m USDT Ã§iftleri
            try {
                const response = await fetch('https://api.gateio.ws/api/v4/spot/currency_pairs');
                const data = await response.json();
                if (Array.isArray(data)) {
                    data.forEach(s => {
                        if (s.trade_status === 'tradable' && s.quote === 'USDT') {
                            allSymbols.add(s.base + s.quote);
                        }
                    });
                }
                console.log(`âœ… Gate.io: Toplam ${allSymbols.size} coin`);
            } catch (e) {
                console.error('Gate.io symbol hatasÄ±:', e);
            }
            
            // Huobi - TÃ¼m USDT Ã§iftleri
            try {
                const response = await fetch('https://api.huobi.pro/market/symbols');
                const data = await response.json();
                if (data && data.data) {
                    data.data.forEach(s => {
                        if (s.state === 'online' && s.quoteCurrency === 'usdt') {
                            allSymbols.add(s.baseCurrency.toUpperCase() + 'USDT');
                        }
                    });
                }
                console.log(`âœ… Huobi: Toplam ${allSymbols.size} coin`);
            } catch (e) {
                console.error('Huobi symbol hatasÄ±:', e);
            }
            
            return Array.from(allSymbols);
        }
        
        // ===== 7 BORSADAN GERÃ‡EK ZAMANLI FÄ°YAT Ã‡EKME =====
        async function fetchRealPrices() {
            try {
                console.log('ðŸ’° 7 BORSADAN TÃœM COINLER Ã‡EKÄ°LÄ°YOR...');
                
                // Ã–nce tÃ¼m coin listesini al
                const allSymbols = await fetchAllExchangeSymbols();
                console.log(`ðŸ“Š Toplam ${allSymbols.length} benzersiz coin bulundu`);
                
                // Her borsadan seÃ§ilen coinler iÃ§in fiyat Ã§ek
                const pricePromises = [];
                
                // Binance
                if (selectedExchanges.includes('Binance')) {
                    const binanceSymbols = allSymbols.filter(s => s.length <= 12); // Binance format kontrolÃ¼
                    for (const symbol of binanceSymbols.slice(0, 100)) { // Rate limit iÃ§in sÄ±nÄ±rla
                        pricePromises.push(
                            fetch(`https://api.binance.com/api/v3/ticker/24hr?symbol=${symbol}`)
                                .then(res => res.json())
                                .then(data => ({ symbol, data, exchange: 'Binance' }))
                                .catch(() => null)
                        );
                    }
                }
                
                // OKX
                if (selectedExchanges.includes('OKX')) {
                    const okxSymbols = allSymbols.slice(0, 50); // Rate limit iÃ§in sÄ±nÄ±rla
                    okxSymbols.forEach(symbol => {
                        const okxSymbol = symbol.replace('USDT', '-USDT');
                        pricePromises.push(
                            fetch(`https://www.okx.com/api/v5/market/ticker?instId=${okxSymbol}`)
                                .then(res => res.json())
                                .then(data => ({ symbol, data: data.data?.[0], exchange: 'OKX' }))
                                .catch(() => null)
                        );
                    });
                }
                
                // Bybit
                if (selectedExchanges.includes('Bybit')) {
                    const bybitSymbols = allSymbols.slice(0, 50);
                    bybitSymbols.forEach(symbol => {
                        pricePromises.push(
                            fetch(`https://api.bybit.com/v5/market/tickers?category=spot&symbol=${symbol}`)
                                .then(res => res.json())
                                .then(data => ({ symbol, data: data.result?.list?.[0], exchange: 'Bybit' }))
                                .catch(() => null)
                        );
                    });
                }
                
                // MEXC
                if (selectedExchanges.includes('MEXC')) {
                    const mexcSymbols = allSymbols.slice(0, 50);
                    mexcSymbols.forEach(symbol => {
                        pricePromises.push(
                            fetch(`https://api.mexc.com/api/v3/ticker/24hr?symbol=${symbol}`)
                                .then(res => res.json())
                                .then(data => ({ symbol, data, exchange: 'MEXC' }))
                                .catch(() => null)
                        );
                    });
                }
                
                // KuCoin
                if (selectedExchanges.includes('KuCoin')) {
                    const kucoinSymbols = allSymbols.slice(0, 50);
                    kucoinSymbols.forEach(symbol => {
                        const kucoinSymbol = symbol.replace('USDT', '-USDT');
                        pricePromises.push(
                            fetch(`https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=${kucoinSymbol}`)
                                .then(res => res.json())
                                .then(data => ({ 
                                    symbol, 
                                    data: data.data ? {
                                        lastPrice: data.data.price,
                                        priceChangePercent: '0'
                                    } : null,
                                    exchange: 'KuCoin' 
                                }))
                                .catch(() => null)
                        );
                    });
                }
                
                // Gate.io
                if (selectedExchanges.includes('Gate.io')) {
                    const gateSymbols = allSymbols.slice(0, 50);
                    gateSymbols.forEach(symbol => {
                        const base = symbol.replace('USDT', '');
                        pricePromises.push(
                            fetch(`https://api.gateio.ws/api/v4/spot/tickers?currency_pair=${base}_USDT`)
                                .then(res => res.json())
                                .then(data => ({ symbol, data: data?.[0], exchange: 'Gate.io' }))
                                .catch(() => null)
                        );
                    });
                }
                
                // Huobi
                if (selectedExchanges.includes('Huobi')) {
                    const huobiSymbols = allSymbols.slice(0, 50);
                    huobiSymbols.forEach(symbol => {
                        const base = symbol.replace('USDT', '').toLowerCase();
                        pricePromises.push(
                            fetch(`https://api.huobi.pro/market/detail/merged?symbol=${base}usdt`)
                                .then(res => res.json())
                                .then(data => ({ 
                                    symbol, 
                                    data: data.tick ? {
                                        close: data.tick.close,
                                        change: ((data.tick.close - data.tick.open) / data.tick.open * 100).toFixed(2)
                                    } : null,
                                    exchange: 'Huobi' 
                                }))
                                .catch(() => null)
                        );
                    });
                }
                
                // TÃ¼m istekleri Ã§alÄ±ÅŸtÄ±r (batch'ler halinde)
                const batchSize = 50;
                const results = [];
                
                for (let i = 0; i < pricePromises.length; i += batchSize) {
                    const batch = pricePromises.slice(i, i + batchSize);
                    const batchResults = await Promise.all(batch);
                    results.push(...batchResults.filter(r => r && r.data));
                    
                    // Rate limit iÃ§in bekleme
                    if (i + batchSize < pricePromises.length) {
                        await new Promise(resolve => setTimeout(resolve, 500));
                    }
                }
                
                const tickers = results;
                
                // TÃ¼m borsalardan gelen verileri parse et
                tickers.forEach(result => {
                    if (!result || !result.symbol || !result.data) return;
                    
                    const pair = result.symbol.replace('USDT', '/USDT');
                    const exchange = result.exchange;
                    const data = result.data;
                    
                    let priceData = null;
                    
                    // Binance formatÄ±
                    if (exchange === 'Binance' && data.lastPrice) {
                        priceData = {
                            price: parseFloat(data.lastPrice),
                            change: parseFloat(data.priceChangePercent || 0),
                            volume: parseFloat(data.volume || 0),
                            high24h: parseFloat(data.highPrice || 0),
                            low24h: parseFloat(data.lowPrice || 0),
                            open24h: parseFloat(data.openPrice || 0),
                            close24h: parseFloat(data.lastPrice || 0),
                            source: 'Binance',
                            exchange: 'Binance'
                        };
                    }
                    // OKX formatÄ±
                    else if (exchange === 'OKX' && data.last) {
                        priceData = {
                            price: parseFloat(data.last),
                            change: parseFloat(data.last24hChangePercent || data.changePercent24h || 0) * 100,
                            volume: parseFloat(data.vol24h || data.volume24h || 0),
                            high24h: parseFloat(data.high24h || data.high_24h || 0),
                            low24h: parseFloat(data.low24h || data.low_24h || 0),
                            open24h: parseFloat(data.open24h || data.open_24h || 0),
                            close24h: parseFloat(data.last || 0),
                            source: 'OKX',
                            exchange: 'OKX'
                        };
                    }
                    // Bybit formatÄ±
                    else if (exchange === 'Bybit' && data.lastPrice) {
                        priceData = {
                            price: parseFloat(data.lastPrice),
                            change: parseFloat(data.price24hPcnt || 0) * 100,
                            volume: parseFloat(data.volume24h || 0),
                            high24h: parseFloat(data.highPrice24h || 0),
                            low24h: parseFloat(data.lowPrice24h || 0),
                            open24h: parseFloat(data.prevPrice24h || 0),
                            close24h: parseFloat(data.lastPrice || 0),
                            source: 'Bybit',
                            exchange: 'Bybit'
                        };
                    }
                    // MEXC formatÄ±
                    else if (exchange === 'MEXC' && data.lastPrice) {
                        priceData = {
                            price: parseFloat(data.lastPrice),
                            change: parseFloat(data.priceChangePercent || 0),
                            volume: parseFloat(data.volume || 0),
                            high24h: parseFloat(data.highPrice || 0),
                            low24h: parseFloat(data.lowPrice || 0),
                            open24h: parseFloat(data.openPrice || 0),
                            close24h: parseFloat(data.lastPrice || 0),
                            source: 'MEXC',
                            exchange: 'MEXC'
                        };
                    }
                    // KuCoin formatÄ±
                    else if (exchange === 'KuCoin' && data.lastPrice) {
                        priceData = {
                            price: parseFloat(data.lastPrice),
                            change: parseFloat(data.priceChangePercent || 0),
                            volume: 0,
                            high24h: 0,
                            low24h: 0,
                            open24h: 0,
                            close24h: parseFloat(data.lastPrice || 0),
                            source: 'KuCoin',
                            exchange: 'KuCoin'
                        };
                    }
                    // Gate.io formatÄ±
                    else if (exchange === 'Gate.io' && data.last) {
                        priceData = {
                            price: parseFloat(data.last),
                            change: parseFloat(data.change_percentage || 0),
                            volume: parseFloat(data.base_volume || 0),
                            high24h: parseFloat(data.high_24h || 0),
                            low24h: parseFloat(data.low_24h || 0),
                            open24h: parseFloat(data.open_24h || 0),
                            close24h: parseFloat(data.last || 0),
                            source: 'Gate.io',
                            exchange: 'Gate.io'
                        };
                    }
                    // Huobi formatÄ±
                    else if (exchange === 'Huobi' && data.close) {
                        priceData = {
                            price: parseFloat(data.close),
                            change: parseFloat(data.change || 0),
                            volume: 0,
                            high24h: 0,
                            low24h: 0,
                            open24h: 0,
                            close24h: parseFloat(data.close || 0),
                            source: 'Huobi',
                            exchange: 'Huobi'
                        };
                    }
                    
                    // EÄŸer coin zaten varsa, en iyi veriyi seÃ§ (en yÃ¼ksek volume veya en gÃ¼ncel)
                    if (priceData) {
                        if (!realPrices[pair] || (realPrices[pair].volume < priceData.volume)) {
                            realPrices[pair] = priceData;
                        }
                    }
                });
                
                // CoinGecko fallback eksik coinler iÃ§in
                const cgMap = {
                    'BTC/USDT': 'bitcoin',
                    'ETH/USDT': 'ethereum',
                    'BNB/USDT': 'binancecoin',
                    'SOL/USDT': 'solana',
                    'XRP/USDT': 'ripple',
                    'ADA/USDT': 'cardano',
                    'DOGE/USDT': 'dogecoin',
                    'DOT/USDT': 'polkadot',
                    'MATIC/USDT': 'matic-network',
                    'AVAX/USDT': 'avalanche-2',
                    'LINK/USDT': 'chainlink',
                    'UNI/USDT': 'uniswap',
                    'ATOM/USDT': 'cosmos',
                    'LTC/USDT': 'litecoin'
                };
                
                Object.keys(cgMap).forEach(pair => {
                    if (!realPrices[pair] && cgData[cgMap[pair]]) {
                        const coinData = cgData[cgMap[pair]];
                        realPrices[pair] = {
                            price: coinData.usd,
                            change: coinData.usd_24h_change || 0,
                            volume: coinData.usd_24h_vol || 0,
                            source: 'CoinGecko'
                        };
                    }
                });
                
                console.log(`âœ… 7 BORSADAN TOPLAM ${Object.keys(realPrices).length} COIN GÃœNCELLENDI!`);
                console.log('GerÃ§ek zamanlÄ± fiyatlar:', realPrices);
                
                // UI'da coin sayÄ±sÄ±nÄ± gÃ¶ster
                updateCoinCount();
                
                // Fiyatlar gÃ¼ncellendiÄŸinde UI'Ä± gÃ¼ncelle
                updatePriceDisplays();
                
                // Teknik analiz hesapla (sadece popÃ¼ler coinler iÃ§in - performans iÃ§in)
                await calculateTechnicalIndicators();
                
            } catch (error) {
                console.error('âŒ Fiyat hatasÄ±:', error);
            }
        }
        
        // ===== WEB SOCKET GERÃ‡EK ZAMANLI BAÄžLANTI =====
        function connectBinanceWebSocket() {
            const symbols = ['btcusdt', 'ethusdt', 'bnbusdt', 'solusdt'];
            const streams = symbols.map(s => `${s}@ticker`).join('/');
            const wsUrl = `wss://stream.binance.com:9443/stream?streams=${streams}`;
            
            // EÄŸer mevcut baÄŸlantÄ± varsa kapat
            if (websocketConnections['binance']) {
                websocketConnections['binance'].close();
            }
            
            try {
                const ws = new WebSocket(wsUrl);
                
                ws.onopen = () => {
                    console.log('ðŸ”Œ Binance WebSocket baÄŸlandÄ±');
                    websocketConnections['binance'] = ws;
                };
                
                ws.onmessage = (event) => {
                    const data = JSON.parse(event.data);
                    if (data.stream && data.data) {
                        const symbol = data.stream.split('@')[0].toUpperCase();
                        const ticker = data.data;
                        
                        // Symbol mapping
                        const symbolMap = {
                            'BTCUSDT': 'BTC/USDT',
                            'ETHUSDT': 'ETH/USDT',
                            'BNBUSDT': 'BNB/USDT',
                            'SOLUSDT': 'SOL/USDT'
                        };
                        
                        const pair = symbolMap[symbol];
                        if (pair && realPrices[pair]) {
                            realPrices[pair].price = parseFloat(ticker.c);
                            realPrices[pair].change = parseFloat(ticker.P);
                            realPrices[pair].volume = parseFloat(ticker.v);
                            realPrices[pair].high24h = parseFloat(ticker.h);
                            realPrices[pair].low24h = parseFloat(ticker.l);
                            realPrices[pair].open24h = parseFloat(ticker.o);
                            
                            // UI'Ä± gÃ¼ncelle
                            updatePriceDisplay(pair);
                        }
                    }
                };
                
                ws.onerror = (error) => {
                    console.error('âŒ WebSocket hatasÄ±:', error);
                };
                
                ws.onclose = () => {
                    console.log('ðŸ”Œ WebSocket baÄŸlantÄ±sÄ± kapandÄ±, yeniden baÄŸlanÄ±lÄ±yor...');
                    setTimeout(connectBinanceWebSocket, 5000);
                };
                
            } catch (error) {
                console.error('âŒ WebSocket baÄŸlantÄ± hatasÄ±:', error);
            }
        }
        
        // ===== OKX WEBSOCKET BAÄžLANTISI =====
        function connectOKXWebSocket() {
            try {
                const ws = new WebSocket(OKX_WS);
                
                ws.onopen = () => {
                    console.log('ðŸ”Œ OKX WebSocket baÄŸlandÄ±');
                    websocketConnections['okx'] = ws;
                    
                    // Subscribe to ticker channels
                    const symbols = ['BTC-USDT', 'ETH-USDT', 'SOL-USDT'];
                    symbols.forEach(symbol => {
                        ws.send(JSON.stringify({
                            op: 'subscribe',
                            args: [{ channel: 'tickers', instId: symbol }]
                        }));
                    });
                };
                
                ws.onmessage = (event) => {
                    const data = JSON.parse(event.data);
                    
                    if (data.data && Array.isArray(data.data)) {
                        data.data.forEach(ticker => {
                            const symbol = ticker.instId;
                            const pair = symbol.replace('-', '/');
                            
                            if (realPrices[pair]) {
                                realPrices[pair].price = parseFloat(ticker.last);
                                realPrices[pair].change = parseFloat(ticker.sodUtc8) || 0;
                                realPrices[pair].volume = parseFloat(ticker.vol24h) || 0;
                                realPrices[pair].high24h = parseFloat(ticker.high24h);
                                realPrices[pair].low24h = parseFloat(ticker.low24h);
                                realPrices[pair].source = 'OKX';
                                
                                updatePriceDisplay(pair);
                            }
                        });
                    }
                };
                
                ws.onerror = (error) => {
                    console.error('âŒ OKX WebSocket hatasÄ±:', error);
                };
                
                ws.onclose = () => {
                    console.log('ðŸ”Œ OKX WebSocket kapandÄ±, yeniden baÄŸlanÄ±lÄ±yor...');
                    setTimeout(connectOKXWebSocket, 5000);
                };
                
            } catch (error) {
                console.error('âŒ OKX WebSocket baÄŸlantÄ± hatasÄ±:', error);
            }
        }
        
        // ===== BYBIT WEBSOCKET BAÄžLANTISI =====
        function connectBybitWebSocket() {
            try {
                const ws = new WebSocket(BYBIT_WS);
                
                ws.onopen = () => {
                    console.log('ðŸ”Œ Bybit WebSocket baÄŸlandÄ±');
                    websocketConnections['bybit'] = ws;
                    
                    // Subscribe to ticker channels
                    const symbols = ['BTCUSDT', 'ETHUSDT', 'SOLUSDT'];
                    ws.send(JSON.stringify({
                        op: 'subscribe',
                        args: symbols.map(s => `tickers.${s}`)
                    }));
                };
                
                ws.onmessage = (event) => {
                    const data = JSON.parse(event.data);
                    
                    if (data.topic && data.data) {
                        const symbol = data.topic.split('.')[1];
                        const pair = symbol.replace('USDT', '/USDT');
                        const ticker = data.data;
                        
                        if (realPrices[pair]) {
                            realPrices[pair].price = parseFloat(ticker.lastPrice);
                            realPrices[pair].change = parseFloat(ticker.price24hPcnt) * 100;
                            realPrices[pair].volume = parseFloat(ticker.volume24h);
                            realPrices[pair].high24h = parseFloat(ticker.highPrice24h);
                            realPrices[pair].low24h = parseFloat(ticker.lowPrice24h);
                            realPrices[pair].source = 'Bybit';
                            
                            updatePriceDisplay(pair);
                        }
                    }
                };
                
                ws.onerror = (error) => {
                    console.error('âŒ Bybit WebSocket hatasÄ±:', error);
                };
                
                ws.onclose = () => {
                    console.log('ðŸ”Œ Bybit WebSocket kapandÄ±, yeniden baÄŸlanÄ±lÄ±yor...');
                    setTimeout(connectBybitWebSocket, 5000);
                };
                
            } catch (error) {
                console.error('âŒ Bybit WebSocket baÄŸlantÄ± hatasÄ±:', error);
            }
        }
        
        // ===== GERÃ‡EK FEAR & GREED INDEX =====
        async function fetchFearGreedIndex() {
            try {
                // Alternative.me API kullanarak gerÃ§ek Fear & Greed Index
                const response = await fetch('https://api.alternative.me/fng/?limit=1');
                const data = await response.json();
                
                if (data.data && data.data.length > 0) {
                    fearGreedIndex = {
                        value: parseInt(data.data[0].value),
                        classification: data.data[0].value_classification,
                        timestamp: data.data[0].timestamp
                    };
                    
                    updateFearGreedDisplay();
                    console.log('âœ… Fear & Greed Index gÃ¼ncellendi:', fearGreedIndex);
                }
            } catch (error) {
                console.error('âŒ Fear & Greed Index hatasÄ±:', error);
                // Fallback deÄŸer
                fearGreedIndex = { value: 50, classification: 'Neutral' };
            }
        }
        
        // ===== GERÃ‡EK FUNDING RATES (Binance Futures) =====
        async function fetchFundingRates() {
            try {
                const symbols = ['BTCUSDT', 'ETHUSDT', 'SOLUSDT'];
                const rates = {};
                
                for (const symbol of symbols) {
                    try {
                        // Binance Futures API
                        const response = await fetch(`https://fapi.binance.com/fapi/v1/premiumIndex?symbol=${symbol}`);
                        const data = await response.json();
                        
                        if (data && data.lastFundingRate !== undefined) {
                            rates[symbol] = {
                                fundingRate: parseFloat(data.lastFundingRate) * 100,
                                nextFundingTime: data.nextFundingTime,
                                markPrice: parseFloat(data.markPrice),
                                indexPrice: parseFloat(data.indexPrice),
                                estimatedSettlePrice: parseFloat(data.estimatedSettlePrice || 0)
                            };
                        }
                    } catch (e) {
                        // Fallback: Spot premiumIndex
                        try {
                            const spotResponse = await fetch(`https://api.binance.com/api/v3/premiumIndex?symbol=${symbol}`);
                            const spotData = await spotResponse.json();
                            
                            if (spotData && spotData.lastFundingRate !== undefined) {
                                rates[symbol] = {
                                    fundingRate: parseFloat(spotData.lastFundingRate) * 100,
                                    markPrice: parseFloat(spotData.markPrice || spotData.lastPrice || 0),
                                    indexPrice: parseFloat(spotData.indexPrice || spotData.lastPrice || 0)
                                };
                            }
                        } catch (e2) {
                            console.error(`Funding rate hatasÄ± ${symbol}:`, e2);
                        }
                    }
                }
                
                fundingRates = rates;
                console.log('âœ… Funding rates gÃ¼ncellendi:', fundingRates);
                
                // Funding rates gÃ¶rselleÅŸtirmesini gÃ¼ncelle
                updateFundingRatesDisplay();
            } catch (error) {
                console.error('âŒ Funding rates hatasÄ±:', error);
            }
        }
        
        // ===== GERÃ‡EK ON-CHAIN VERÄ°LER =====
        async function fetchOnChainData() {
            try {
                // CoinGecko on-chain metrics (Ã¼cretsiz endpoint)
                const coins = ['bitcoin', 'ethereum'];
                const onChain = {};
                
                for (const coinId of coins) {
                    try {
                        // CoinGecko'nun basit metrics API'si
                        const response = await fetch(
                            `https://api.coingecko.com/api/v3/coins/${coinId}?localization=false&tickers=false&market_data=true&community_data=false&developer_data=false&sparkline=false`,
                            { headers: { 'x-cg-demo-api-key': API_KEYS.COINGECKO } }
                        );
                        const data = await response.json();
                        
                        if (data && data.market_data) {
                            const symbol = coinId === 'bitcoin' ? 'BTC/USDT' : 'ETH/USDT';
                            onChain[symbol] = {
                                totalSupply: data.market_data.total_supply,
                                circulatingSupply: data.market_data.circulating_supply,
                                marketCap: data.market_data.market_cap?.usd || 0,
                                fullyDilutedValuation: data.market_data.fully_diluted_valuation?.usd || 0,
                                totalValueLocked: data.market_data.total_value_locked || null,
                                mcapToTvlRatio: data.market_data.mcap_to_tvl_ratio || null,
                                lastUpdate: Date.now()
                            };
                        }
                    } catch (e) {
                        console.error(`On-chain data hatasÄ± ${coinId}:`, e);
                    }
                }
                
                // Blockchain.com API (Bitcoin iÃ§in Ã¼cretsiz)
                try {
                    const btcResponse = await fetch('https://blockchain.info/stats?format=json');
                    const btcData = await btcResponse.json();
                    
                    if (btcData && onChain['BTC/USDT']) {
                        onChain['BTC/USDT'].hashRate = btcData.hash_rate;
                        onChain['BTC/USDT'].difficulty = btcData.difficulty;
                        onChain['BTC/USDT'].totalBitcoins = btcData.totalbc / 100000000;
                        onChain['BTC/USDT'].transactions24h = btcData.n_tx;
                    }
                } catch (e) {
                    console.error('Bitcoin on-chain hatasÄ±:', e);
                }
                
                onChainData = onChain;
                console.log('âœ… On-chain veriler gÃ¼ncellendi:', onChainData);
            } catch (error) {
                console.error('âŒ On-chain veriler hatasÄ±:', error);
            }
        }
        
        // ===== GERÃ‡EK LÄ°KÄ°DASYON VERÄ°LERÄ° (Binance Futures) =====
        async function fetchLiquidationData() {
            try {
                // Binance futures liquidation data
                const symbols = ['BTCUSDT', 'ETHUSDT'];
                const liquidations = {};
                
                for (const symbol of symbols) {
                    try {
                        // Binance futures liquidation snipes API (public)
                        const response = await fetch(`https://fapi.binance.com/fapi/v1/forceOrders?symbol=${symbol}&limit=100`);
                        const data = await response.json();
                        
                        if (Array.isArray(data)) {
                            const longLiq = data.filter(d => d.side === 'BUY').reduce((sum, d) => sum + parseFloat(d.executedQty), 0);
                            const shortLiq = data.filter(d => d.side === 'SELL').reduce((sum, d) => sum + parseFloat(d.executedQty), 0);
                            
                            liquidations[symbol] = {
                                longLiquidation: longLiq,
                                shortLiquidation: shortLiq,
                                total: longLiq + shortLiq,
                                timestamp: Date.now()
                            };
                        }
                    } catch (e) {
                        console.error(`Liquidation data hatasÄ± ${symbol}:`, e);
                    }
                }
                
                liquidationData = liquidations;
                console.log('âœ… Liquidation data gÃ¼ncellendi:', liquidationData);
            } catch (error) {
                console.error('âŒ Liquidation data hatasÄ±:', error);
            }
        }
        
        // ===== GERÃ‡EK TEKNÄ°K ANALÄ°Z HESAPLAMA (OPTÄ°MÄ°ZE EDÄ°LMÄ°Åž) =====
        async function calculateTechnicalIndicators() {
            try {
                // Performans iÃ§in: En Ã§ok volume'u olan coinlerden baÅŸla
                const allPairs = Object.keys(realPrices);
                const sortedPairs = allPairs
                    .map(pair => ({ pair, volume: realPrices[pair].volume || 0 }))
                    .sort((a, b) => b.volume - a.volume)
                    .slice(0, 50) // En fazla 50 coin iÃ§in teknik analiz (performans iÃ§in)
                    .map(item => item.pair.replace('/USDT', 'USDT'));
                
                const symbols = sortedPairs.length > 0 ? sortedPairs : ['BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'SOLUSDT'];
                console.log(`ðŸ“Š ${symbols.length} coin iÃ§in teknik analiz hesaplanÄ±yor... (Paralel iÅŸleme ile)`);
                
                // PARALEL Ä°ÅžLEME - 10'ar 10'ar batch halinde
                const batchSize = 10;
                for (let i = 0; i < symbols.length; i += batchSize) {
                    const batch = symbols.slice(i, i + batchSize);
                    const promises = batch.map(symbol => processSymbolIndicators(symbol));
                    await Promise.all(promises);
                    
                    // Rate limit iÃ§in kÄ±sa bekleme
                    if (i + batchSize < symbols.length) {
                        await new Promise(resolve => setTimeout(resolve, 200));
                    }
                }
                
                console.log('âœ… Teknik analiz hesaplandÄ±:', technicalIndicators);
            } catch (error) {
                console.error('âŒ Teknik analiz hatasÄ±:', error);
            }
        }
        
        // Tek bir symbol iÃ§in indikatÃ¶r hesaplama (paralel iÅŸleme iÃ§in)
        async function processSymbolIndicators(symbol) {
            try {
                // Binance kline API - son 200 mum
                const response = await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=${selectedTimeframe}&limit=200`);
                const klines = await response.json();
                
                if (klines && klines.length > 0) {
                    const closes = klines.map(k => parseFloat(k[4])); // Close prices
                    const highs = klines.map(k => parseFloat(k[2])); // High prices
                    const lows = klines.map(k => parseFloat(k[3])); // Low prices
                    const volumes = klines.map(k => parseFloat(k[5])); // Volumes
                    
                    const pair = symbol.replace('USDT', '/USDT');
                    
                    // RSI hesapla
                    const rsi = calculateRSI(closes, 14);
                    
                    // MACD hesapla
                    const macd = calculateMACD(closes);
                    
                    // EMA hesapla
                    const ema9 = calculateEMA(closes, 9);
                    const ema21 = calculateEMA(closes, 21);
                    const ema50 = calculateEMA(closes, 50);
                    
                    // Bollinger Bands
                    const bb = calculateBollingerBands(closes, 20);
                    
                    // Volume analizi
                    const avgVolume = volumes.slice(-20).reduce((a, b) => a + b, 0) / 20;
                    const currentVolume = volumes[volumes.length - 1];
                    const volumeRatio = currentVolume / avgVolume;
                    
                    // Daha fazla indikatÃ¶r hesapla
                    const stochastic = calculateStochastic(highs, lows, closes, 14);
                    const adx = calculateADX(highs, lows, closes, 14);
                    const atr = calculateATR(highs, lows, closes, 14);
                    const vwap = calculateVWAP(klines);
                    const cvd = calculateCVD(klines);
                    
                    // Smart Money Concepts
                    const detectedOB = detectOrderBlocks(klines);
                    const detectedFVG = detectFVG(klines);
                    
                    // 90 Ä°ndikatÃ¶r analizi
                    const indicators90 = calculate90Indicators(klines, currentVolume, avgVolume);
                    
                    // Institutional analiz
                    const institutional = analyzeInstitutional(klines, volumes);
                    
                    // Whale analiz
                    const whales = analyzeWhales(klines, avgVolume);
                    
                    // Market Makers analiz
                    const marketMakers = analyzeMarketMakers(klines);
                    
                    // Smart Money Concepts detaylÄ±
                    const smartMoneyConcepts = analyzeSmartMoneyConcepts(klines);
                    
                    // Trader analiz
                    const traders = analyzeTraders(klines, institutional);
                    
                    // Stratejik analizler
                    const pumpDump = analyzePumpDump(klines, bb, currentVolume, avgVolume);
                    const trendBreak = analyzeTrendBreak(klines);
                    const peaksAndDips = analyzePeaksAndDips(klines);
                    
                    // Order Blocks ve FVG'leri kaydet
                    orderBlocks[pair] = detectedOB;
                    fvgData[pair] = detectedFVG;
                    
                    // CVD'yi kaydet
                    cvdData[pair] = cvd;
                    
                    technicalIndicators[pair] = {
                        rsi: rsi[rsi.length - 1],
                        macd: macd.macd[macd.macd.length - 1],
                        macdSignal: macd.signal[macd.signal.length - 1],
                        macdHistogram: macd.histogram[macd.histogram.length - 1],
                        ema9: ema9[ema9.length - 1],
                        ema21: ema21[ema21.length - 1],
                        ema50: ema50[ema50.length - 1],
                        bbUpper: bb.upper[bb.upper.length - 1],
                        bbMiddle: bb.middle[bb.middle.length - 1],
                        bbLower: bb.lower[bb.lower.length - 1],
                        volumeRatio: volumeRatio,
                        trend: ema9[ema9.length - 1] > ema21[ema21.length - 1] ? 'UP' : 'DOWN',
                        stochastic: stochastic.k[stochastic.k.length - 1],
                        stochasticD: stochastic.d[stochastic.d.length - 1],
                        adx: adx[adx.length - 1],
                        atr: atr[atr.length - 1],
                        vwap: vwap[vwap.length - 1],
                        cvd: cvd.current,
                        cvdTrend: cvd.trend,
                        cvdChange: cvd.change,
                        orderBlocks: detectedOB.length,
                        fvg: detectedFVG.length,
                        candles: klines.length,
                        lastUpdate: Date.now(),
                        // Yeni eklenen detaylÄ± analizler
                        indicators90: indicators90,
                        institutional: institutional,
                        whales: whales,
                        marketMakers: marketMakers,
                        smartMoneyConcepts: smartMoneyConcepts,
                        traders: traders,
                        pumpDump: pumpDump,
                        trendBreak: trendBreak,
                        peaksAndDips: peaksAndDips
                    };
                }
            } catch (e) {
                console.error(`Teknik analiz hatasÄ± ${symbol}:`, e);
            }
        }
        
        // ===== TEKNÄ°K Ä°NDÄ°KATÃ–R HESAPLAMA FONKSÄ°YONLARI =====
        function calculateRSI(prices, period = 14) {
            const changes = [];
            for (let i = 1; i < prices.length; i++) {
                changes.push(prices[i] - prices[i - 1]);
            }
            
            const gains = changes.map(c => c > 0 ? c : 0);
            const losses = changes.map(c => c < 0 ? -c : 0);
            
            const rsi = [];
            let avgGain = gains.slice(0, period).reduce((a, b) => a + b, 0) / period;
            let avgLoss = losses.slice(0, period).reduce((a, b) => a + b, 0) / period;
            
            for (let i = period; i < gains.length; i++) {
                avgGain = (avgGain * (period - 1) + gains[i]) / period;
                avgLoss = (avgLoss * (period - 1) + losses[i]) / period;
                
                const rs = avgGain / avgLoss;
                const rsiValue = 100 - (100 / (1 + rs));
                rsi.push(rsiValue);
            }
            
            return rsi;
        }
        
        function calculateEMA(prices, period) {
            const ema = [];
            const multiplier = 2 / (period + 1);
            
            // Ä°lk EMA deÄŸeri SMA
            let sum = 0;
            for (let i = 0; i < period; i++) {
                sum += prices[i];
            }
            ema.push(sum / period);
            
            // Geri kalan EMA hesapla
            for (let i = period; i < prices.length; i++) {
                const emaValue = (prices[i] - ema[ema.length - 1]) * multiplier + ema[ema.length - 1];
                ema.push(emaValue);
            }
            
            return ema;
        }
        
        function calculateMACD(prices, fastPeriod = 12, slowPeriod = 26, signalPeriod = 9) {
            const fastEMA = calculateEMA(prices, fastPeriod);
            const slowEMA = calculateEMA(prices, slowPeriod);
            
            // MACD line = Fast EMA - Slow EMA
            const macd = [];
            const offset = slowPeriod - fastPeriod;
            for (let i = 0; i < slowEMA.length; i++) {
                if (fastEMA[i + offset]) {
                    macd.push(fastEMA[i + offset] - slowEMA[i]);
                }
            }
            
            // Signal line = EMA of MACD
            const signal = calculateEMA(macd, signalPeriod);
            
            // Histogram = MACD - Signal
            const histogram = [];
            const signalOffset = macd.length - signal.length;
            for (let i = 0; i < signal.length; i++) {
                histogram.push(macd[i + signalOffset] - signal[i]);
            }
            
            return { macd, signal, histogram };
        }
        
        function calculateBollingerBands(prices, period = 20, stdDev = 2) {
            const sma = [];
            const upper = [];
            const lower = [];
            
            for (let i = period - 1; i < prices.length; i++) {
                const slice = prices.slice(i - period + 1, i + 1);
                const mean = slice.reduce((a, b) => a + b, 0) / period;
                
                const variance = slice.reduce((sum, price) => sum + Math.pow(price - mean, 2), 0) / period;
                const standardDeviation = Math.sqrt(variance);
                
                sma.push(mean);
                upper.push(mean + (stdDev * standardDeviation));
                lower.push(mean - (stdDev * standardDeviation));
            }
            
            return { middle: sma, upper, lower };
        }
        
        // ===== STOCHASTIC OSCILLATOR =====
        function calculateStochastic(highs, lows, closes, period = 14, smoothK = 3, smoothD = 3) {
            const k = [];
            const d = [];
            
            for (let i = period - 1; i < closes.length; i++) {
                const highSlice = highs.slice(i - period + 1, i + 1);
                const lowSlice = lows.slice(i - period + 1, i + 1);
                const close = closes[i];
                
                const highestHigh = Math.max(...highSlice);
                const lowestLow = Math.min(...lowSlice);
                
                const kValue = ((close - lowestLow) / (highestHigh - lowestLow)) * 100;
                k.push(kValue);
            }
            
            // Smooth K (%K)
            const smoothedK = [];
            for (let i = smoothK - 1; i < k.length; i++) {
                const kSlice = k.slice(i - smoothK + 1, i + 1);
                smoothedK.push(kSlice.reduce((a, b) => a + b, 0) / smoothK);
            }
            
            // Smooth D (%D = SMA of %K)
            for (let i = smoothD - 1; i < smoothedK.length; i++) {
                const dSlice = smoothedK.slice(i - smoothD + 1, i + 1);
                d.push(dSlice.reduce((a, b) => a + b, 0) / smoothD);
            }
            
            return { k: smoothedK, d };
        }
        
        // ===== ADX (Average Directional Index) =====
        function calculateADX(highs, lows, closes, period = 14) {
            const tr = [];
            const plusDM = [];
            const minusDM = [];
            
            // True Range ve Directional Movement hesapla
            for (let i = 1; i < closes.length; i++) {
                const tr1 = highs[i] - lows[i];
                const tr2 = Math.abs(highs[i] - closes[i - 1]);
                const tr3 = Math.abs(lows[i] - closes[i - 1]);
                tr.push(Math.max(tr1, tr2, tr3));
                
                const upMove = highs[i] - highs[i - 1];
                const downMove = lows[i - 1] - lows[i];
                
                if (upMove > downMove && upMove > 0) {
                    plusDM.push(upMove);
                    minusDM.push(0);
                } else if (downMove > upMove && downMove > 0) {
                    plusDM.push(0);
                    minusDM.push(downMove);
                } else {
                    plusDM.push(0);
                    minusDM.push(0);
                }
            }
            
            // Smoothed TR, +DM, -DM
            const atr = calculateATR(highs, lows, closes, period);
            const plusDI = [];
            const minusDI = [];
            
            for (let i = period - 1; i < tr.length; i++) {
                const trSlice = tr.slice(i - period + 1, i + 1);
                const plusDMSlice = plusDM.slice(i - period + 1, i + 1);
                const minusDMSlice = minusDM.slice(i - period + 1, i + 1);
                
                const atrValue = atr[i - period + 1];
                plusDI.push((plusDMSlice.reduce((a, b) => a + b, 0) / trSlice.reduce((a, b) => a + b, 0)) * 100);
                minusDI.push((minusDMSlice.reduce((a, b) => a + b, 0) / trSlice.reduce((a, b) => a + b, 0)) * 100);
            }
            
            // DX ve ADX hesapla
            const dx = [];
            for (let i = 0; i < plusDI.length; i++) {
                const diSum = plusDI[i] + minusDI[i];
                const diDiff = Math.abs(plusDI[i] - minusDI[i]);
                if (diSum > 0) {
                    dx.push((diDiff / diSum) * 100);
                } else {
                    dx.push(0);
                }
            }
            
            // ADX = SMA of DX
            const adx = [];
            for (let i = period - 1; i < dx.length; i++) {
                const dxSlice = dx.slice(i - period + 1, i + 1);
                adx.push(dxSlice.reduce((a, b) => a + b, 0) / period);
            }
            
            return adx;
        }
        
        // ===== ATR (Average True Range) =====
        function calculateATR(highs, lows, closes, period = 14) {
            const tr = [];
            
            for (let i = 1; i < closes.length; i++) {
                const tr1 = highs[i] - lows[i];
                const tr2 = Math.abs(highs[i] - closes[i - 1]);
                const tr3 = Math.abs(lows[i] - closes[i - 1]);
                tr.push(Math.max(tr1, tr2, tr3));
            }
            
            // ATR = EMA of TR
            const atr = [];
            let sum = tr.slice(0, period).reduce((a, b) => a + b, 0);
            atr.push(sum / period);
            
            const multiplier = 2 / (period + 1);
            for (let i = period; i < tr.length; i++) {
                const atrValue = (tr[i] - atr[atr.length - 1]) * multiplier + atr[atr.length - 1];
                atr.push(atrValue);
            }
            
            return atr;
        }
        
        // ===== VWAP (Volume Weighted Average Price) =====
        function calculateVWAP(klines) {
            const vwap = [];
            let cumulativeTPV = 0; // Typical Price * Volume
            let cumulativeVolume = 0;
            
            for (let i = 0; i < klines.length; i++) {
                const k = klines[i];
                const high = parseFloat(k[2]);
                const low = parseFloat(k[3]);
                const close = parseFloat(k[4]);
                const volume = parseFloat(k[5]);
                
                const typicalPrice = (high + low + close) / 3;
                const tpv = typicalPrice * volume;
                
                cumulativeTPV += tpv;
                cumulativeVolume += volume;
                
                if (cumulativeVolume > 0) {
                    vwap.push(cumulativeTPV / cumulativeVolume);
                } else {
                    vwap.push(close);
                }
            }
            
            return vwap;
        }
        
        // ===== CVD (Cumulative Volume Delta) =====
        function calculateCVD(klines) {
            let cvd = 0;
            
            for (let i = 0; i < klines.length; i++) {
                const k = klines[i];
                const open = parseFloat(k[1]);
                const close = parseFloat(k[4]);
                const volume = parseFloat(k[5]);
                
                // Delta = Volume * (Close - Open) / Open
                const priceChange = close - open;
                const delta = volume * (priceChange / open);
                
                cvd += delta;
            }
            
            return cvd;
        }

        // ===== DARVAS BOX (Profesyonel Trader Sistemi) =====
        function calculateDarvasBox(highs, lows, closes, volumes) {
            const period = 20;
            if (highs.length < period) return { upperBox: 0, lowerBox: 0, boxHeight: 0, breakoutDirection: 'NONE' };
            
            // Son N mumun high ve low'larÄ±nÄ± al
            const recentHighs = highs.slice(-period);
            const recentLows = lows.slice(-period);
            
            const upperBox = Math.max(...recentHighs);
            const lowerBox = Math.min(...recentLows);
            const boxHeight = ((upperBox - lowerBox) / lowerBox) * 100;
            
            const currentPrice = closes[closes.length - 1];
            let breakoutDirection = 'NONE';
            
            // Volume ile birlikte breakout kontrolÃ¼
            const recentVolume = volumes.slice(-period);
            const avgVolume = recentVolume.reduce((a, b) => a + b, 0) / recentVolume.length;
            const currentVolume = volumes[volumes.length - 1];
            
            if (currentPrice > upperBox && currentVolume > avgVolume * 1.5) {
                breakoutDirection = 'UP';
            } else if (currentPrice < lowerBox && currentVolume > avgVolume * 1.5) {
                breakoutDirection = 'DOWN';
            }
            
            return { upperBox, lowerBox, boxHeight, breakoutDirection };
        }

        // ===== SQUEEZE MOMENTUM (Gizli Profesyonel Ä°ndikatÃ¶r) =====
        function calculateSqueezeMomentum(highs, lows, closes) {
            const bb = calculateBollingerBands(closes, 20);
            const keltner = calculateKeltnerChannels(closes, highs, lows, 20, 2);
            
            const currentBBWidth = bb.upper[bb.upper.length - 1] - bb.lower[bb.lower.length - 1];
            const currentKCWidth = keltner.upper - keltner.lower;
            
            // Squeeze: BB Keltner iÃ§inde (sÄ±kÄ±ÅŸma)
            const squeeze = currentBBWidth < currentKCWidth;
            
            // Momentum: RSI benzeri hesaplama
            const momentum = calculateRSI(closes, 14);
            const momentumValue = momentum[momentum.length - 1] - 50; // -50 to +50 range
            
            return { squeeze, momentum: momentumValue };
        }

        // ===== MARKET PROFILE (Kurumsal Seviyeler) =====
        function calculateMarketProfile(highs, lows, closes, volumes) {
            const period = 20;
            const priceRange = [];
            
            // Son 20 mumun high-low aralÄ±ÄŸÄ±nÄ± 10 seviyeye bÃ¶l
            const recentHigh = Math.max(...highs.slice(-period));
            const recentLow = Math.min(...lows.slice(-period));
            const range = recentHigh - recentLow;
            const step = range / 10;
            
            // Her seviyede volume topla
            const volumeAtPrice = {};
            for (let i = closes.length - period; i < closes.length; i++) {
                const price = closes[i];
                const level = Math.floor((price - recentLow) / step) * step + recentLow;
                
                if (!volumeAtPrice[level]) volumeAtPrice[level] = 0;
                volumeAtPrice[level] += volumes[i];
            }
            
            // Value Area (en yÃ¼ksek volume'lu %70 bÃ¶lge)
            const sortedPrices = Object.entries(volumeAtPrice)
                .sort((a, b) => b[1] - a[1])
                .map(([price]) => parseFloat(price));
            
            const valueAreaCount = Math.ceil(sortedPrices.length * 0.7);
            const valueArea = sortedPrices.slice(0, valueAreaCount);
            
            // POC (Point of Control - En yÃ¼ksek volume)
            const poc = sortedPrices[0];
            
            return { valueArea, poc };
        }

        // ===== KELTNER CHANNELS =====
        function calculateKeltnerChannels(closes, highs, lows, period, multiplier) {
            const ema = calculateEMA(closes, period);
            const atr = calculateATR(highs, lows, closes, period);
            
            const middle = ema[ema.length - 1];
            const atrValue = atr[atr.length - 1];
            
            return {
                upper: middle + (multiplier * atrValue),
                middle: middle,
                lower: middle - (multiplier * atrValue)
            };
        }

        // ===== DONCHIAN CHANNELS =====
        function calculateDonchianChannels(highs, lows, period) {
            const recentHighs = highs.slice(-period);
            const recentLows = lows.slice(-period);
            
            return {
                upper: Math.max(...recentHighs),
                lower: Math.min(...recentLows),
                middle: (Math.max(...recentHighs) + Math.min(...recentLows)) / 2
            };
        }

        // ===== TSI (True Strength Index) =====
        function calculateTSI(closes, longPeriod, shortPeriod) {
            const priceChange = [];
            for (let i = 1; i < closes.length; i++) {
                priceChange.push(closes[i] - closes[i - 1]);
            }
            
            // Double smoothed momentum
            const momentum = calculateEMA(priceChange, longPeriod);
            const absMomentum = calculateEMA(priceChange.map(Math.abs), longPeriod);
            
            const smoothedMomentum = calculateEMA(momentum, shortPeriod);
            const smoothedAbsMomentum = calculateEMA(absMomentum, shortPeriod);
            
            const tsi = [];
            for (let i = 0; i < smoothedMomentum.length; i++) {
                if (smoothedAbsMomentum[i] !== 0) {
                    tsi.push((smoothedMomentum[i] / smoothedAbsMomentum[i]) * 100);
                } else {
                    tsi.push(0);
                }
            }
            
            return tsi[tsi.length - 1] || 0;
        }

        // ===== CHOPPINESS INDEX =====
        function calculateChoppinessIndex(highs, lows, closes, period) {
            if (closes.length < period + 1) return 50;
            
            let sumTrueRange = 0;
            for (let i = closes.length - period; i < closes.length; i++) {
                const tr = Math.max(
                    highs[i] - lows[i],
                    Math.abs(highs[i] - closes[i - 1]),
                    Math.abs(lows[i] - closes[i - 1])
                );
                sumTrueRange += tr;
            }
            
            const highestHigh = Math.max(...highs.slice(-period));
            const lowestLow = Math.min(...lows.slice(-period));
            const range = highestHigh - lowestLow;
            
            if (range === 0) return 50;
            
            const choppiness = 100 * Math.log10(sumTrueRange / range) / Math.log10(period);
            return Math.min(100, Math.max(0, choppiness));
        }

        // ===== VOLUME PROFILE =====
        function calculateVolumeProfile(candles, bins) {
            const closes = candles.map(c => parseFloat(c[4]));
            const volumes = candles.map(c => parseFloat(c[5]));
            
            const minPrice = Math.min(...closes);
            const maxPrice = Math.max(...closes);
            const priceRange = maxPrice - minPrice;
            const binSize = priceRange / bins;
            
            const volumeAtPrice = {};
            
            for (let i = 0; i < candles.length; i++) {
                const price = closes[i];
                const bin = Math.floor((price - minPrice) / binSize);
                const binPrice = minPrice + (bin * binSize);
                
                if (!volumeAtPrice[binPrice]) volumeAtPrice[binPrice] = 0;
                volumeAtPrice[binPrice] += volumes[i];
            }
            
            // YÃ¼ksek volume node'larÄ± bul
            const sortedNodes = Object.entries(volumeAtPrice)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5)
                .map(([price, volume]) => ({ price: parseFloat(price), volume }));
            
            return { highVolumeNodes: sortedNodes };
        }
        
        // ===== ORDER BLOCKS TESPÄ°TÄ° =====
        function detectOrderBlocks(klines) {
            const blocks = [];
            const lookback = 20;
            
            for (let i = lookback; i < klines.length - 5; i++) {
                const k = klines[i];
                const open = parseFloat(k[1]);
                const high = parseFloat(k[2]);
                const low = parseFloat(k[3]);
                const close = parseFloat(k[4]);
                const volume = parseFloat(k[5]);
                
                // Bullish Order Block: DÃ¼ÅŸÃ¼ÅŸ Ã¶ncesi son yeÅŸil mum
                const prevK = klines[i - 1];
                const prevClose = parseFloat(prevK[4]);
                const prevOpen = parseFloat(prevK[1]);
                
                if (close > open && prevClose < prevOpen) {
                    // DÃ¼ÅŸÃ¼ÅŸten sonra ilk yÃ¼kseliÅŸ - Bullish OB
                    const futureK = klines[i + 1];
                    if (futureK && parseFloat(futureK[4]) < close) {
                        blocks.push({
                            type: 'BULLISH',
                            high: high,
                            low: low,
                            timestamp: k[0],
                            volume: volume
                        });
                    }
                }
                
                // Bearish Order Block: YÃ¼kseliÅŸ Ã¶ncesi son kÄ±rmÄ±zÄ± mum
                if (close < open && prevClose > prevOpen) {
                    const futureK = klines[i + 1];
                    if (futureK && parseFloat(futureK[4]) > close) {
                        blocks.push({
                            type: 'BEARISH',
                            high: high,
                            low: low,
                            timestamp: k[0],
                            volume: volume
                        });
                    }
                }
            }
            
            return blocks;
        }
        
        // ===== FVG (Fair Value Gap) TESPÄ°TÄ° =====
        function detectFVG(klines) {
            const fvgs = [];
            
            for (let i = 1; i < klines.length - 1; i++) {
                const prevK = klines[i - 1];
                const currK = klines[i];
                const nextK = klines[i + 1];
                
                const prevHigh = parseFloat(prevK[2]);
                const prevLow = parseFloat(prevK[3]);
                const currHigh = parseFloat(currK[2]);
                const currLow = parseFloat(currK[3]);
                const nextHigh = parseFloat(nextK[2]);
                const nextLow = parseFloat(nextK[3]);
                
                // Bullish FVG: Alt mumun high'Ä±, Ã¼st mumun low'undan yÃ¼ksek
                if (prevLow > currHigh && nextHigh > currLow) {
                    fvgs.push({
                        type: 'BULLISH',
                        top: prevLow,
                        bottom: currHigh,
                        filled: false,
                        timestamp: currK[0]
                    });
                }
                
                // Bearish FVG: Ãœst mumun low'u, alt mumun high'Ä±ndan dÃ¼ÅŸÃ¼k
                if (prevHigh < currLow && nextLow < currHigh) {
                    fvgs.push({
                        type: 'BEARISH',
                        top: currLow,
                        bottom: prevHigh,
                        filled: false,
                        timestamp: currK[0]
                    });
                }
            }
            
            return fvgs;
        }
        
        // ===== OPTÄ°MÄ°ZE EDÄ°LMÄ°Åž PREMÄ°UM Ä°NDÄ°KATÃ–R HESAPLAMA (50+ En SaÄŸlam Ä°ndikatÃ¶r) =====
        // Gereksiz tekrarlar Ã§Ä±karÄ±ldÄ±, sadece en gÃ¼venilir ve etkili indikatÃ¶rler kaldÄ±
        function calculate90Indicators(candles, volume, avgVol) {
            const closes = candles.map(c => parseFloat(c[4]));
            const highs = candles.map(c => parseFloat(c[2]));
            const lows = candles.map(c => parseFloat(c[3]));
            const volumes = candles.map(c => parseFloat(c[5]));
            const price = closes[closes.length - 1];

            let bull = 0, bear = 0, neutral = 0;
            const indicatorDetails = {
                long: [],
                short: [],
                neutral: []
            };
            const scores = {
                trend: { bull: 0, bear: 0 },
                momentum: { bull: 0, bear: 0 },
                volume: { bull: 0, bear: 0 },
                volatility: { bull: 0, bear: 0 },
                institutional: { bull: 0, bear: 0 }
            };

            // ===== TREND Ä°NDÄ°KATÃ–RLER (Sadece En Ã–nemli Periyotlar) =====
            // SMA: Sadece kritik seviyeler (50 = Mid-term, 200 = Long-term trend)
            [50, 200].forEach(p => {
                if (closes.length >= p) {
                    const sma = closes.slice(-p).reduce((a, b) => a + b) / p;
                    if (price > sma) { 
                        bull++; scores.trend.bull++; 
                        indicatorDetails.long.push(`SMA(${p}) [${p === 50 ? 'Orta vadeli trend desteÄŸi' : 'Uzun vadeli trend desteÄŸi'}]`);
                    } else { 
                        bear++; scores.trend.bear++; 
                        indicatorDetails.short.push(`SMA(${p}) [${p === 50 ? 'Orta vadeli trend direnci' : 'Uzun vadeli trend direnci'}]`);
                    }
                }
            });

            // EMA: Sadece kritik seviyeler (9 = Short, 21 = Medium, 50 = Mid, 200 = Long)
            [9, 21, 50, 200].forEach(p => {
                if (closes.length >= p) {
                    const ema = calculateEMA(closes, p);
                    const emaValue = ema[ema.length - 1];
                    if (price > emaValue) { 
                        bull++; scores.trend.bull++; 
                        indicatorDetails.long.push(`EMA(${p}) [${p === 9 ? 'KÄ±sa vadeli momentum' : p === 21 ? 'Orta momentum' : p === 50 ? 'Trend konfirmasyonu' : 'Uzun trend'}]`);
                    } else { 
                        bear++; scores.trend.bear++; 
                        indicatorDetails.short.push(`EMA(${p}) [${p === 9 ? 'KÄ±sa vadeli zayÄ±flÄ±k' : p === 21 ? 'Orta zayÄ±flÄ±k' : p === 50 ? 'Trend zayÄ±flÄ±ÄŸÄ±' : 'Uzun trend zayÄ±flÄ±ÄŸÄ±'}]`);
                    }
                }
            });
            
            // EMA Cross Signals (En gÃ¼Ã§lÃ¼ sinyaller)
            if (closes.length >= 200) {
                const ema9 = calculateEMA(closes, 9);
                const ema21 = calculateEMA(closes, 21);
                const ema50 = calculateEMA(closes, 50);
                const ema200 = calculateEMA(closes, 200);
                
                const ema9Val = ema9[ema9.length - 1];
                const ema21Val = ema21[ema21.length - 1];
                const ema50Val = ema50[ema50.length - 1];
                const ema200Val = ema200[ema200.length - 1];
                
                // Golden Cross / Death Cross
                if (ema50Val > ema200Val) {
                    bull += 2; scores.trend.bull += 2;
                    indicatorDetails.long.push('EMA Golden Cross (50>200) [Uzun vadeli yÃ¼kseliÅŸ trendi]');
                } else {
                    bear += 2; scores.trend.bear += 2;
                    indicatorDetails.short.push('EMA Death Cross (50<200) [Uzun vadeli dÃ¼ÅŸÃ¼ÅŸ trendi]');
                }
                
                // EMA Alignment
                if (ema9Val > ema21Val && ema21Val > ema50Val && ema50Val > ema200Val) {
                    bull += 2; scores.trend.bull += 2;
                    indicatorDetails.long.push('EMA Perfect Alignment [TÃ¼m EMA\'lar yÃ¼kseliÅŸte - GÃ¼Ã§lÃ¼ trend]');
                } else if (ema9Val < ema21Val && ema21Val < ema50Val && ema50Val < ema200Val) {
                    bear += 2; scores.trend.bear += 2;
                    indicatorDetails.short.push('EMA Perfect Alignment [TÃ¼m EMA\'lar dÃ¼ÅŸÃ¼ÅŸte - GÃ¼Ã§lÃ¼ trend]');
                }
            }

            // ===== MACD (En GÃ¼venilir Trend/Momentum Ä°ndikatÃ¶rÃ¼) =====
            const macd = calculateMACD(closes);
            const macdValue = macd.macd[macd.macd.length - 1];
            const macdSignal = macd.signal[macd.signal.length - 1];
            const macdHistogram = macd.histogram[macd.histogram.length - 1];
            const prevMacdHist = macd.histogram[macd.histogram.length - 2] || 0;
            
            // MACD Line pozisyonu
            if (macdValue > 0) { 
                bull++; scores.trend.bull++; 
                indicatorDetails.long.push('MACD Line > 0 [Piyasa momentumu pozitif]');
            } else { 
                bear++; scores.trend.bear++; 
                indicatorDetails.short.push('MACD Line < 0 [Piyasa momentumu negatif]');
            }
            
            // MACD Cross (En gÃ¼Ã§lÃ¼ sinyal)
            if (macdValue > macdSignal && prevMacdHist <= 0) { 
                bull += 2; scores.trend.bull += 2; 
                indicatorDetails.long.push('MACD Bullish Cross [Yeni yÃ¼kseliÅŸ sinyali - Ã‡ok gÃ¼Ã§lÃ¼]');
            } else if (macdValue < macdSignal && prevMacdHist >= 0) { 
                bear += 2; scores.trend.bear += 2; 
                indicatorDetails.short.push('MACD Bearish Cross [Yeni dÃ¼ÅŸÃ¼ÅŸ sinyali - Ã‡ok gÃ¼Ã§lÃ¼]');
            } else if (macdValue > macdSignal) {
                bull++; scores.trend.bull++;
                indicatorDetails.long.push('MACD Above Signal [YÃ¼kseliÅŸ momentumu devam ediyor]');
            } else {
                bear++; scores.trend.bear++;
                indicatorDetails.short.push('MACD Below Signal [DÃ¼ÅŸÃ¼ÅŸ momentumu devam ediyor]');
            }
            
            // MACD Histogram momentum
            if (macdHistogram > prevMacdHist && macdHistogram > 0) {
                bull++; scores.momentum.bull++;
                indicatorDetails.long.push('MACD Histogram Accelerating [Momentum hÄ±zlanÄ±yor]');
            } else if (macdHistogram < prevMacdHist && macdHistogram < 0) {
                bear++; scores.momentum.bear++;
                indicatorDetails.short.push('MACD Histogram Decelerating [Momentum yavaÅŸlÄ±yor]');
            }

            // ===== ADX (Trend GÃ¼cÃ¼ - Sadece gerÃ§ekten gÃ¼Ã§lÃ¼ trendlerde sinyal ver) =====
            const adx = calculateADX(highs, lows, closes, 14);
            const adxValue = adx[adx.length - 1];
            if (adxValue > 25) { 
                // ADX gÃ¼Ã§lÃ¼yse, trend yÃ¶nÃ¼ne gÃ¶re sinyal ver
                const trend = closes[closes.length - 1] > closes[closes.length - 20] ? 'UP' : 'DOWN';
                if (trend === 'UP') {
                    bull += 2; scores.trend.bull += 2; 
                    indicatorDetails.long.push(`ADX ${adxValue.toFixed(1)} [GÃ¼Ã§lÃ¼ yÃ¼kseliÅŸ trendi - Trend takip et]`);
                } else {
                    bear += 2; scores.trend.bear += 2;
                    indicatorDetails.short.push(`ADX ${adxValue.toFixed(1)} [GÃ¼Ã§lÃ¼ dÃ¼ÅŸÃ¼ÅŸ trendi - Trend takip et]`);
                }
            } else if (adxValue < 20) {
                neutral++;
                indicatorDetails.neutral.push(`ADX ${adxValue.toFixed(1)} [ZayÄ±f trend - Yatay piyasa, bekle]`);
            } else {
                neutral++;
                indicatorDetails.neutral.push(`ADX ${adxValue.toFixed(1)} [Orta trend gÃ¼cÃ¼]`);
            }

            // ===== RSI (Sadece En PopÃ¼ler ve GÃ¼venilir Periyot: 14) =====
            const rsi = calculateRSI(closes, 14);
            const rsiValue = rsi[rsi.length - 1];
            const prevRSI = rsi[rsi.length - 2] || 50;
            
            // RSI Divergence tespiti (gÃ¼Ã§lÃ¼ sinyal)
            const priceHigher = price > closes[closes.length - 10];
            const rsiLower = rsiValue < prevRSI;
            if (priceHigher && rsiLower && rsiValue > 70) {
                bear += 2; scores.momentum.bear += 2;
                indicatorDetails.short.push(`RSI ${rsiValue.toFixed(1)} [Bearish Divergence - Fiyat yÃ¼kselirken RSI dÃ¼ÅŸÃ¼yor!]`);
            } else if (!priceHigher && !rsiLower && rsiValue < 30) {
                bull += 2; scores.momentum.bull += 2;
                indicatorDetails.long.push(`RSI ${rsiValue.toFixed(1)} [Bullish Divergence - Fiyat dÃ¼ÅŸerken RSI yÃ¼kseliyor!]`);
            }
            
            // RSI Seviye analizi
            if (rsiValue > 70) { 
                bear++; scores.momentum.bear++; 
                indicatorDetails.short.push(`RSI ${rsiValue.toFixed(1)} [AÅŸÄ±rÄ± alÄ±m - SatÄ±ÅŸ fÄ±rsatÄ±]`);
            } else if (rsiValue < 30) { 
                bull++; scores.momentum.bull++; 
                indicatorDetails.long.push(`RSI ${rsiValue.toFixed(1)} [AÅŸÄ±rÄ± satÄ±m - AlÄ±ÅŸ fÄ±rsatÄ±]`);
            } else if (rsiValue > 50 && rsiValue < 70) {
                bull++; scores.momentum.bull++;
                indicatorDetails.long.push(`RSI ${rsiValue.toFixed(1)} [YÃ¼kseliÅŸ momentumu - SaÄŸlÄ±klÄ±]`);
            } else if (rsiValue < 50 && rsiValue > 30) {
                bear++; scores.momentum.bear++;
                indicatorDetails.short.push(`RSI ${rsiValue.toFixed(1)} [DÃ¼ÅŸÃ¼ÅŸ momentumu - ZayÄ±f]`);
            } else {
                neutral++;
                indicatorDetails.neutral.push(`RSI ${rsiValue.toFixed(1)} [NÃ¶tr bÃ¶lge]`);
            }

            // ===== STOCHASTIC OSCILLATOR (Momentum ve AÅŸÄ±rÄ± AlÄ±m/SatÄ±m) =====
            const stoch = calculateStochastic(highs, lows, closes, 14);
            const stochK = stoch.k[stoch.k.length - 1];
            const stochD = stoch.d[stoch.d.length - 1];
            const prevStochK = stoch.k[stoch.k.length - 2] || 50;
            const prevStochD = stoch.d[stoch.d.length - 2] || 50;
            
            // Oversold/Overbought (En gÃ¼Ã§lÃ¼ sinyaller)
            if (stochK < 20 && stochD < 20) {
                bull += 2; scores.momentum.bull += 2;
                indicatorDetails.long.push(`Stochastic ${stochK.toFixed(1)}/${stochD.toFixed(1)} [AÅŸÄ±rÄ± satÄ±m - GÃ¼Ã§lÃ¼ alÄ±ÅŸ sinyali]`);
            } else if (stochK > 80 && stochD > 80) {
                bear += 2; scores.momentum.bear += 2;
                indicatorDetails.short.push(`Stochastic ${stochK.toFixed(1)}/${stochD.toFixed(1)} [AÅŸÄ±rÄ± alÄ±m - GÃ¼Ã§lÃ¼ satÄ±ÅŸ sinyali]`);
            } else if (stochK > 50) {
                bull++; scores.momentum.bull++;
                indicatorDetails.long.push(`Stochastic %K ${stochK.toFixed(1)} [YÃ¼kseliÅŸ momentumu]`);
            } else {
                bear++; scores.momentum.bear++;
                indicatorDetails.short.push(`Stochastic %K ${stochK.toFixed(1)} [DÃ¼ÅŸÃ¼ÅŸ momentumu]`);
            }
            
            // Stochastic Cross (Ã‡ok Ã¶nemli sinyal)
            if (stochK > stochD && prevStochK <= prevStochD) {
                bull += 2; scores.momentum.bull += 2;
                indicatorDetails.long.push('Stochastic Bullish Cross [%K > %D - Yeni yÃ¼kseliÅŸ sinyali]');
            } else if (stochK < stochD && prevStochK >= prevStochD) {
                bear += 2; scores.momentum.bear += 2;
                indicatorDetails.short.push('Stochastic Bearish Cross [%K < %D - Yeni dÃ¼ÅŸÃ¼ÅŸ sinyali]');
            }

            // ===== VOLUME ANALÄ°ZÄ° (Sadece Ã–nemli EÅŸikler) =====
            const volRatio = volume / avgVol;
            
            // YÃ¼ksek volume (institutional activity iÅŸareti)
            if (volRatio > 2) { 
                bull += 2; scores.volume.bull += 2; 
                indicatorDetails.long.push(`Volume ${volRatio.toFixed(2)}x [Kurumsal aktivite - Ã‡ok gÃ¼Ã§lÃ¼ sinyal]`);
            } else if (volRatio > 1.5) {
                bull++; scores.volume.bull++;
                indicatorDetails.long.push(`Volume ${volRatio.toFixed(2)}x [YÃ¼ksek volume - GÃ¼Ã§lÃ¼ hareket]`);
            } else if (volRatio < 0.7) {
                bear++;
                scores.volume.bear++;
                indicatorDetails.short.push(`Volume ${volRatio.toFixed(2)}x [DÃ¼ÅŸÃ¼k volume - ZayÄ±f hareket, dikkat]`);
            } else {
                neutral++;
                indicatorDetails.neutral.push(`Volume ${volRatio.toFixed(2)}x [Normal volume]`);
            }

            // ===== OBV (On-Balance Volume - Kurumsal akÄ±ÅŸ gÃ¶stergesi) =====
            const candleObjs = candles.map((c, i) => ({
                open: parseFloat(c[1]),
                close: parseFloat(c[4]),
                volume: parseFloat(c[5])
            }));
            
            let obv = 0;
            for (let i = 1; i < candleObjs.length; i++) {
                if (candleObjs[i].close > candleObjs[i-1].close) obv += candleObjs[i].volume;
                else if (candleObjs[i].close < candleObjs[i-1].close) obv -= candleObjs[i].volume;
            }
            
            const obvTrend = obv > 0 ? 'BULLISH' : 'BEARISH';
            if (obvTrend === 'BULLISH') { 
                bull += 2; scores.volume.bull += 2; 
                indicatorDetails.long.push('OBV Pozitif [Kurumsal birikim - YÃ¼kseliÅŸ trendi]');
            } else { 
                bear += 2; scores.volume.bear += 2; 
                indicatorDetails.short.push('OBV Negatif [Kurumsal daÄŸÄ±tÄ±m - DÃ¼ÅŸÃ¼ÅŸ trendi]');
            }

            // ===== VWAP (Volume Weighted Average Price - Kurumsal referans fiyatÄ±) =====
            const vwap = calculateVWAP(candles);
            const vwapValue = vwap[vwap.length - 1];
            const vwapDistance = ((price - vwapValue) / vwapValue) * 100;
            
            if (price > vwapValue && vwapDistance > 2) { 
                bull += 2; scores.volume.bull += 2; 
                indicatorDetails.long.push(`VWAP ${vwapDistance.toFixed(1)}% Ã¼zerinde [Kurumsal alÄ±m baskÄ±sÄ± - GÃ¼Ã§lÃ¼]`);
            } else if (price < vwapValue && vwapDistance < -2) {
                bear += 2; scores.volume.bear += 2;
                indicatorDetails.short.push(`VWAP ${Math.abs(vwapDistance).toFixed(1)}% altÄ±nda [Kurumsal satÄ±ÅŸ baskÄ±sÄ± - GÃ¼Ã§lÃ¼]`);
            } else if (price > vwapValue) {
                bull++; scores.volume.bull++;
                indicatorDetails.long.push(`VWAP Ã¼zerinde [Kurumsal alÄ±m]`);
            } else {
                bear++; scores.volume.bear++;
                indicatorDetails.short.push(`VWAP altÄ±nda [Kurumsal satÄ±ÅŸ]`);
            }

            // ===== BOLLINGER BANDS (Volatilite ve AÅŸÄ±rÄ± AlÄ±m/SatÄ±m) =====
            const bb = calculateBollingerBands(closes, 20);
            const bbMiddle = bb.middle[bb.middle.length - 1];
            const bbUpper = bb.upper[bb.upper.length - 1];
            const bbLower = bb.lower[bb.lower.length - 1];
            const bbWidth = ((bbUpper - bbLower) / bbMiddle) * 100;
            
            // Band geniÅŸliÄŸi (volatilite)
            if (bbWidth > 5) {
                neutral++;
                indicatorDetails.neutral.push(`BB GeniÅŸ ${bbWidth.toFixed(1)}% [YÃ¼ksek volatilite - Dikkatli]`);
            } else if (bbWidth < 2) {
                neutral++;
                indicatorDetails.neutral.push(`BB Dar ${bbWidth.toFixed(1)}% [DÃ¼ÅŸÃ¼k volatilite - Breakout bekleniyor]`);
            }
            
            // Fiyat pozisyonu
            if (price < bbLower) {
                bull += 2; scores.volatility.bull += 2;
                indicatorDetails.long.push(`Fiyat BB Alt BandÄ± AltÄ±nda [AÅŸÄ±rÄ± satÄ±m - GÃ¼Ã§lÃ¼ alÄ±ÅŸ fÄ±rsatÄ±]`);
            } else if (price > bbUpper) {
                bear += 2; scores.volatility.bear += 2;
                indicatorDetails.short.push(`Fiyat BB Ãœst BandÄ± ÃœstÃ¼nde [AÅŸÄ±rÄ± alÄ±m - GÃ¼Ã§lÃ¼ satÄ±ÅŸ fÄ±rsatÄ±]`);
            } else if (price > bbMiddle) {
                bull++; scores.volatility.bull++;
                indicatorDetails.long.push(`Fiyat BB OrtalamasÄ± Ãœzerinde [YÃ¼kseliÅŸ eÄŸilimi]`);
            } else {
                bear++; scores.volatility.bear++;
                indicatorDetails.short.push(`Fiyat BB OrtalamasÄ± AltÄ±nda [DÃ¼ÅŸÃ¼ÅŸ eÄŸilimi]`);
            }

            // ===== ATR (Average True Range - Volatilite ve Risk YÃ¶netimi) =====
            const atr = calculateATR(highs, lows, closes, 14);
            const atrValue = atr[atr.length - 1];
            const atrPercent = (atrValue / price) * 100;
            const priceChange = Math.abs(price - closes[closes.length - 2]);
            
            // YÃ¼ksek volatilite + trend
            if (priceChange > atrValue * 1.5) {
                if (price > closes[closes.length - 2]) {
                    bull += 2; scores.volatility.bull += 2;
                    indicatorDetails.long.push(`ATR ${atrPercent.toFixed(2)}% - YÃ¼ksek volatilite + YÃ¼kseliÅŸ [GÃ¼Ã§lÃ¼ hareket]`);
                } else {
                    bear += 2; scores.volatility.bear += 2;
                    indicatorDetails.short.push(`ATR ${atrPercent.toFixed(2)}% - YÃ¼ksek volatilite + DÃ¼ÅŸÃ¼ÅŸ [GÃ¼Ã§lÃ¼ hareket]`);
                }
            } else if (atrPercent > 5) {
                neutral++;
                indicatorDetails.neutral.push(`ATR ${atrPercent.toFixed(2)}% [YÃ¼ksek volatilite - Stop Loss geniÅŸ tut]`);
            } else {
                neutral++;
                indicatorDetails.neutral.push(`ATR ${atrPercent.toFixed(2)}% [Normal volatilite]`);
            }

            // ===== INSTITUTIONAL VOLUME (Kurumsal Aktivite - Ã‡ok Ã–nemli) =====
            if (volRatio > 3 && volume > avgVol * 3) {
                if (price > closes[closes.length - 2]) { 
                    bull += 3; scores.institutional.bull += 3; 
                    indicatorDetails.long.push(`Kurumsal Volume ${volRatio.toFixed(2)}x + AlÄ±m BaskÄ±sÄ± [Ã‡OK GÃœÃ‡LÃœ SÄ°NYAL]`);
                } else {
                    bear += 3; scores.institutional.bear += 3;
                    indicatorDetails.short.push(`Kurumsal Volume ${volRatio.toFixed(2)}x + SatÄ±ÅŸ BaskÄ±sÄ± [Ã‡OK GÃœÃ‡LÃœ SÄ°NYAL]`);
                }
            } else if (volRatio > 2) {
                bull += 2; scores.institutional.bull += 2;
                indicatorDetails.long.push(`Kurumsal Volume ${volRatio.toFixed(2)}x [Kurumsal aktivite tespit edildi]`);
            }

            // ===== ICHIMOKU CLOUD (Japon Teknik Analiz - Trend ve Destek/DirenÃ§) =====
            const ichimoku = calculateIchimoku(highs, lows, closes);
            const priceInCloud = price > Math.min(ichimoku.tenkan, ichimoku.kijun) && 
                               price < Math.max(ichimoku.tenkan, ichimoku.kijun);
            
            if (price > ichimoku.tenkan && price > ichimoku.kijun && ichimoku.tenkan > ichimoku.kijun) {
                bull += 2; scores.trend.bull += 2;
                indicatorDetails.long.push('Ichimoku Cloud [Tenkan > Kijun, fiyat Ã¼stÃ¼nde - GÃ¼Ã§lÃ¼ yÃ¼kseliÅŸ]');
            } else if (price < ichimoku.tenkan && price < ichimoku.kijun && ichimoku.tenkan < ichimoku.kijun) {
                bear += 2; scores.trend.bear += 2;
                indicatorDetails.short.push('Ichimoku Cloud [Tenkan < Kijun, fiyat altÄ±nda - GÃ¼Ã§lÃ¼ dÃ¼ÅŸÃ¼ÅŸ]');
            } else if (priceInCloud) {
                neutral++;
                indicatorDetails.neutral.push('Ichimoku Cloud [Fiyat bulut iÃ§inde - KararsÄ±z]');
            }

            // ===== SUPERTREND (Trend Takip - Ã‡ok GÃ¼venilir) =====
            const supertrend = calculateSupertrend(highs, lows, closes, 10, 3);
            const prevSupertrend = calculateSupertrend(highs.slice(0, -1), lows.slice(0, -1), closes.slice(0, -1), 10, 3);
            
            if (supertrend.direction === 'UP' && prevSupertrend.direction === 'DOWN') {
                bull += 3; scores.trend.bull += 3;
                indicatorDetails.long.push(`Supertrend UP [Trend deÄŸiÅŸimi - YENÄ° YÃœKSELÄ°Åž SÄ°NYALI - Ã‡OK GÃœÃ‡LÃœ]`);
            } else if (supertrend.direction === 'DOWN' && prevSupertrend.direction === 'UP') {
                bear += 3; scores.trend.bear += 3;
                indicatorDetails.short.push(`Supertrend DOWN [Trend deÄŸiÅŸimi - YENÄ° DÃœÅžÃœÅž SÄ°NYALI - Ã‡OK GÃœÃ‡LÃœ]`);
            } else if (supertrend.direction === 'UP') {
                bull += 2; scores.trend.bull += 2;
                indicatorDetails.long.push(`Supertrend UP [YÃ¼kseliÅŸ trendi devam ediyor - GÃ¼venilir]`);
            } else {
                bear += 2; scores.trend.bear += 2;
                indicatorDetails.short.push(`Supertrend DOWN [DÃ¼ÅŸÃ¼ÅŸ trendi devam ediyor - GÃ¼venilir]`);
            }
            
            // ===== CVD (Cumulative Volume Delta - Kurumsal AkÄ±ÅŸ) =====
            const cvd = calculateCVD(candles);
            if (cvd > 0) {
                bull += 2; scores.volume.bull += 2;
                indicatorDetails.long.push(`CVD +${cvd.toFixed(0)} [Kurumsal alÄ±m akÄ±ÅŸÄ± - YÃ¼kseliÅŸ beklentisi]`);
            } else {
                bear += 2; scores.volume.bear += 2;
                indicatorDetails.short.push(`CVD ${cvd.toFixed(0)} [Kurumsal satÄ±ÅŸ akÄ±ÅŸÄ± - DÃ¼ÅŸÃ¼ÅŸ beklentisi]`);
            }

            // ===== DARVAS BOX (Profesyonel Trader Sistemi) =====
            const darvasBox = calculateDarvasBox(highs, lows, closes, volumes);
            if (darvasBox.boxHeight > 0) {
                if (price > darvasBox.upperBox && darvasBox.breakoutDirection === 'UP') {
                    bull += 3; scores.trend.bull += 3;
                    indicatorDetails.long.push(`Darvas Box Breakout UP [${darvasBox.boxHeight.toFixed(2)}% kutu yÃ¼ksekliÄŸi - GÃ¼Ã§lÃ¼ yÃ¼kseliÅŸ sinyali]`);
                } else if (price < darvasBox.lowerBox && darvasBox.breakoutDirection === 'DOWN') {
                    bear += 3; scores.trend.bear += 3;
                    indicatorDetails.short.push(`Darvas Box Breakdown DOWN [${darvasBox.boxHeight.toFixed(2)}% kutu yÃ¼ksekliÄŸi - GÃ¼Ã§lÃ¼ dÃ¼ÅŸÃ¼ÅŸ sinyali]`);
                } else if (price >= darvasBox.lowerBox && price <= darvasBox.upperBox) {
                    neutral++;
                    indicatorDetails.neutral.push(`Darvas Box [Fiyat kutu iÃ§inde - Darvas Box: ${darvasBox.lowerBox.toFixed(2)} - ${darvasBox.upperBox.toFixed(2)}]`);
                }
            }

            // ===== SQUEEZE MOMENTUM (Gizli Profesyonel Ä°ndikatÃ¶r) =====
            const squeeze = calculateSqueezeMomentum(highs, lows, closes);
            if (squeeze.squeeze) {
                neutral++;
                indicatorDetails.neutral.push(`Squeeze MOMENTUM [SÄ±kÄ±ÅŸma tespit edildi - BÃ¼yÃ¼k hareket bekleniyor!]`);
            } else {
                if (squeeze.momentum > 0) {
                    bull += 2; scores.momentum.bull += 2;
                    indicatorDetails.long.push(`Squeeze MOMENTUM ${squeeze.momentum.toFixed(2)} [Pozitif momentum - GÃ¼Ã§lÃ¼]`);
                } else {
                    bear += 2; scores.momentum.bear += 2;
                    indicatorDetails.short.push(`Squeeze MOMENTUM ${squeeze.momentum.toFixed(2)} [Negatif momentum - GÃ¼Ã§lÃ¼]`);
                }
            }

            // ===== MARKET PROFILE (Kurumsal Seviyeler) =====
            const marketProfile = calculateMarketProfile(highs, lows, closes, volumes);
            if (marketProfile.valueArea.length > 0) {
                const vaHigh = marketProfile.valueArea[marketProfile.valueArea.length - 1];
                const vaLow = marketProfile.valueArea[0];
                const poc = marketProfile.poc;
                
                if (price > vaHigh) {
                    bull += 2; scores.institutional.bull += 2;
                    indicatorDetails.long.push(`Market Profile [Fiyat Value Area Ã¼stÃ¼nde - Kurumsal birikim bÃ¶lgesi]`);
                } else if (price < vaLow) {
                    bear += 2; scores.institutional.bear += 2;
                    indicatorDetails.short.push(`Market Profile [Fiyat Value Area altÄ±nda - Kurumsal daÄŸÄ±tÄ±m bÃ¶lgesi]`);
                } else if (price >= poc * 0.98 && price <= poc * 1.02) {
                    neutral++;
                    indicatorDetails.neutral.push(`Market Profile [Fiyat POC yakÄ±nÄ±nda - ${poc.toFixed(2)} - Dengeli bÃ¶lge]`);
                }
            }

            // ===== KELTNER CHANNELS (Volatilite + Trend) =====
            const keltner = calculateKeltnerChannels(closes, highs, lows, 20, 2);
            if (price > keltner.upper) {
                bear += 2; scores.volatility.bear += 2;
                indicatorDetails.short.push(`Keltner Upper [AÅŸÄ±rÄ± alÄ±m - SatÄ±ÅŸ fÄ±rsatÄ±]`);
            } else if (price < keltner.lower) {
                bull += 2; scores.volatility.bull += 2;
                indicatorDetails.long.push(`Keltner Lower [AÅŸÄ±rÄ± satÄ±m - AlÄ±ÅŸ fÄ±rsatÄ±]`);
            } else if (price > keltner.middle) {
                bull++; scores.trend.bull++;
                indicatorDetails.long.push(`Keltner Middle ÃœstÃ¼ [YÃ¼kseliÅŸ eÄŸilimi]`);
            } else {
                bear++; scores.trend.bear++;
                indicatorDetails.short.push(`Keltner Middle AltÄ± [DÃ¼ÅŸÃ¼ÅŸ eÄŸilimi]`);
            }

            // ===== DONCHIAN CHANNELS (Volatilite Breakout) =====
            const donchian = calculateDonchianChannels(highs, lows, 20);
            if (price > donchian.upper) {
                bull += 2; scores.volatility.bull += 2;
                indicatorDetails.long.push(`Donchian Upper Breakout [YÃ¼kseliÅŸ breakout - GÃ¼Ã§lÃ¼ sinyal]`);
            } else if (price < donchian.lower) {
                bear += 2; scores.volatility.bear += 2;
                indicatorDetails.short.push(`Donchian Lower Breakdown [DÃ¼ÅŸÃ¼ÅŸ breakdown - GÃ¼Ã§lÃ¼ sinyal]`);
            }

            // ===== TSI (True Strength Index - Momentum) =====
            const tsi = calculateTSI(closes, 25, 13);
            if (tsi > 25) {
                bull += 2; scores.momentum.bull += 2;
                indicatorDetails.long.push(`TSI ${tsi.toFixed(2)} [GÃ¼Ã§lÃ¼ yÃ¼kseliÅŸ momentumu]`);
            } else if (tsi < -25) {
                bear += 2; scores.momentum.bear += 2;
                indicatorDetails.short.push(`TSI ${tsi.toFixed(2)} [GÃ¼Ã§lÃ¼ dÃ¼ÅŸÃ¼ÅŸ momentumu]`);
            } else if (tsi > 0) {
                bull++; scores.momentum.bull++;
                indicatorDetails.long.push(`TSI ${tsi.toFixed(2)} [Pozitif momentum]`);
            } else {
                bear++; scores.momentum.bear++;
                indicatorDetails.short.push(`TSI ${tsi.toFixed(2)} [Negatif momentum]`);
            }

            // ===== CHOPPINESS INDEX (Trend/Yatay Piyasa) =====
            const chop = calculateChoppinessIndex(highs, lows, closes, 14);
            if (chop > 61.8) {
                neutral++;
                indicatorDetails.neutral.push(`Choppiness ${chop.toFixed(1)} [Yatay piyasa - Range trading]`);
            } else if (chop < 38.2) {
                bull++; scores.trend.bull++;
                indicatorDetails.long.push(`Choppiness ${chop.toFixed(1)} [Trend piyasa - Trend takip]`);
            } else {
                neutral++;
                indicatorDetails.neutral.push(`Choppiness ${chop.toFixed(1)} [Karma piyasa]`);
            }

            // ===== VOLUME PROFILE (Kurumsal Seviyeler) =====
            const volProfile = calculateVolumeProfile(candles, 20);
            if (volProfile.highVolumeNodes.length > 0) {
                const nearestNode = volProfile.highVolumeNodes[volProfile.highVolumeNodes.length - 1];
                const distance = Math.abs(price - nearestNode.price) / price * 100;
                if (distance < 2) {
                    neutral++;
                    indicatorDetails.neutral.push(`Volume Profile [Fiyat yÃ¼ksek volume node yakÄ±nÄ±nda - ${nearestNode.price.toFixed(2)} - Destek/DirenÃ§]`);
                }
            }

            return {
                bull,
                bear,
                neutral,
                score: Math.round((bull / (bull + bear + neutral || 1)) * 100),
                scores,
                indicatorDetails,
                rsi: calculateRSI(closes, 14)[calculateRSI(closes, 14).length - 1].toFixed(2),
                macd: macd.histogram[macd.histogram.length - 1].toFixed(8),
                adx: adxValue.toFixed(2),
                stoch: stochK.toFixed(2)
            };
        }

        // ===== ICHIMOKU CLOUD =====
        function calculateIchimoku(highs, lows, closes) {
            const tenkanPeriod = 9;
            const kijunPeriod = 26;
            const senkouBPeriod = 52;
            
            const tenkanHigh = Math.max(...highs.slice(-tenkanPeriod));
            const tenkanLow = Math.min(...lows.slice(-tenkanPeriod));
            const tenkan = (tenkanHigh + tenkanLow) / 2;
            
            const kijunHigh = Math.max(...highs.slice(-kijunPeriod));
            const kijunLow = Math.min(...lows.slice(-kijunPeriod));
            const kijun = (kijunHigh + kijunLow) / 2;
            
            const senkouBHigh = Math.max(...highs.slice(-senkouBPeriod));
            const senkouBLow = Math.min(...lows.slice(-senkouBPeriod));
            const senkouB = (senkouBHigh + senkouBLow) / 2;
            
            return { tenkan, kijun, senkouB };
        }

        // ===== SUPERTREND =====
        function calculateSupertrend(highs, lows, closes, period = 10, multiplier = 3) {
            const atr = calculateATR(highs, lows, closes, period);
            const atrValue = atr[atr.length - 1];
            const hlAvg = (highs[highs.length - 1] + lows[lows.length - 1]) / 2;
            const upperBand = hlAvg + (multiplier * atrValue);
            const lowerBand = hlAvg - (multiplier * atrValue);
            const price = closes[closes.length - 1];
            
            const direction = price > upperBand ? 'UP' : price < lowerBand ? 'DOWN' : 
                             price > (upperBand + lowerBand) / 2 ? 'UP' : 'DOWN';
            const value = direction === 'UP' ? lowerBand : upperBand;
            
            return { direction, value };
        }

        // ===== INSTITUTIONAL ANALÄ°Z =====
        function analyzeInstitutional(candles, volumes) {
            const avgVol = volumes.reduce((a, b) => a + b, 0) / volumes.length;
            let buyPressure = 0, sellPressure = 0, blockTrades = 0;

            for (let i = 1; i < candles.length; i++) {
                const change = parseFloat(candles[i][4]) - parseFloat(candles[i - 1][4]);
                const vol = parseFloat(candles[i][5]);
                const volWeight = vol / avgVol;
                
                if (volWeight > 2.5) blockTrades++;
                
                if (change > 0 && volWeight > 1.2) buyPressure += volWeight;
                if (change < 0 && volWeight > 1.2) sellPressure += volWeight;
            }

            const darkPoolActivity = blockTrades > 5 ? 'VERY HIGH' : 
                                     blockTrades > 3 ? 'HIGH' : 
                                     blockTrades > 1 ? 'MEDIUM' : 'LOW';

            return {
                darkPool: darkPoolActivity,
                orderFlow: buyPressure > sellPressure ? 'STRONG BUY' : 
                           buyPressure > sellPressure * 0.8 ? 'BUY' : 
                           sellPressure > buyPressure * 0.8 ? 'SELL' : 'STRONG SELL',
                buyPressure: buyPressure.toFixed(2),
                sellPressure: sellPressure.toFixed(2),
                blockTrades,
                ratio: (buyPressure / (buyPressure + sellPressure || 1) * 100).toFixed(1)
            };
        }

        // ===== WHALE ANALÄ°Z =====
        function analyzeWhales(candles, avgVol) {
            const whaleThreshold = avgVol * 3;
            const whaleOrders = [];
            
            for (let i = 0; i < candles.length; i++) {
                if (parseFloat(candles[i][5]) > whaleThreshold) {
                    whaleOrders.push({
                        volume: parseFloat(candles[i][5]),
                        close: parseFloat(candles[i][4]),
                        open: parseFloat(candles[i][1])
                    });
                }
            }
            
            const recent = whaleOrders.slice(-10);
            const buys = recent.filter(w => w.close > w.open).length;
            const sells = recent.filter(w => w.close < w.open).length;
            
            const buyVolume = recent
                .filter(w => w.close > w.open)
                .reduce((sum, w) => sum + w.volume, 0);
            const sellVolume = recent
                .filter(w => w.close < w.open)
                .reduce((sum, w) => sum + w.volume, 0);

            const status = whaleOrders.length > 10 ? 'VERY ACTIVE' : 
                           whaleOrders.length > 5 ? 'ACTIVE' : 
                           whaleOrders.length > 2 ? 'MODERATE' : 'QUIET';

            return {
                status,
                orders: whaleOrders.length,
                recentOrders: recent.length,
                buys,
                sells,
                sentiment: buys > sells ? 'STRONG BULLISH' : 
                           buys === sells ? 'NEUTRAL' : 'STRONG BEARISH',
                accumulation: ((buyVolume / (buyVolume + sellVolume || 1)) * 100).toFixed(1),
                distribution: ((sellVolume / (buyVolume + sellVolume || 1)) * 100).toFixed(1),
                netFlow: (buyVolume - sellVolume).toFixed(0)
            };
        }

        // ===== MARKET MAKERS ANALÄ°Z (WYCKOFF & VSA) =====
        function analyzeMarketMakers(candles) {
            const closes = candles.map(c => parseFloat(c[4]));
            const volumes = candles.map(c => parseFloat(c[5]));
            const highs = candles.map(c => parseFloat(c[2]));
            const lows = candles.map(c => parseFloat(c[3]));
            
            const recentHigh = Math.max(...closes.slice(-50));
            const recentLow = Math.min(...closes.slice(-50));
            const price = closes[closes.length - 1];
            const position = ((price - recentLow) / (recentHigh - recentLow) * 100).toFixed(1);

            let phase = 'MARKDOWN';
            if (position < 25) phase = 'ACCUMULATION';
            else if (position < 40) phase = 'ACCUMULATION/MARKUP';
            else if (position < 60) phase = 'MARKUP';
            else if (position < 75) phase = 'MARKUP/DISTRIBUTION';
            else phase = 'DISTRIBUTION';

            let cvd = 0;
            for (let i = 1; i < candles.length; i++) {
                const change = parseFloat(candles[i][4]) - parseFloat(candles[i][1]);
                const vol = parseFloat(candles[i][5]);
                if (change > 0) cvd += vol;
                else cvd -= vol;
            }

            const avgVol = volumes.reduce((a, b) => a + b, 0) / volumes.length;
            const lastVol = volumes[volumes.length - 1];
            const lastHigh = parseFloat(candles[candles.length - 1][2]);
            const lastLow = parseFloat(candles[candles.length - 1][3]);
            const lastRange = lastHigh - lastLow;
            const avgRange = candles.slice(-20).reduce((sum, c) => sum + (parseFloat(c[2]) - parseFloat(c[3])), 0) / 20;

            let vsa = 'NEUTRAL';
            const lastClose = parseFloat(candles[candles.length - 1][4]);
            const lastOpen = parseFloat(candles[candles.length - 1][1]);
            
            if (lastVol > avgVol * 2 && lastRange < avgRange * 0.6) vsa = 'STRONG ABSORPTION';
            else if (lastVol > avgVol * 1.5 && lastRange < avgRange * 0.7) vsa = 'ABSORPTION';
            else if (lastVol > avgVol * 1.8 && lastClose > lastOpen) vsa = 'STRONG BULLISH';
            else if (lastVol > avgVol * 1.5 && lastClose > lastOpen) vsa = 'BULLISH';
            else if (lastVol > avgVol * 1.8 && lastClose < lastOpen) vsa = 'STRONG BEARISH';
            else if (lastVol > avgVol * 1.5 && lastClose < lastOpen) vsa = 'BEARISH';

            return {
                wyckoff: { phase, position },
                cvd: { 
                    value: cvd, 
                    trend: cvd > 0 ? 'STRONG BULLISH' : cvd < 0 ? 'STRONG BEARISH' : 'NEUTRAL',
                    strength: Math.abs(cvd / 1000000).toFixed(2)
                },
                vsa,
                volumeProfile: {
                    current: lastVol.toFixed(0),
                    average: avgVol.toFixed(0),
                    ratio: (lastVol / avgVol).toFixed(2)
                }
            };
        }

        // ===== SMART MONEY DETAYLI ANALÄ°Z =====
        function analyzeSmartMoneyConcepts(candles) {
            const closes = candles.map(c => parseFloat(c[4]));
            const highs = candles.map(c => parseFloat(c[2]));
            const lows = candles.map(c => parseFloat(c[3]));

            let bos = 'NEUTRAL';
            const lookback = 30;
            if (candles.length > lookback + 10) {
                const recentHigh = Math.max(...highs.slice(-lookback, -10));
                const currentHigh = Math.max(...highs.slice(-10));
                const recentLow = Math.min(...lows.slice(-lookback, -10));
                const currentLow = Math.min(...lows.slice(-10));
                
                if (currentHigh > recentHigh * 1.01) bos = 'STRONG BULLISH BOS';
                else if (currentHigh > recentHigh) bos = 'BULLISH BOS';
                else if (currentLow < recentLow * 0.99) bos = 'STRONG BEARISH BOS';
                else if (currentLow < recentLow) bos = 'BEARISH BOS';
            }

            let choch = 'NEUTRAL';
            if (candles.length > 20) {
                const trend1 = closes.slice(-20, -10);
                const trend2 = closes.slice(-10);
                const avg1 = trend1.reduce((a, b) => a + b) / trend1.length;
                const avg2 = trend2.reduce((a, b) => a + b) / trend2.length;
                
                if (avg1 < avg2 && avg2 > avg1 * 1.015) choch = 'STRONG BULLISH CHOCH';
                else if (avg1 < avg2 && avg2 > avg1 * 1.005) choch = 'BULLISH CHOCH';
                else if (avg1 > avg2 && avg2 < avg1 * 0.985) choch = 'STRONG BEARISH CHOCH';
                else if (avg1 > avg2 && avg2 < avg1 * 0.995) choch = 'BEARISH CHOCH';
            }

            const high = Math.max(...highs.slice(-100));
            const low = Math.min(...lows.slice(-100));
            const price = closes[closes.length - 1];
            const position = (price - low) / (high - low);
            
            let zone = 'EQUILIBRIUM';
            if (position > 0.618) zone = 'PREMIUM';
            else if (position > 0.5) zone = 'PREMIUM EQUILIBRIUM';
            else if (position < 0.382) zone = 'DISCOUNT';
            else if (position < 0.5) zone = 'DISCOUNT EQUILIBRIUM';

            return {
                bos,
                choch,
                fvg: fvgData[Object.keys(fvgData)[0]] || [],
                orderBlocks: orderBlocks[Object.keys(orderBlocks)[0]] || [],
                zone,
                position: (position * 100).toFixed(1),
                priceRange: {
                    high: high.toFixed(8),
                    low: low.toFixed(8),
                    current: price.toFixed(8)
                }
            };
        }

        // ===== TRADER ANALÄ°Z =====
        function analyzeTraders(candles, institutional) {
            const volumes = candles.map(c => parseFloat(c[5]));
            const avgVol = volumes.reduce((a, b) => a + b, 0) / volumes.length;

            const retailVol = volumes.filter(v => v < avgVol * 1.5).reduce((a, b) => a + b, 0);
            const instVol = volumes.filter(v => v >= avgVol * 1.5).reduce((a, b) => a + b, 0);
            const totalVol = retailVol + instVol;

            const sentiment = parseFloat(institutional.buyPressure) > parseFloat(institutional.sellPressure) 
                ? 'STRONG BULLISH' 
                : parseFloat(institutional.buyPressure) > parseFloat(institutional.sellPressure) * 0.9
                ? 'BULLISH'
                : parseFloat(institutional.sellPressure) > parseFloat(institutional.buyPressure) * 0.9
                ? 'BEARISH'
                : 'STRONG BEARISH';

            return {
                retail: retailVol.toFixed(0),
                institutional: instVol.toFixed(0),
                ratio: (instVol / (totalVol || 1) * 100).toFixed(1),
                retailRatio: (retailVol / (totalVol || 1) * 100).toFixed(1),
                sentiment,
                smartMoney: institutional.orderFlow.includes('BUY') ? 'STRONG BUYING' : 'STRONG SELLING',
                dominance: instVol > retailVol ? 'INSTITUTIONAL' : 'RETAIL'
            };
        }

        // ===== PUMP & DUMP ANALÄ°Z =====
        function analyzePumpDump(candles, bb, volume, avgVol) {
            const price = parseFloat(candles[candles.length - 1][4]);
            const prevPrice = parseFloat(candles[candles.length - 2][4]);
            const change = ((price - prevPrice) / prevPrice) * 100;
            
            const closes = candles.map(c => parseFloat(c[4]));
            const highs = candles.map(c => parseFloat(c[2]));
            const lows = candles.map(c => parseFloat(c[3]));
            const adx = calculateADX(highs, lows, closes, 14);
            const volSpike = volume / avgVol;
            
            let signal = 'NEUTRAL';
            let strength = 0;
            const bbUpper = bb.upper[bb.upper.length - 1];
            const bbLower = bb.lower[bb.lower.length - 1];
            
            if (price > bbUpper && volSpike > 2 && adx[adx.length - 1] > 25) {
                signal = 'ðŸš€ STRONG PUMP';
                strength = 95;
            } else if (price > bbUpper && volSpike > 1.5) {
                signal = 'ðŸ“ˆ PUMP DETECTED';
                strength = 75;
            } else if (price < bbLower && volSpike > 2 && adx[adx.length - 1] > 25) {
                signal = 'ðŸ’¥ STRONG DUMP';
                strength = 5;
            } else if (price < bbLower && volSpike > 1.5) {
                signal = 'ðŸ“‰ DUMP DETECTED';
                strength = 25;
            }
            
            return {
                signal,
                strength,
                volSpike: volSpike.toFixed(2),
                priceChange: change.toFixed(2),
                adxStrength: adx[adx.length - 1].toFixed(2),
                bbPosition: price > bbUpper ? 'ABOVE UPPER' : 
                            price < bbLower ? 'BELOW LOWER' : 
                            price > bb.middle[bb.middle.length - 1] ? 'ABOVE MIDDLE' : 'BELOW MIDDLE'
            };
        }

        // ===== TREND BREAK ANALÄ°Z =====
        function analyzeTrendBreak(candles) {
            const closes = candles.map(c => parseFloat(c[4]));
            const highs = candles.map(c => parseFloat(c[2]));
            const lows = candles.map(c => parseFloat(c[3]));
            
            const recentHighs = [];
            const recentLows = [];
            
            for (let i = 5; i < candles.length - 5; i++) {
                const isHigh = highs[i] === Math.max(...highs.slice(i - 5, i + 6));
                const isLow = lows[i] === Math.min(...lows.slice(i - 5, i + 6));
                
                if (isHigh) recentHighs.push({ index: i, value: highs[i] });
                if (isLow) recentLows.push({ index: i, value: lows[i] });
            }
            
            let trendlineBreak = 'NO BREAK';
            const price = closes[closes.length - 1];
            
            if (recentHighs.length >= 2) {
                const lastTwo = recentHighs.slice(-2);
                const slope = (lastTwo[1].value - lastTwo[0].value) / (lastTwo[1].index - lastTwo[0].index);
                const projected = lastTwo[1].value + slope * (candles.length - 1 - lastTwo[1].index);
                
                if (price > projected * 1.01) trendlineBreak = 'ðŸ”¥ BULLISH BREAKOUT';
                else if (price > projected) trendlineBreak = 'âœ… BULLISH BREAK';
            }
            
            if (recentLows.length >= 2) {
                const lastTwo = recentLows.slice(-2);
                const slope = (lastTwo[1].value - lastTwo[0].value) / (lastTwo[1].index - lastTwo[0].index);
                const projected = lastTwo[1].value + slope * (candles.length - 1 - lastTwo[1].index);
                
                if (price < projected * 0.99) trendlineBreak = 'ðŸ’¥ BEARISH BREAKDOWN';
                else if (price < projected) trendlineBreak = 'âš ï¸ BEARISH BREAK';
            }
            
            return {
                signal: trendlineBreak,
                pivotHighs: recentHighs.length,
                pivotLows: recentLows.length,
                lastHigh: recentHighs.length > 0 ? recentHighs[recentHighs.length - 1].value.toFixed(8) : 'N/A',
                lastLow: recentLows.length > 0 ? recentLows[recentLows.length - 1].value.toFixed(8) : 'N/A'
            };
        }

        // ===== PEAKS & DIPS ANALÄ°Z =====
        function analyzePeaksAndDips(candles) {
            const closes = candles.map(c => parseFloat(c[4]));
            const highs = candles.map(c => parseFloat(c[2]));
            const lows = candles.map(c => parseFloat(c[3]));
            
            const rsi = calculateRSI(closes, 14);
            const rsiValue = rsi[rsi.length - 1];
            
            const high = Math.max(...highs.slice(-100));
            const low = Math.min(...lows.slice(-100));
            const range = high - low;
            const price = closes[closes.length - 1];
            
            const fib382 = low + range * 0.382;
            const fib500 = low + range * 0.500;
            const fib618 = low + range * 0.618;
            
            let signal = 'NEUTRAL';
            let confidence = 50;
            
            if (rsiValue < 30 && price < fib382) {
                signal = 'ðŸŽ¯ STRONG DIP - BUY';
                confidence = 85;
            } else if (rsiValue < 40 && price < fib500) {
                signal = 'âœ… DIP - BUY';
                confidence = 70;
            } else if (rsiValue > 70 && price > fib618) {
                signal = 'âš ï¸ PEAK - SELL';
                confidence = 85;
            } else if (rsiValue > 60 && price > fib500) {
                signal = 'ðŸ”” NEAR PEAK - CAUTION';
                confidence = 70;
            }
            
            const ema20 = calculateEMA(closes, 20);
            const ema50 = calculateEMA(closes, 50);
            const trendConfirmation = price > ema20 && ema20 > ema50 ? 'BULLISH' : 
                                      price < ema20 && ema20 < ema50 ? 'BEARISH' : 'NEUTRAL';
            
            return {
                signal,
                confidence,
                rsi: rsiValue.toFixed(2),
                fibLevel: Math.abs(price - fib382) < Math.abs(price - fib500) && Math.abs(price - fib382) < Math.abs(price - fib618) ? '0.382' :
                          Math.abs(price - fib500) < Math.abs(price - fib618) ? '0.500' : '0.618',
                trendConfirmation,
                recommendation: confidence > 75 ? 'STRONG' : confidence > 60 ? 'MODERATE' : 'WEAK'
            };
        }

        // Helper function for OBV calculation
        function calculateOBV(klines) {
            let obv = 0;
            for (let i = 1; i < klines.length; i++) {
                const prevClose = parseFloat(klines[i - 1][4]);
                const currClose = parseFloat(klines[i][4]);
                const volume = parseFloat(klines[i][5]);
                
                if (currClose > prevClose) obv += volume;
                else if (currClose < prevClose) obv -= volume;
            }
            return obv;
        }

        // ===== UI GÃœNCELLEME FONKSÄ°YONLARI =====
        function updateCoinCount() {
            const coinCount = Object.keys(realPrices).length;
            const coinCountElement = document.getElementById('totalCoins');
            if (coinCountElement) {
                coinCountElement.textContent = coinCount;
            }
            
            // Console'da borsa daÄŸÄ±lÄ±mÄ±nÄ± gÃ¶ster
            const exchangeCounts = {};
            Object.values(realPrices).forEach(price => {
                const ex = price.exchange || price.source || 'Unknown';
                exchangeCounts[ex] = (exchangeCounts[ex] || 0) + 1;
            });
            console.log('ðŸ“Š Borsa DaÄŸÄ±lÄ±mÄ±:', exchangeCounts);
        }
        
        function updatePriceDisplays() {
            Object.keys(realPrices).forEach(pair => {
                updatePriceDisplay(pair);
            });
        }
        
        function updatePriceDisplay(pair) {
            const priceData = realPrices[pair];
            if (!priceData) return;
            
            // EÄŸer results sayfasÄ±nda bu coin gÃ¶rÃ¼ntÃ¼leniyorsa gÃ¼ncelle
            const resultCards = document.querySelectorAll('.result-card');
            resultCards.forEach(card => {
                const coinName = card.querySelector('.coin-name');
                if (coinName && coinName.textContent === pair) {
                    const priceElement = card.querySelector('.coin-price');
                    const changeElement = card.querySelector('.price-change');
                    
                    if (priceElement) {
                        priceElement.textContent = `$${priceData.price.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                    }
                    
                    if (changeElement) {
                        changeElement.className = `price-change ${priceData.change >= 0 ? 'price-up' : 'price-down'}`;
                        changeElement.innerHTML = `${priceData.change >= 0 ? 'â–²' : 'â–¼'} ${Math.abs(priceData.change).toFixed(2)}%`;
                    }
                }
            });
        }
        
        function updateFearGreedDisplay() {
            if (!fearGreedIndex) return;
            
            const fearGreedElements = document.querySelectorAll('#feature-fear');
            fearGreedElements.forEach(el => {
                const meter = el.querySelector('.fear-greed-meter');
                if (meter) {
                    const pointer = meter.querySelector('.fear-greed-pointer');
                    if (pointer) {
                        pointer.style.left = `${fearGreedIndex.value}%`;
                    }
                    
                    const valueDisplay = el.querySelector('div[style*="font-size:4em"]');
                    if (valueDisplay) {
                        valueDisplay.textContent = fearGreedIndex.value;
                    }
                }
            });
        }
        
        // ===== FUNDING RATES GÃ–RSELLEÅžTÄ°RME =====
        function updateFundingRatesDisplay() {
            const container = document.getElementById('funding-rates-container');
            if (!container) return;
            
            container.innerHTML = '';
            
            Object.keys(fundingRates).forEach(symbol => {
                const rate = fundingRates[symbol];
                const pair = symbol.replace('USDT', '/USDT');
                const ratePercent = rate.fundingRate || 0;
                const isPositive = ratePercent > 0;
                const color = isPositive ? '#ff6b6b' : '#4ecdc4';
                
                const card = document.createElement('div');
                card.style.cssText = `
                    background: rgba(255, 255, 255, 0.05);
                    backdrop-filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.18);
                    border-radius: 15px;
                    padding: 20px;
                    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                `;
                
                card.innerHTML = `
                    <div style="font-size: 1.3em; font-weight: bold; margin-bottom: 10px; color: ${color};">${pair}</div>
                    <div style="font-size: 2em; font-weight: bold; color: ${color}; margin-bottom: 10px;">
                        ${isPositive ? '+' : ''}${ratePercent.toFixed(4)}%
                    </div>
                    <div style="font-size: 0.9em; color: #aaa; margin-bottom: 5px;">
                        Mark Price: $${rate.markPrice?.toFixed(2) || 'N/A'}
                    </div>
                    <div style="font-size: 0.9em; color: #aaa; margin-bottom: 5px;">
                        Index Price: $${rate.indexPrice?.toFixed(2) || 'N/A'}
                    </div>
                    <div style="font-size: 0.8em; color: #888;">
                        Next Funding: ${rate.nextFundingTime ? new Date(rate.nextFundingTime).toLocaleTimeString() : 'N/A'}
                    </div>
                    <div style="margin-top: 15px; height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
                        <div style="height: 100%; width: ${Math.min(100, Math.abs(ratePercent) * 100)}%; background: ${color};"></div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        // ===== HEATMAP GERÃ‡EK ZAMANLI GÃœNCELLEME =====
        function updateHeatmap() {
            const heatmapContainer = document.querySelector('.heatmap-container');
            if (!heatmapContainer) return;
            
            heatmapContainer.innerHTML = generateHeatmap();
        }
        
        // Heatmap'i her 30 saniyede bir gÃ¼ncelle
        setInterval(updateHeatmap, 30000);

        async function getAIAnalysis(coin, priceData, indicators = null) {
            try {
                const langText = currentLanguage === 'de' ? 'DEUTSCH' : 'TÃœRKÃ‡E';
                let technicalData = '';
                let advancedData = '';
                
                if (indicators) {
                    technicalData = `
Technical Indicators:
- RSI: ${indicators.rsi?.toFixed(2) || 'N/A'} ${indicators.rsi < 30 ? '(Oversold)' : indicators.rsi > 70 ? '(Overbought)' : '(Neutral)'}
- MACD: ${indicators.macd?.toFixed(4) || 'N/A'} | Signal: ${indicators.macdSignal?.toFixed(4) || 'N/A'} | Histogram: ${indicators.macdHistogram?.toFixed(4) || 'N/A'}
- EMA Trend: ${indicators.trend || 'N/A'} (EMA9: ${indicators.ema9?.toFixed(2) || 'N/A'}, EMA21: ${indicators.ema21?.toFixed(2) || 'N/A'}, EMA50: ${indicators.ema50?.toFixed(2) || 'N/A'})
- Bollinger Bands: Price ${priceData.price.toFixed(2)} | Upper: ${indicators.bbUpper?.toFixed(2) || 'N/A'} | Lower: ${indicators.bbLower?.toFixed(2) || 'N/A'}
- Volume Ratio: ${indicators.volumeRatio?.toFixed(2) || 'N/A'}x
- Stochastic: ${indicators.stochastic?.toFixed(2) || 'N/A'} / ${indicators.stochasticD?.toFixed(2) || 'N/A'}
- ADX: ${indicators.adx?.toFixed(2) || 'N/A'}
- ATR: ${indicators.atr?.toFixed(2) || 'N/A'}
- VWAP: ${indicators.vwap?.toFixed(2) || 'N/A'}`;

                    // 90 Ä°ndikatÃ¶r analizi
                    if (indicators.indicators90) {
                        advancedData += `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“Š 90 Ä°NDÄ°KATÃ–R ANALÄ°ZÄ°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ Bull/Bear: ${indicators.indicators90.bull}/${indicators.indicators90.bear}
â€¢ Trend Bull/Bear: ${indicators.indicators90.scores?.trend?.bull || 0}/${indicators.indicators90.scores?.trend?.bear || 0}
â€¢ Momentum Bull/Bear: ${indicators.indicators90.scores?.momentum?.bull || 0}/${indicators.indicators90.scores?.momentum?.bear || 0}
â€¢ Volume Bull/Bear: ${indicators.indicators90.scores?.volume?.bull || 0}/${indicators.indicators90.scores?.volume?.bear || 0}
â€¢ Volatility Bull/Bear: ${indicators.indicators90.scores?.volatility?.bull || 0}/${indicators.indicators90.scores?.volatility?.bear || 0}
â€¢ Institutional Bull/Bear: ${indicators.indicators90.scores?.institutional?.bull || 0}/${indicators.indicators90.scores?.institutional?.bear || 0}`;
                    }

                    // Institutional analiz
                    if (indicators.institutional) {
                        advancedData += `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ¢ KURUMSAL ANALÄ°Z
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ Dark Pool: ${indicators.institutional.darkPool || 'N/A'}
â€¢ Order Flow: ${indicators.institutional.orderFlow || 'N/A'}
â€¢ Buy Pressure: ${indicators.institutional.buyPressure || 'N/A'}
â€¢ Sell Pressure: ${indicators.institutional.sellPressure || 'N/A'}
â€¢ Block Trades: ${indicators.institutional.blockTrades || 0}
â€¢ Buy/Sell Ratio: ${indicators.institutional.ratio || 'N/A'}%`;
                    }

                    // Whale analiz
                    if (indicators.whales) {
                        advancedData += `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ‹ WHALE ANALÄ°ZÄ°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ Status: ${indicators.whales.status || 'N/A'}
â€¢ Toplam Orders: ${indicators.whales.orders || 0}
â€¢ Son Aktivite: ${indicators.whales.recentOrders || 0} orders
â€¢ Buys/Sells: ${indicators.whales.buys || 0}/${indicators.whales.sells || 0}
â€¢ Sentiment: ${indicators.whales.sentiment || 'N/A'}
â€¢ Accumulation: ${indicators.whales.accumulation || 'N/A'}%
â€¢ Distribution: ${indicators.whales.distribution || 'N/A'}%
â€¢ Net Flow: ${indicators.whales.netFlow || 'N/A'}`;
                    }

                    // Market Makers
                    if (indicators.marketMakers) {
                        advancedData += `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸŽ¯ MARKET MAKERS (WYCKOFF & VSA)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ Wyckoff Phase: ${indicators.marketMakers.wyckoff?.phase || 'N/A'}
â€¢ Position: ${indicators.marketMakers.wyckoff?.position || 'N/A'}%
â€¢ CVD Trend: ${indicators.marketMakers.cvd?.trend || 'N/A'}
â€¢ CVD Strength: ${indicators.marketMakers.cvd?.strength || 'N/A'}
â€¢ VSA: ${indicators.marketMakers.vsa || 'N/A'}
â€¢ Volume Ratio: ${indicators.marketMakers.volumeProfile?.ratio || 'N/A'}x`;
                    }

                    // Smart Money
                    if (indicators.smartMoneyConcepts) {
                        advancedData += `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ’Ž SMART MONEY CONCEPTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ BOS (Break of Structure): ${indicators.smartMoneyConcepts.bos || 'N/A'}
â€¢ CHoCH: ${indicators.smartMoneyConcepts.choch || 'N/A'}
â€¢ Zone: ${indicators.smartMoneyConcepts.zone || 'N/A'}
â€¢ Position: ${indicators.smartMoneyConcepts.position || 'N/A'}%
â€¢ Fair Value Gaps: ${indicators.smartMoneyConcepts.fvg?.length || 0} adet
â€¢ Order Blocks: ${indicators.smartMoneyConcepts.orderBlocks?.length || 0} adet`;
                    }

                    // Trader analiz
                    if (indicators.traders) {
                        advancedData += `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ‘¥ TRADER ANALÄ°ZÄ°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ Retail vs Institutional: ${indicators.traders.retailRatio || 'N/A'}% / ${indicators.traders.ratio || 'N/A'}%
â€¢ Dominance: ${indicators.traders.dominance || 'N/A'}
â€¢ Sentiment: ${indicators.traders.sentiment || 'N/A'}
â€¢ Smart Money: ${indicators.traders.smartMoney || 'N/A'}`;
                    }

                    // Stratejik sinyaller
                    if (indicators.pumpDump || indicators.trendBreak || indicators.peaksAndDips) {
                        advancedData += `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸŽ¯ STRATEJÄ°K SINYALLER
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”`;
                        if (indicators.pumpDump) {
                            advancedData += `
â€¢ Pump & Dump: ${indicators.pumpDump.signal || 'N/A'} (${indicators.pumpDump.strength || 0}/100)
â€¢ Volume Spike: ${indicators.pumpDump.volSpike || 'N/A'}x`;
                        }
                        if (indicators.trendBreak) {
                            advancedData += `
â€¢ Trend Break: ${indicators.trendBreak.signal || 'N/A'}
â€¢ Pivots: ${indicators.trendBreak.pivotHighs || 0}H/${indicators.trendBreak.pivotLows || 0}L`;
                        }
                        if (indicators.peaksAndDips) {
                            advancedData += `
â€¢ Peaks & Dips: ${indicators.peaksAndDips.signal || 'N/A'} (Confidence: ${indicators.peaksAndDips.confidence || 0}%)`;
                        }
                    }
                }
                
                const prompt = `Sen profesyonel kripto analistsin. AÅŸaÄŸÄ±daki verileri analiz et ve ${langText} dilinde DETAYLI analiz yap:

ðŸŽ¯ ${coin}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ðŸ“Š GENEL
â€¢ Fiyat: $${priceData.price}
â€¢ 24h DeÄŸiÅŸim: ${priceData.change.toFixed(2)}%
â€¢ 24h Volume: $${(priceData.volume/1000000).toFixed(0)}M
â€¢ 24h High: $${priceData.high24h?.toFixed(2) || 'N/A'}
â€¢ 24h Low: $${priceData.low24h?.toFixed(2) || 'N/A'}${technicalData}${advancedData}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

DETAYLI ANALÄ°Z ${langText}:

1ï¸âƒ£ 90 Ä°NDÄ°KATÃ–R DEÄžERLENDÄ°RMESÄ°:
   - Trend, Momentum, Volume, Volatility, Institutional analizini yap
   - Her kategorinin Bull/Bear oranÄ±nÄ± yorumla
   - Teknik indikatÃ¶rlerin (RSI, MACD, ADX, Stoch) birleÅŸik mesajÄ±nÄ± aÃ§Ä±kla

2ï¸âƒ£ KURUMSAL & WHALE & SMART MONEY:
   - Dark Pool aktivitesi ve Order Flow'u yorumla
   - Whale aktivitesi ve accumulation/distribution analizini yap
   - Wyckoff fazÄ± ve Market Maker stratejisini aÃ§Ä±kla
   - Smart Money Concepts (BOS, CHoCH, FVG, Order Blocks) deÄŸerlendirmesi
   - CVD ve VSA sinyallerini yorumla

3ï¸âƒ£ STRATEJÄ°K SINYALLER:
   - Pump & Dump tespitini deÄŸerlendir
   - Trend kÄ±rÄ±lÄ±mlarÄ±nÄ± analiz et
   - Peak & Dip sinyallerini yorumla

4ï¸âƒ£ SONUÃ‡ VE TAVSÄ°YE:
   **ðŸ“Œ KARAR: [AL / SAT / BEKLE / GÃœÃ‡LÃœ AL / GÃœÃ‡LÃœ SAT]**
   **â° ZAMAN: [HEMEN / 1-4 SAAT / 4-12 SAAT / 1-3 GÃœN]**
   **ðŸŽ¯ GÃœVEN: [%XX]**
   **âš ï¸ RÄ°SK SEVÄ°YESÄ°: [DÃœÅžÃœK / ORTA / YÃœKSEK]**
   
   Net ve anlaÅŸÄ±lÄ±r ÅŸekilde AL/SAT/BEKLE kararÄ±nÄ± ver ve nedenlerini aÃ§Ä±kla.

PROFESYONEL, DETAYLI ve SOMUT ANALÄ°Z YAP!`;

                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEYS.GROQ}`
                    },
                    body: JSON.stringify({
                        model: 'llama-3.3-70b-versatile',
                        messages: [
                            { 
                                role: 'system', 
                                content: `Sen profesyonel kripto para analisti ve trader'sÄ±n. ${langText} dilinde detaylÄ±, profesyonel ve anlaÅŸÄ±lÄ±r analizler yaparsÄ±n. 50+ optimize edilmiÅŸ premium indikatÃ¶r, kurumsal analiz, whale tracking, smart money concepts ve tÃ¼m stratejik sinyalleri deÄŸerlendirerek kesin AL/SAT/BEKLE kararÄ± verirsin. Gereksiz tekrarlar Ã§Ä±karÄ±ldÄ±, sadece en gÃ¼venilir indikatÃ¶rler kullanÄ±lÄ±yor.` 
                            },
                            { role: 'user', content: prompt }
                        ],
                        temperature: 0.7,
                        max_tokens: 3000
                    })
                });

                const data = await response.json();
                const aiText = data.choices[0].message.content;
                
                // Karar, zaman, gÃ¼ven ve risk seviyesini bul
                const kararMatch = aiText.match(/KARAR:\s*\[(.*?)\]/i) || aiText.match(/ðŸ“Œ\s*KARAR:\s*(.*?)(?:\n|$)/i);
                const zamanMatch = aiText.match(/ZAMAN:\s*\[(.*?)\]/i) || aiText.match(/â°\s*ZAMAN:\s*(.*?)(?:\n|$)/i);
                const guvenMatch = aiText.match(/GÃœVEN:\s*\[(.*?)\]/i) || aiText.match(/ðŸŽ¯\s*GÃœVEN:\s*(.*?)(?:\n|$)/i);
                const riskMatch = aiText.match(/RÄ°SK SEVÄ°YESÄ°:\s*\[(.*?)\]/i) || aiText.match(/âš ï¸\s*RÄ°SK SEVÄ°YESÄ°:\s*(.*?)(?:\n|$)/i);
                
                // Ã–neri belirleme
                let recommendation = 'WAIT';
                if (kararMatch) {
                    const karar = kararMatch[1].toUpperCase();
                    if (karar.includes('AL') || karar.includes('LONG') || karar.includes('BUY')) {
                        recommendation = 'LONG';
                    } else if (karar.includes('SAT') || karar.includes('SHORT') || karar.includes('SELL')) {
                        recommendation = 'SHORT';
                    }
                }
                
                // GÃ¼ven belirleme
                let confidence = 'MEDIUM';
                if (guvenMatch) {
                    const guven = guvenMatch[1].toUpperCase();
                    if (guven.includes('%8') || guven.includes('8') || guven.includes('YÃœKSEK') || guven.includes('HIGH')) {
                        confidence = 'HIGH';
                    } else if (guven.includes('%5') || guven.includes('5') || guven.includes('DÃœÅžÃœK') || guven.includes('LOW')) {
                        confidence = 'LOW';
                    }
                }
                
                // DetaylÄ± analiz metnini formatla
                let formattedAnalysis = aiText;
                if (kararMatch || zamanMatch || guvenMatch || riskMatch) {
                    formattedAnalysis = aiText;
                }
                
                return {
                    analysis: formattedAnalysis,
                    recommendation: recommendation,
                    confidence: confidence,
                    zaman: zamanMatch ? zamanMatch[1] : 'N/A',
                    risk: riskMatch ? riskMatch[1] : 'N/A'
                };
            } catch (error) {
                console.error('âŒ AI hatasÄ±:', error);
                const signal = priceData.change > 2 ? 'LONG' : priceData.change < -2 ? 'SHORT' : 'WAIT';
                return {
                    analysis: `Technical analysis for ${coin} shows ${signal.toLowerCase()} momentum based on 24h performance.`,
                    recommendation: signal,
                    confidence: 'MEDIUM'
                };
            }
        }

        async function sendTelegramNotification(message) {
            try {
                await fetch(`https://api.telegram.org/bot${API_KEYS.TELEGRAM_BOT}/sendMessage`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        chat_id: API_KEYS.TELEGRAM_CHAT,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
                console.log('âœ… Telegram gÃ¶nderildi');
            } catch (error) {
                console.error('âŒ Telegram hatasÄ±:', error);
            }
        }

        // ===== DETAYLI TELEGRAM GÃ–NDERME FONKSÄ°YONU =====
        async function sendDetailedTelegram(coin, priceData, indicators, aiAnalysis) {
            try {
                const coinSymbol = coin.replace('/USDT', '');
                let message = `ðŸ”¥ <b>YasarAI ULTRA SCAN SONUCU</b> ðŸ”¥\n\n`;
                message += `ðŸ“Š <b>${coinSymbol}</b>\n`;
                message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                
                const score = calculateRealScore(coin, priceData);
                const signal = determineRealSignal(coin, priceData, score);
                const signalText = signal === 'long' ? 'ðŸŸ¢ LONG' : signal === 'short' ? 'ðŸ”´ SHORT' : 'âšª WAIT';
                
                message += `ðŸ’¯ <b>SKOR: ${score}/100</b>\n`;
                message += `${signalText}\n\n`;
                message += `ðŸ’° <b>FÄ°YAT:</b> $${formatPrice(priceData.price)}\n`;
                message += `ðŸ“ˆ <b>24h:</b> ${priceData.change >= 0 ? '+' : ''}${priceData.change.toFixed(2)}%\n`;
                message += `ðŸ“Š High: $${formatPrice(priceData.high24h || 0)} | Low: $${formatPrice(priceData.low24h || 0)}\n\n`;

                // === TRADE SEVÄ°YELERÄ° (GÄ°RÄ°Åž, TP1-2-3, STOP LOSS) ===
                message += `ðŸ“‹ <b>TRADE SEVÄ°YELERÄ°:</b>\n`;
                message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                
                const entry = priceData.price;
                const atr = indicators?.atr || (entry * 0.02);
                
                if (signal === 'long') {
                    const tp1 = entry + (atr * 1.0);
                    const tp2 = entry + (atr * 2.0);
                    const tp3 = entry + (atr * 3.0);
                    const sl = entry - (atr * 1.5);
                    
                    message += `ðŸŸ¢ <b>GÄ°RÄ°Åž:</b> $${formatPrice(entry)} (Mevcut Fiyat)\n`;
                    message += `ðŸ“ˆ <b>TP1:</b> $${formatPrice(tp1)} (+${((atr * 1.0 / entry) * 100).toFixed(2)}%) - %50 Pozisyon Kapat\n`;
                    message += `ðŸ“ˆ <b>TP2:</b> $${formatPrice(tp2)} (+${((atr * 2.0 / entry) * 100).toFixed(2)}%) - %30 Pozisyon Kapat\n`;
                    message += `ðŸ“ˆ <b>TP3:</b> $${formatPrice(tp3)} (+${((atr * 3.0 / entry) * 100).toFixed(2)}%) - %20 Pozisyon Kapat\n`;
                    message += `ðŸ”´ <b>STOP LOSS:</b> $${formatPrice(sl)} (-${((atr * 1.5 / entry) * 100).toFixed(2)}%)\n\n`;
                } else if (signal === 'short') {
                    const tp1 = entry - (atr * 1.0);
                    const tp2 = entry - (atr * 2.0);
                    const tp3 = entry - (atr * 3.0);
                    const sl = entry + (atr * 1.5);
                    
                    message += `ðŸ”´ <b>GÄ°RÄ°Åž:</b> $${formatPrice(entry)} (Mevcut Fiyat)\n`;
                    message += `ðŸ“‰ <b>TP1:</b> $${formatPrice(tp1)} (-${((atr * 1.0 / entry) * 100).toFixed(2)}%) - %50 Pozisyon Kapat\n`;
                    message += `ðŸ“‰ <b>TP2:</b> $${formatPrice(tp2)} (-${((atr * 2.0 / entry) * 100).toFixed(2)}%) - %30 Pozisyon Kapat\n`;
                    message += `ðŸ“‰ <b>TP3:</b> $${formatPrice(tp3)} (-${((atr * 3.0 / entry) * 100).toFixed(2)}%) - %20 Pozisyon Kapat\n`;
                    message += `ðŸ”´ <b>STOP LOSS:</b> $${formatPrice(sl)} (+${((atr * 1.5 / entry) * 100).toFixed(2)}%)\n\n`;
                } else {
                    message += `âšª <b>GÄ°RÄ°Åž:</b> $${formatPrice(entry)} (Bekleme Modu)\n`;
                    message += `âš ï¸ Daha iyi giriÅŸ noktalarÄ± iÃ§in bekleyin\n\n`;
                }

                // === FÄ°BONACCÄ° SEVÄ°YELERÄ° ===
                message += `ðŸ“ <b>FÄ°BONACCÄ° SEVÄ°YELERÄ°:</b>\n`;
                message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                
                const fibLevels = calculateFibonacciLevels(coin, priceData.price);
                fibLevels.forEach(fib => {
                    const distance = ((fib.price - entry) / entry * 100);
                    const distanceText = distance >= 0 ? `+${distance.toFixed(2)}%` : `${distance.toFixed(2)}%`;
                    message += `${fib.level}% - $${formatPrice(fib.price)} (${distanceText})\n`;
                });
                message += `\n`;

                // === LÄ°KÄ°DASYON SEVÄ°YELERÄ° ===
                message += `âš ï¸ <b>LÄ°KÄ°DASYON SEVÄ°YELERÄ°:</b>\n`;
                message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                
                const symbol = coin.replace('/USDT', 'USDT');
                const realLiquidation = liquidationData[symbol];
                
                if (realLiquidation && realLiquidation.total > 0) {
                    const total = realLiquidation.total;
                    const longLiq = realLiquidation.longLiquidation || 0;
                    const shortLiq = realLiquidation.shortLiquidation || 0;
                    
                    message += `ðŸ’° <b>Toplam Likidasyon:</b> $${(total / 1000000).toFixed(2)}M\n`;
                    message += `ðŸŸ¢ LONG Liq: $${(longLiq / 1000000).toFixed(2)}M\n`;
                    message += `ðŸ”´ SHORT Liq: $${(shortLiq / 1000000).toFixed(2)}M\n\n`;
                    
                    // Tahmini likidasyon seviyeleri
                    const liquidationLevels = [
                        { price: entry * 0.93, label: '-7%' },
                        { price: entry * 0.96, label: '-4%' },
                        { price: entry * 0.98, label: '-2%' },
                        { price: entry * 1.02, label: '+2%' },
                        { price: entry * 1.04, label: '+4%' },
                        { price: entry * 1.07, label: '+7%' }
                    ];
                    
                    liquidationLevels.forEach(level => {
                        const distance = ((level.price - entry) / entry * 100);
                        message += `${level.label}: $${formatPrice(level.price)}\n`;
                    });
                } else {
                    message += `âš ï¸ Likidasyon verisi ÅŸu an mevcut deÄŸil\n`;
                }
                message += `\n`;

                // === Ä°NDÄ°KATÃ–R Ã–ZETÄ° ===
                if (indicators) {
                    // 90 Ä°ndikatÃ¶r
                    if (indicators.indicators90) {
                        message += `ðŸ“Š <b>90 Ä°NDÄ°KATÃ–R ANALÄ°ZÄ°:</b>\n`;
                        message += `ðŸŸ¢ Bull: ${indicators.indicators90.bull} | ðŸ”´ Bear: ${indicators.indicators90.bear}\n`;
                        message += `ðŸ“ˆ RSI: ${indicators.rsi?.toFixed(1) || 'N/A'}\n`;
                        message += `ðŸ“Š MACD: ${indicators.macd?.toFixed(2) || 'N/A'}\n`;
                        message += `âš¡ ADX: ${indicators.adx?.toFixed(1) || 'N/A'}\n\n`;
                    }

                    // Institutional
                    if (indicators.institutional) {
                        message += `ðŸ¢ <b>KURUMSAL ANALÄ°Z:</b>\n`;
                        message += `â€¢ Dark Pool: ${indicators.institutional.darkPool?.status || 'N/A'}\n`;
                        message += `â€¢ Order Flow Buy: ${indicators.institutional.orderFlow?.buyPressure || 'N/A'}\n`;
                        message += `â€¢ Order Flow Sell: ${indicators.institutional.orderFlow?.sellPressure || 'N/A'}\n`;
                        message += `â€¢ Block Trades: ${indicators.institutional.darkPool?.blocks || 0}\n\n`;
                    }

                    // Whale
                    if (indicators.whales) {
                        message += `ðŸ‹ <b>BALÄ°NA ANALÄ°ZÄ°:</b>\n`;
                        message += `â€¢ Aktivite: ${indicators.whales.activity?.status || 'N/A'}\n`;
                        message += `â€¢ Sentiment: ${indicators.whales.sentiment?.accumulation || 'N/A'}% Birikim | ${indicators.whales.sentiment?.distribution || 'N/A'}% DaÄŸÄ±tÄ±m\n`;
                        message += `â€¢ Net Flow: ${indicators.whales.netFlow || 'N/A'}\n\n`;
                    }

                    // Market Makers
                    if (indicators.marketMakers) {
                        message += `ðŸ¦ <b>PÄ°YASA YAPICI:</b>\n`;
                        message += `â€¢ Wyckoff: ${indicators.marketMakers.wyckoff?.phase || 'N/A'}\n`;
                        message += `â€¢ CVD Trend: ${indicators.marketMakers.cvd?.trend || 'N/A'}\n`;
                        message += `â€¢ VSA: ${indicators.marketMakers.vsa || 'N/A'}\n\n`;
                    }

                    // Traders
                    if (indicators.traders) {
                        message += `ðŸ‘¥ <b>TRADER ANALÄ°ZÄ°:</b>\n`;
                        message += `â€¢ Retail: ${indicators.traders.retailRatio || '0'}% | Kurumsal: ${indicators.traders.ratio || '0'}%\n`;
                        message += `â€¢ Sentiment: ${indicators.traders.sentiment || 'N/A'}\n`;
                        message += `â€¢ Smart Money: ${indicators.traders.smartMoney || 'N/A'}\n\n`;
                    }

                    // Smart Money
                    if (indicators.smartMoneyConcepts) {
                        message += `ðŸ’Ž <b>SMART MONEY:</b>\n`;
                        message += `â€¢ BOS: ${indicators.smartMoneyConcepts.bos || 'N/A'}\n`;
                        message += `â€¢ CHoCH: ${indicators.smartMoneyConcepts.choch || 'N/A'}\n`;
                        message += `â€¢ Zone: ${indicators.smartMoneyConcepts.zone || 'N/A'}\n`;
                        message += `â€¢ Position: ${indicators.smartMoneyConcepts.position || 'N/A'}%\n\n`;
                    }
                }

                // === AI ANALÄ°Z (eÄŸer varsa) ===
                if (aiAnalysis && aiAnalysis.length > 0) {
                    message += `ðŸ¤– <b>GROQ AI ANALÄ°ZÄ°:</b>\n`;
                    message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                    const aiText = typeof aiAnalysis === 'string' ? aiAnalysis : JSON.stringify(aiAnalysis);
                    message += `${aiText.substring(0, 1500)}${aiText.length > 1500 ? '...' : ''}\n\n`;
                }

                message += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
                message += `âš¡ <b>YasarAI ULTIMATE V8 MEGA</b>\n`;
                message += `ðŸ“Š 50+ PREMÄ°UM Ä°NDÄ°KATÃ–R â€¢ ðŸ¢ 7 BORSA â€¢ ðŸ¤– GROQ AI\n`;
                message += `â° ${selectedTimeframe} â€¢ ðŸ“… ${new Date().toLocaleString('tr-TR')}`;

                await sendTelegramNotification(message);
                alert('âœ… Telegram\'a baÅŸarÄ±yla gÃ¶nderildi!');
            } catch (error) {
                console.error('âŒ Telegram hatasÄ±:', error);
                alert('âŒ Telegram gÃ¶nderme hatasÄ±: ' + error.message);
            }
        }

        async function startScan() {
            const button = document.getElementById('scanButton');
            button.disabled = true;
            button.textContent = 'â³ Tarama BaÅŸlatÄ±lÄ±yor...';
            
            const loadingSection = document.getElementById('loadingSection');
            if (loadingSection) {
                loadingSection.style.display = 'block';
                const progressBar = loadingSection.querySelector('.progress-bar');
                if (progressBar) {
                    progressBar.style.width = '0%';
                    progressBar.textContent = '0%';
                }
            }
            
            // TÃ¼m result container'larÄ± temizle
            const longContainer = document.getElementById('longResultsContainer');
            const shortContainer = document.getElementById('shortResultsContainer');
            const waitContainer = document.getElementById('waitResultsContainer');
            if (longContainer) longContainer.innerHTML = '';
            if (shortContainer) shortContainer.innerHTML = '';
            if (waitContainer) waitContainer.innerHTML = '';
            
            switchTab('results');
            const navTabs = document.querySelectorAll('.nav-tab');
            if (navTabs[4]) navTabs[4].classList.add('active');

            try {
                // 1. FiyatlarÄ± gÃ¼ncelle (hÄ±zlÄ±)
                button.textContent = 'â³ Fiyatlar gÃ¼ncelleniyor...';
                await fetchRealPrices();
                console.log(`âœ… ${Object.keys(realPrices).length} coin fiyatÄ± gÃ¼ncellendi`);
                
                // 2. Teknik analizleri kontrol et ve gerekirse hesapla (paralel)
                button.textContent = 'â³ Teknik analizler hesaplanÄ±yor...';
                const startTime = Date.now();
                
                // Teknik analizler varsa kullan, yoksa hÄ±zlÄ±ca hesapla (sadece Ã¶nemli coinler iÃ§in)
                if (Object.keys(technicalIndicators).length < 10) {
                    console.log('âš¡ Teknik analizler eksik veya eski, hÄ±zlÄ± hesaplama baÅŸlatÄ±lÄ±yor...');
                    // Paralel hesaplama baÅŸlat (await etmeden devam et)
                    calculateTechnicalIndicators().then(() => {
                        console.log(`âœ… Teknik analizler hesaplandÄ± (${((Date.now() - startTime) / 1000).toFixed(1)}s)`);
                    }).catch(e => console.error('Teknik analiz hatasÄ±:', e));
                }
                
                // 3. SonuÃ§larÄ± oluÅŸtur (paralel ve optimize)
                button.textContent = 'â³ SonuÃ§lar oluÅŸturuluyor...';
                await generateResults();
                
                const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                console.log(`âš¡ Tarama tamamlandÄ±: ${elapsed}s`);
                button.textContent = `âœ… Tarama TamamlandÄ± (${elapsed}s) ðŸš€`;
                
            } catch (error) {
                console.error('âŒ Tarama hatasÄ±:', error);
                button.textContent = 'âŒ Hata - Tekrar Dene';
                alert('Tarama hatasÄ±: ' + error.message);
            } finally {
                if (loadingSection) {
                    loadingSection.style.display = 'none';
                }
                button.disabled = false;
                setTimeout(() => {
                    button.textContent = 'ðŸ” GERÃ‡EK ZAMANLI AI TARAMA BAÅžLAT ðŸš€';
                }, 2000);
                
                // Telegram bildirimi (opsiyonel - hata olursa devam et)
                try {
                    const bullish = document.getElementById('bullishSignals')?.textContent || '0';
                    const bearish = document.getElementById('bearishSignals')?.textContent || '0';
                    await sendTelegramNotification(`ðŸš€ <b>YasarAI Scanner V8</b>\nTarama tamamlandÄ±!\n\nðŸŸ¢ LONG: ${bullish}\nðŸ”´ SHORT: ${bearish}`);
                } catch (e) {
                    console.log('Telegram bildirimi atlandÄ±:', e);
                }
            }
        }

        // ===== GERÃ‡EK SKOR HESAPLAMA (Teknik Analiz TabanlÄ±) =====
        function calculateRealScore(coin, priceData) {
            let score = 50; // BaÅŸlangÄ±Ã§ skoru
            const indicators = technicalIndicators[coin];
            
            if (!indicators) {
                // Teknik analiz yoksa basit skor
                return priceData.change > 2 ? 65 : priceData.change < -2 ? 35 : 50;
            }
            
            // RSI analizi (0-30 oversold, 70-100 overbought)
            if (indicators.rsi < 30) {
                score += 15; // Oversold, yÃ¼kseliÅŸ potansiyeli
            } else if (indicators.rsi > 70) {
                score -= 15; // Overbought, dÃ¼ÅŸÃ¼ÅŸ potansiyeli
            }
            
            // MACD analizi
            if (indicators.macd > indicators.macdSignal && indicators.macdHistogram > 0) {
                score += 10; // Bullish MACD
            } else if (indicators.macd < indicators.macdSignal && indicators.macdHistogram < 0) {
                score -= 10; // Bearish MACD
            }
            
            // EMA trend analizi
            if (indicators.trend === 'UP' && indicators.ema9 > indicators.ema50) {
                score += 12; // GÃ¼Ã§lÃ¼ uptrend
            } else if (indicators.trend === 'DOWN' && indicators.ema9 < indicators.ema50) {
                score -= 12; // GÃ¼Ã§lÃ¼ downtrend
            }
            
            // Volume analizi
            if (indicators.volumeRatio > 1.5) {
                score += 8; // YÃ¼ksek volume, gÃ¼Ã§lÃ¼ hareket
            } else if (indicators.volumeRatio < 0.5) {
                score -= 5; // DÃ¼ÅŸÃ¼k volume, zayÄ±f hareket
            }
            
            // Bollinger Bands pozisyonu
            if (priceData.price < indicators.bbLower) {
                score += 10; // Alt bandÄ±n altÄ±nda, oversold
            } else if (priceData.price > indicators.bbUpper) {
                score -= 10; // Ãœst bandÄ±n Ã¼stÃ¼nde, overbought
            }
            
            // Stochastic analizi
            if (indicators.stochastic && indicators.stochasticD) {
                if (indicators.stochastic < 20 && indicators.stochastic > indicators.stochasticD) {
                    score += 8; // Oversold ve bullish cross
                } else if (indicators.stochastic > 80 && indicators.stochastic < indicators.stochasticD) {
                    score -= 8; // Overbought ve bearish cross
                }
            }
            
            // ADX analizi (trend gÃ¼cÃ¼)
            if (indicators.adx) {
                if (indicators.adx > 25 && indicators.trend === 'UP') {
                    score += 6; // GÃ¼Ã§lÃ¼ uptrend
                } else if (indicators.adx > 25 && indicators.trend === 'DOWN') {
                    score -= 6; // GÃ¼Ã§lÃ¼ downtrend
                } else if (indicators.adx < 20) {
                    score -= 3; // ZayÄ±f trend
                }
            }
            
            // CVD analizi
            if (indicators.cvdTrend === 'BULLISH') {
                score += 7;
            } else if (indicators.cvdTrend === 'BEARISH') {
                score -= 7;
            }
            
            // VWAP analizi
            if (indicators.vwap) {
                if (priceData.price > indicators.vwap) {
                    score += 5; // Fiyat VWAP Ã¼stÃ¼nde
                } else {
                    score -= 5; // Fiyat VWAP altÄ±nda
                }
            }
            
            // Order Blocks analizi
            if (indicators.orderBlocks && indicators.orderBlocks > 2) {
                score += 3; // Aktif order blocks var
            }
            
            // 90 Ä°ndikatÃ¶r analizi etkisi - Balanced scoring
            if (indicators.indicators90) {
                const bullCount = indicators.indicators90.bull || 0;
                const bearCount = indicators.indicators90.bear || 0;
                const neutralCount = indicators.indicators90.neutral || 0;
                const total = bullCount + bearCount + neutralCount;
                
                if (total > 0) {
                    // Balanced scoring - bear sinyallerini daha fazla deÄŸerlendir
                    const bullPercent = (bullCount / total) * 100;
                    const bearPercent = (bearCount / total) * 100;
                    
                    // EÄŸer bear sinyali fazlaysa, short sinyali verecek ÅŸekilde skorla
                    if (bearPercent > bullPercent + 10) {
                        score = -Math.abs(bearPercent - 50); // Negative score for short
                    } else if (bullPercent > bearPercent + 10) {
                        score = Math.abs(bullPercent - 50); // Positive score for long
                    } else {
                        score = indicators.indicators90.score || 0; // Neutral
                    }
                } else {
                    score = indicators.indicators90.score || 0;
                }
            }
            
            // Institutional analiz etkisi
            if (indicators.institutional) {
                if (indicators.institutional.darkPool === 'VERY HIGH') score += 8;
                else if (indicators.institutional.darkPool === 'HIGH') score += 5;
                else if (indicators.institutional.darkPool === 'MEDIUM') score += 2;
                
                if (indicators.institutional.orderFlow === 'STRONG BUY') score += 8;
                else if (indicators.institutional.orderFlow === 'BUY') score += 5;
                else if (indicators.institutional.orderFlow === 'SELL') score -= 5;
                else if (indicators.institutional.orderFlow === 'STRONG SELL') score -= 8;
            }
            
            // Whale analiz etkisi
            if (indicators.whales) {
                if (indicators.whales.status === 'VERY ACTIVE') score += 7;
                else if (indicators.whales.status === 'ACTIVE') score += 4;
                
                if (indicators.whales.sentiment === 'STRONG BULLISH') score += 6;
                else if (indicators.whales.sentiment === 'STRONG BEARISH') score -= 6;
            }
            
            // Market Makers (Wyckoff) etkisi
            if (indicators.marketMakers) {
                if (indicators.marketMakers.wyckoff.phase === 'ACCUMULATION') score += 8;
                else if (indicators.marketMakers.wyckoff.phase.includes('ACCUMULATION')) score += 5;
                else if (indicators.marketMakers.wyckoff.phase === 'DISTRIBUTION') score -= 8;
                else if (indicators.marketMakers.wyckoff.phase.includes('DISTRIBUTION')) score -= 5;
                
                if (indicators.marketMakers.vsa === 'STRONG BULLISH') score += 5;
                else if (indicators.marketMakers.vsa === 'STRONG ABSORPTION') score += 4;
                
                if (indicators.marketMakers.cvd.trend === 'STRONG BULLISH') score += 4;
                else if (indicators.marketMakers.cvd.trend === 'STRONG BEARISH') score -= 4;
            }
            
            // Smart Money Concepts etkisi
            if (indicators.smartMoneyConcepts) {
                if (indicators.smartMoneyConcepts.bos.includes('STRONG BULLISH')) score += 5;
                else if (indicators.smartMoneyConcepts.bos.includes('BULLISH')) score += 3;
                else if (indicators.smartMoneyConcepts.bos.includes('STRONG BEARISH')) score -= 5;
                else if (indicators.smartMoneyConcepts.bos.includes('BEARISH')) score -= 3;
                
                if (indicators.smartMoneyConcepts.zone === 'DISCOUNT') score += 5;
                else if (indicators.smartMoneyConcepts.zone === 'PREMIUM') score -= 3;
            }
            
            // Pump & Dump etkisi
            if (indicators.pumpDump) {
                if (indicators.pumpDump.strength > 90) score += 10;
                else if (indicators.pumpDump.strength > 70) score += 5;
                else if (indicators.pumpDump.strength < 10) score -= 10;
            }
            
            // Trend Break etkisi
            if (indicators.trendBreak) {
                if (indicators.trendBreak.signal.includes('BULLISH BREAKOUT')) score += 8;
                else if (indicators.trendBreak.signal.includes('BULLISH BREAK')) score += 5;
                else if (indicators.trendBreak.signal.includes('BEARISH BREAKDOWN')) score -= 8;
                else if (indicators.trendBreak.signal.includes('BEARISH BREAK')) score -= 5;
            }
            
            // Peaks & Dips etkisi
            if (indicators.peaksAndDips) {
                if (indicators.peaksAndDips.confidence > 80) {
                    if (indicators.peaksAndDips.signal.includes('BUY')) score += 6;
                    else if (indicators.peaksAndDips.signal.includes('SELL') || indicators.peaksAndDips.signal.includes('PEAK')) score -= 6;
                }
            }
            
            // Trader analiz etkisi
            if (indicators.traders) {
                if (indicators.traders.dominance === 'INSTITUTIONAL' && indicators.traders.sentiment === 'STRONG BULLISH') score += 4;
                else if (indicators.traders.dominance === 'RETAIL' && indicators.traders.sentiment === 'STRONG BEARISH') score -= 4;
            }
            
            // 24h deÄŸiÅŸim etkisi
            if (priceData.change > 5) {
                score += 5;
            } else if (priceData.change < -5) {
                score -= 5;
            }
            
            // Skor sÄ±nÄ±rlamasÄ±
            score = Math.max(0, Math.min(100, score));
            
            return Math.round(score);
        }
        
        // ===== GERÃ‡EK SÄ°NYAL BELÄ°RLEME =====
        function determineRealSignal(coin, priceData, score) {
            const indicators = technicalIndicators[coin];
            
            if (!indicators) {
                // Balanced threshold - short sinyaller iÃ§in daha dÃ¼ÅŸÃ¼k eÅŸik
                if (score > 65) return 'long';
                else if (score < 35) return 'short';
                else return 'wait';
            }
            
            let bullishSignals = 0;
            let bearishSignals = 0;
            
            // Ä°ndikatÃ¶r skorlarÄ±ndan sinyal sayÄ±sÄ±
            if (indicators.indicators90) {
                const bullCount = indicators.indicators90.bull || 0;
                const bearCount = indicators.indicators90.bear || 0;
                
                bullishSignals += bullCount;
                bearishSignals += bearCount;
                
                // Bear sinyalleri daha fazlaysa short ver
                if (bearCount > bullCount + 5) {
                    return 'short';
                } else if (bullCount > bearCount + 5) {
                    return 'long';
                }
            }
            
            // RSI sinyalleri
            if (indicators.rsi < 30) bullishSignals += 2;
            else if (indicators.rsi > 70) bearishSignals += 2;
            else if (indicators.rsi < 50 && indicators.rsi > 30) bullishSignals += 1;
            else if (indicators.rsi > 50 && indicators.rsi < 70) bearishSignals += 1;
            
            // MACD sinyalleri
            if (indicators.macd > indicators.macdSignal && indicators.macdHistogram > 0) bullishSignals += 2;
            else if (indicators.macd < indicators.macdSignal && indicators.macdHistogram < 0) bearishSignals += 2;
            
            // Trend sinyalleri
            if (indicators.trend === 'UP' && indicators.ema9 > indicators.ema21) bullishSignals += 2;
            else if (indicators.trend === 'DOWN' && indicators.ema9 < indicators.ema21) bearishSignals += 2;
            
            // Volume sinyalleri
            if (indicators.volumeRatio > 1.5) {
                if (priceData.change > 0) bullishSignals += 1;
                else bearishSignals += 1;
            }
            
            // Skor bazlÄ± - Balanced (short iÃ§in daha dÃ¼ÅŸÃ¼k eÅŸik)
            if (score >= 65) bullishSignals += 2;
            else if (score <= 35) bearishSignals += 3; // Short iÃ§in daha gÃ¼Ã§lÃ¼ aÄŸÄ±rlÄ±k
            else if (score < 50) bearishSignals += 1; // Orta-az skor = bearish eÄŸilim
            
            // Darvas Box, Squeeze, Market Profile gibi Ã¶zel indikatÃ¶rler
            if (indicators.indicators90) {
                // Darvas Box breakdown
                const dbIndex = indicators.indicators90.indicatorDetails?.short?.findIndex(s => s.includes('Darvas'));
                if (dbIndex !== undefined && dbIndex >= 0) bearishSignals += 2;
                
                // Squeeze negative momentum
                const sqIndex = indicators.indicators90.indicatorDetails?.short?.findIndex(s => s.includes('Squeeze'));
                if (sqIndex !== undefined && sqIndex >= 0) bearishSignals += 1;
                
                // Market Profile below value area
                const mpIndex = indicators.indicators90.indicatorDetails?.short?.findIndex(s => s.includes('Market Profile'));
                if (mpIndex !== undefined && mpIndex >= 0) bearishSignals += 2;
            }
            
            // Balanced decision - bear sinyallerini daha fazla deÄŸerlendir
            if (bullishSignals > bearishSignals + 3) return 'long';
            if (bearishSignals > bullishSignals + 2) return 'short'; // Bear iÃ§in daha dÃ¼ÅŸÃ¼k eÅŸik
            if (bearishSignals > bullishSignals) return 'short'; // EÅŸitlik durumunda bear'a ver
            return 'wait';
        }
        
        async function generateResults() {
            const coins = Object.keys(realPrices);
            
            // LONG ve SHORT iÃ§in ayrÄ± container'lar
            const longContainer = document.getElementById('longResultsContainer');
            const shortContainer = document.getElementById('shortResultsContainer');
            const waitContainer = document.getElementById('waitResultsContainer');
            
            // Container'larÄ± temizle
            if (longContainer) longContainer.innerHTML = '';
            if (shortContainer) shortContainer.innerHTML = '';
            if (waitContainer) waitContainer.innerHTML = '';
            
            // Ã–nce teknik analizlerin hesaplanmasÄ±nÄ± bekle (eÄŸer yoksa hÄ±zlÄ±ca hesapla)
            if (Object.keys(technicalIndicators).length === 0) {
                console.log('âš¡ Teknik analizler eksik, hÄ±zlÄ± hesaplama yapÄ±lÄ±yor...');
                await calculateTechnicalIndicators();
            }
            
            let bullish = 0, bearish = 0, neutral = 0;
            
            // Filtreleme - sadece skoru yÃ¼ksek olanlarÄ± iÅŸle (performans iÃ§in)
            const filteredCoins = coins.filter(coin => {
                const priceData = realPrices[coin];
                if (!priceData) return false;
                const score = calculateRealScore(coin, priceData);
                return score >= minScore || score > 50; // Minimum skor veya 50'den yÃ¼ksek
            });
            
            console.log(`ðŸ“Š ${filteredCoins.length}/${coins.length} coin filtrelendi (min skor: ${minScore})`);
            
            // LONG ve SHORT sonuÃ§larÄ± iÃ§in ayrÄ± listeler
            const longResults = [];
            const shortResults = [];
            const waitResults = [];
            
            // PARALEL Ä°ÅžLEME - 20'ÅŸer 20'ÅŸer batch (Ã‡OK DAHA HIZLI!)
            const batchSize = 20;
            
            for (let i = 0; i < filteredCoins.length; i += batchSize) {
                const batch = filteredCoins.slice(i, i + batchSize);
                
                // Batch iÃ§inde paralel iÅŸle
                const batchPromises = batch.map(coin => {
                    return new Promise((resolve) => {
                        try {
                            const priceData = realPrices[coin];
                            if (!priceData) {
                                resolve(null);
                                return;
                            }
                            
                            const score = calculateRealScore(coin, priceData);
                            const signal = determineRealSignal(coin, priceData, score);
                            
                            // Sinyal sayÄ±sÄ±nÄ± hesapla (async dÄ±ÅŸÄ±nda)
                            let signalType = 'neutral';
                            if (signal === 'long') signalType = 'long';
                            else if (signal === 'short') signalType = 'short';
                            else signalType = 'neutral';
                            
                            if (score >= minScore || signal !== 'wait') {
                                const card = createCompleteResultCard(coin, priceData, score, signal);
                                resolve({ card, score, signal: signalType, coin });
                            } else {
                                resolve(null);
                            }
                        } catch (e) {
                            console.error(`Coin iÅŸleme hatasÄ± ${coin}:`, e);
                            resolve(null);
                        }
                    });
                });
                
                const batchResults = await Promise.all(batchPromises);
                
                // SonuÃ§larÄ± skora gÃ¶re sÄ±ralayÄ±p kategorilere ayÄ±r
                const validCards = batchResults.filter(r => r !== null);
                validCards.sort((a, b) => b.score - a.score);
                
                // LONG ve SHORT'a ayÄ±r
                validCards.forEach(result => {
                    if (result.signal === 'long') {
                        bullish++;
                        longResults.push(result);
                    } else if (result.signal === 'short') {
                        bearish++;
                        shortResults.push(result);
                    } else {
                        neutral++;
                        waitResults.push(result);
                    }
                });
                
                // Progress gÃ¶ster
                const progress = Math.min(100, ((i + batch.length) / filteredCoins.length) * 100);
                const loadingEl = document.getElementById('loadingSection');
                if (loadingEl) {
                    const progressEl = loadingEl.querySelector('.progress-bar');
                    if (progressEl) {
                        progressEl.style.width = progress + '%';
                        progressEl.textContent = Math.round(progress) + '%';
                    }
                }
                
                // KÄ±sa bir bekleme - UI'nin gÃ¼ncellenmesi iÃ§in
                await new Promise(resolve => setTimeout(resolve, 50));
            }

            // LONG sonuÃ§larÄ±nÄ± ekle (skora gÃ¶re sÄ±ralÄ±)
            longResults.sort((a, b) => b.score - a.score);
            longResults.forEach(result => {
                if (longContainer) longContainer.appendChild(result.card);
            });

            // SHORT sonuÃ§larÄ±nÄ± ekle (skora gÃ¶re sÄ±ralÄ±)
            shortResults.sort((a, b) => b.score - a.score);
            shortResults.forEach(result => {
                if (shortContainer) shortContainer.appendChild(result.card);
            });

            // WAIT sonuÃ§larÄ±nÄ± ekle (varsa)
            if (waitResults.length > 0 && waitContainer) {
                document.getElementById('waitSection').style.display = 'block';
                waitResults.sort((a, b) => b.score - a.score);
                waitResults.forEach(result => {
                    waitContainer.appendChild(result.card);
                });
                document.getElementById('waitCount').textContent = `${waitResults.length} Coin`;
            }

            // Ä°statistikleri gÃ¼ncelle
            document.getElementById('totalCoins').textContent = coins.length;
            document.getElementById('bullishSignals').textContent = bullish;
            document.getElementById('bearishSignals').textContent = bearish;
            document.getElementById('neutralSignals').textContent = neutral;
            
            // LONG ve SHORT sayÄ±larÄ±nÄ± gÃ¶ster
            if (document.getElementById('longCount')) {
                document.getElementById('longCount').textContent = `${bullish} Coin`;
            }
            if (document.getElementById('shortCount')) {
                document.getElementById('shortCount').textContent = `${bearish} Coin`;
            }
            
            console.log(`âœ… Tarama tamamlandÄ±: ${bullish} LONG, ${bearish} SHORT, ${neutral} WAIT`);
        }

        function createCompleteResultCard(coin, priceData, score, signal) {
            const card = document.createElement('div');
            card.className = 'result-card';
            
            const signalClass = signal === 'long' ? 'signal-long' : signal === 'short' ? 'signal-short' : 'signal-neutral';
            const signalText = signal === 'long' ? 'ðŸŸ¢ LONG' : signal === 'short' ? 'ðŸ”´ SHORT' : 'âšª WAIT';
            
            const entry = priceData.price;
            
            // GerÃ§ek teknik analiz verilerinden sinyalleri oluÅŸtur
            const indicators = technicalIndicators[coin] || {};
            
            // ATR'yi gerÃ§ek hesaplamadan al
            let atr = entry * 0.02; // VarsayÄ±lan %2
            if (indicators.atr) {
                if (Array.isArray(indicators.atr) && indicators.atr.length > 0) {
                    atr = indicators.atr[indicators.atr.length - 1];
                } else if (typeof indicators.atr === 'number') {
                    atr = indicators.atr;
                }
            }
            
            // ATR Ã§ok kÃ¼Ã§Ã¼k veya Ã§ok bÃ¼yÃ¼kse mantÄ±klÄ± bir deÄŸere ayarla
            if (atr < entry * 0.005) atr = entry * 0.01; // Minimum %1
            if (atr > entry * 0.1) atr = entry * 0.05;   // Maximum %5
            
            // Trade seviyelerini gerÃ§ek ATR ile hesapla
            const sl = signal === 'long' ? entry - (1.5*atr) : entry + (1.5*atr);
            const tp1 = signal === 'long' ? entry + (atr * 1.0) : entry - (atr * 1.0);
            const tp2 = signal === 'long' ? entry + (atr * 2.0) : entry - (atr * 2.0);
            const tp3 = signal === 'long' ? entry + (atr * 3.0) : entry - (atr * 3.0);
            const buyIndicators = [];
            const sellIndicators = [];
            const neutralIndicators = [];
            
            if (indicators.rsi) {
                if (indicators.rsi < 30) {
                    buyIndicators.push(`RSI ${indicators.rsi.toFixed(1)} (Oversold)`);
                } else if (indicators.rsi > 70) {
                    sellIndicators.push(`RSI ${indicators.rsi.toFixed(1)} (Overbought)`);
                } else {
                    neutralIndicators.push(`RSI ${indicators.rsi.toFixed(1)} (Neutral)`);
                }
            }
            
            if (indicators.macd !== undefined && indicators.macdSignal !== undefined) {
                if (indicators.macd > indicators.macdSignal && indicators.macdHistogram > 0) {
                    buyIndicators.push(`MACD > Signal (Bullish)`);
                } else if (indicators.macd < indicators.macdSignal && indicators.macdHistogram < 0) {
                    sellIndicators.push(`MACD < Signal (Bearish)`);
                } else {
                    neutralIndicators.push(`MACD Neutral`);
                }
            }
            
            if (indicators.trend) {
                if (indicators.trend === 'UP' && indicators.ema9 > indicators.ema21) {
                    buyIndicators.push(`EMA Trend UP (9>21)`);
                } else if (indicators.trend === 'DOWN' && indicators.ema9 < indicators.ema21) {
                    sellIndicators.push(`EMA Trend DOWN (9<21)`);
                }
            }
            
            if (indicators.volumeRatio) {
                if (indicators.volumeRatio > 1.5) {
                    buyIndicators.push(`Volume ${indicators.volumeRatio.toFixed(1)}x (High)`);
                } else if (indicators.volumeRatio < 0.5) {
                    neutralIndicators.push(`Volume ${indicators.volumeRatio.toFixed(1)}x (Low)`);
                }
            }
            
            if (indicators.bbUpper && indicators.bbLower) {
                if (priceData.price < indicators.bbLower) {
                    buyIndicators.push(`Price < BB Lower (Oversold)`);
                } else if (priceData.price > indicators.bbUpper) {
                    sellIndicators.push(`Price > BB Upper (Overbought)`);
                } else {
                    neutralIndicators.push(`Price in BB Range`);
                }
            }
            
            // VarsayÄ±lan deÄŸerler (eÄŸer teknik analiz yoksa)
            if (buyIndicators.length === 0 && sellIndicators.length === 0 && neutralIndicators.length === 0) {
                buyIndicators.push('EMA 9/21 Cross â†‘', 'Volume Spike');
                sellIndicators.push('RSI > 70 Overbought');
                neutralIndicators.push('Waiting for signals');
            }
            
            // Card'a tÄ±klama eventi ekle
            card.addEventListener('click', () => {
                showCoinDetailModal(coin, priceData, score, signal, indicators);
            });
            
            card.innerHTML = `
                <div class="coin-header">
                    <div class="coin-name">${coin}</div>
                    <div style="text-align: right;">
                        <div class="coin-price">$${priceData.price.toLocaleString('en-US', {minimumFractionDigits: 2})}</div>
                        <div class="price-change ${priceData.change >= 0 ? 'price-up' : 'price-down'}">
                            ${priceData.change >= 0 ? 'â–²' : 'â–¼'} ${Math.abs(priceData.change).toFixed(2)}%
                        </div>
                        <div style="font-size: 0.75em; color: #aaa; margin-top: 5px;">ðŸ‘† Detaylar iÃ§in tÄ±klayÄ±n</div>
                    </div>
                </div>

                <div class="master-signal ${signalClass}">
                    <div class="signal-title">${signalText}</div>
                    <div style="font-size: 1.3em; margin-top: 10px;">Master Score: ${score}/100</div>
                    <div style="font-size: 0.9em; opacity: 0.8; margin-top: 5px;">ðŸ’¡ AI analizi iÃ§in butona tÄ±klayÄ±n</div>
                </div>

                <div class="trade-setup">
                    <div class="setup-title">ðŸ“‹ Trade Setup</div>
                    <div class="setup-grid">
                        <div class="setup-item"><div class="setup-label">Entry</div><div class="setup-value value-neutral">$${formatPrice(entry)}</div></div>
                        <div class="setup-item"><div class="setup-label">Stop Loss</div><div class="setup-value value-short">$${formatPrice(sl)}</div></div>
                        <div class="setup-item"><div class="setup-label">TP1</div><div class="setup-value value-long">$${formatPrice(tp1)}</div></div>
                        <div class="setup-item"><div class="setup-label">TP2</div><div class="setup-value value-long">$${formatPrice(tp2)}</div></div>
                        <div class="setup-item"><div class="setup-label">TP3</div><div class="setup-value value-long">$${formatPrice(tp3)}</div></div>
                        <div class="setup-item"><div class="setup-label">R:R Ratio</div><div class="setup-value value-neutral">1:2.5</div></div>
                    </div>
                </div>

                <div class="trade-setup">
                    <div class="setup-title">ðŸ“ˆ CVD & Smart Money</div>
                    <div class="setup-grid">
                        <div class="setup-item">
                            <div class="setup-label">CVD Trend</div>
                            <div class="setup-value ${indicators.cvdTrend === 'BULLISH' ? 'value-long' : indicators.cvdTrend === 'BEARISH' ? 'value-short' : 'value-neutral'}">
                                ${indicators.cvdTrend === 'BULLISH' ? 'ðŸ“ˆ Bullish' : indicators.cvdTrend === 'BEARISH' ? 'ðŸ“‰ Bearish' : 'âž¡ï¸ Neutral'}
                            </div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">CVD Value</div>
                            <div class="setup-value value-neutral">${indicators.cvd ? indicators.cvd.toFixed(0) : 'N/A'}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">Order Blocks</div>
                            <div class="setup-value value-neutral">${indicators.orderBlocks || 0}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">Fair Value Gaps</div>
                            <div class="setup-value value-neutral">${indicators.fvg || 0}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">VWAP</div>
                            <div class="setup-value value-neutral">$${indicators.vwap ? formatPrice(indicators.vwap) : 'N/A'}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">ATR</div>
                            <div class="setup-value value-neutral">${indicators.atr ? indicators.atr.toFixed(2) : 'N/A'}</div>
                        </div>
                    </div>
                </div>

                <div class="trade-setup">
                    <div class="setup-title">ðŸ“Š GeliÅŸmiÅŸ Ä°ndikatÃ¶rler</div>
                    <div class="setup-grid">
                        <div class="setup-item">
                            <div class="setup-label">Stochastic %K</div>
                            <div class="setup-value ${indicators.stochastic > 80 ? 'value-short' : indicators.stochastic < 20 ? 'value-long' : 'value-neutral'}">
                                ${indicators.stochastic ? indicators.stochastic.toFixed(2) : 'N/A'}
                            </div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">Stochastic %D</div>
                            <div class="setup-value value-neutral">${indicators.stochasticD ? indicators.stochasticD.toFixed(2) : 'N/A'}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">ADX</div>
                            <div class="setup-value ${indicators.adx > 25 ? 'value-long' : 'value-neutral'}">
                                ${indicators.adx ? indicators.adx.toFixed(2) : 'N/A'} ${indicators.adx > 25 ? '(Strong)' : indicators.adx > 20 ? '(Moderate)' : '(Weak)'}
                            </div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">EMA 9</div>
                            <div class="setup-value value-neutral">$${indicators.ema9 ? formatPrice(indicators.ema9) : 'N/A'}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">EMA 21</div>
                            <div class="setup-value value-neutral">$${indicators.ema21 ? formatPrice(indicators.ema21) : 'N/A'}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">EMA 50</div>
                            <div class="setup-value value-neutral">$${indicators.ema50 ? formatPrice(indicators.ema50) : 'N/A'}</div>
                        </div>
                    </div>
                </div>

                <div class="indicator-signals">
                    <div class="setup-title">ðŸ“Š Ä°ndikatÃ¶r Sinyalleri</div>
                    <div class="signals-grid">
                        <div class="signal-column signal-buy">
                            <h4>ðŸŸ¢ AL (${buyIndicators.length})</h4>
                            <ul class="signal-list">
                                ${buyIndicators.map(ind => `<li>âœ… ${ind}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="signal-column signal-sell">
                            <h4>ðŸ”´ SAT (${sellIndicators.length})</h4>
                            <ul class="signal-list">
                                ${sellIndicators.map(ind => `<li>âŒ ${ind}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="signal-column signal-wait">
                            <h4>âšª KararsÄ±z (${neutralIndicators.length})</h4>
                            <ul class="signal-list">
                                ${neutralIndicators.map(ind => `<li>âšª ${ind}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                </div>

                ${generateLiquidationHTML(coin, priceData.price)}

                ${indicators.institutional ? `
                <div class="trade-setup" style="margin-top: 20px; background: linear-gradient(135deg, rgba(78, 205, 196, 0.1), rgba(44, 160, 141, 0.1)); border: 2px solid rgba(78, 205, 196, 0.5);">
                    <div class="setup-title" style="font-size: 1.4em; color: #4ecdc4; margin-bottom: 20px;">
                        ðŸ¢ KURUMSAL ANALÄ°Z - DetaylÄ± Ä°nstitutional Flow
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="color: #4ecdc4; font-weight: bold;">ðŸŒŠ Dark Pool Aktivitesi</span>
                            <span style="color: ${indicators.institutional.darkPool === 'VERY HIGH' ? '#4ecdc4' : indicators.institutional.darkPool === 'HIGH' ? '#ffd700' : indicators.institutional.darkPool === 'MEDIUM' ? '#ff9500' : '#aaa'}; font-weight: bold; font-size: 1.1em;">
                                ${indicators.institutional.darkPool || 'N/A'}
                            </span>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); border-radius: 10px; overflow: hidden; height: 12px;">
                            <div style="height: 100%; background: linear-gradient(90deg, ${indicators.institutional.darkPool === 'VERY HIGH' ? '#4ecdc4' : indicators.institutional.darkPool === 'HIGH' ? '#ffd700' : indicators.institutional.darkPool === 'MEDIUM' ? '#ff9500' : '#666'}, ${indicators.institutional.darkPool === 'VERY HIGH' ? '#2a9d8f' : indicators.institutional.darkPool === 'HIGH' ? '#ffaa00' : indicators.institutional.darkPool === 'MEDIUM' ? '#cc7700' : '#444'}); width: ${indicators.institutional.darkPool === 'VERY HIGH' ? '90' : indicators.institutional.darkPool === 'HIGH' ? '70' : indicators.institutional.darkPool === 'MEDIUM' ? '50' : '20'}%; transition: width 0.5s;"></div>
                        </div>
                        <div style="font-size: 0.75em; color: #aaa; margin-top: 5px;">Block Trade SayÄ±sÄ±: ${indicators.institutional.blockTrades || 0} | ${indicators.institutional.blockTrades > 5 ? 'Kritik seviye' : indicators.institutional.blockTrades > 3 ? 'YÃ¼ksek aktivite' : indicators.institutional.blockTrades > 1 ? 'Normal' : 'DÃ¼ÅŸÃ¼k'}</div>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="color: #4ecdc4; font-weight: bold;">ðŸ“ˆ Order Flow Analizi</span>
                            <span style="color: ${indicators.institutional.orderFlow?.includes('STRONG BUY') ? '#4ecdc4' : indicators.institutional.orderFlow?.includes('BUY') ? '#44a08d' : indicators.institutional.orderFlow?.includes('STRONG SELL') ? '#ff6b6b' : indicators.institutional.orderFlow?.includes('SELL') ? '#e74c3c' : '#aaa'}; font-weight: bold; font-size: 1.1em;">
                                ${indicators.institutional.orderFlow || 'N/A'}
                            </span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
                            <div style="background: rgba(78, 205, 196, 0.15); border: 1px solid rgba(78, 205, 196, 0.5); padding: 12px; border-radius: 8px;">
                                <div style="color: #4ecdc4; font-size: 0.85em; margin-bottom: 5px;">ðŸŸ¢ Buy Pressure</div>
                                <div style="color: #4ecdc4; font-size: 1.3em; font-weight: bold;">${indicators.institutional.buyPressure || '0'}</div>
                            </div>
                            <div style="background: rgba(255, 107, 107, 0.15); border: 1px solid rgba(255, 107, 107, 0.5); padding: 12px; border-radius: 8px;">
                                <div style="color: #ff6b6b; font-size: 0.85em; margin-bottom: 5px;">ðŸ”´ Sell Pressure</div>
                                <div style="color: #ff6b6b; font-size: 1.3em; font-weight: bold;">${indicators.institutional.sellPressure || '0'}</div>
                            </div>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); border-radius: 10px; overflow: hidden; height: 12px; margin-top: 10px;">
                            <div style="height: 100%; background: linear-gradient(90deg, #4ecdc4, #2a9d8f); width: ${indicators.institutional.ratio || 50}%; display: flex; align-items: center; justify-content: center; color: #000; font-weight: bold; font-size: 0.7em;">BUY ${indicators.institutional.ratio || '50'}%</div>
                        </div>
                    </div>

                    <div style="background: rgba(78, 205, 196, 0.1); border-left: 4px solid #4ecdc4; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <div style="color: #4ecdc4; font-weight: bold; margin-bottom: 8px;">ðŸ’¡ Analiz Ã–zeti</div>
                        <div style="color: #ddd; font-size: 0.9em; line-height: 1.6;">
                            ${indicators.institutional.darkPool === 'VERY HIGH' ? 'âš¡ <strong>Kritik:</strong> Ã‡ok yÃ¼ksek dark pool aktivitesi tespit edildi. BÃ¼yÃ¼k kurumsal oyuncular aktif.' : ''}
                            ${indicators.institutional.orderFlow?.includes('STRONG BUY') ? 'ðŸ“ˆ <strong>GÃ¼Ã§lÃ¼ AlÄ±m:</strong> Kurumsal alÄ±m baskÄ±sÄ± Ã§ok yÃ¼ksek. YÃ¼kseliÅŸ sinyali gÃ¼Ã§lÃ¼.' : indicators.institutional.orderFlow?.includes('STRONG SELL') ? 'ðŸ“‰ <strong>GÃ¼Ã§lÃ¼ SatÄ±ÅŸ:</strong> Kurumsal satÄ±ÅŸ baskÄ±sÄ± yÃ¼ksek. Dikkatli olunmalÄ±.' : ''}
                            ${indicators.institutional.blockTrades > 5 ? 'ðŸŽ¯ <strong>Block Trade UyarÄ±sÄ±:</strong> Son 24 saatte kritik seviyede bÃ¼yÃ¼k iÅŸlem tespit edildi.' : ''}
                        </div>
                    </div>
                </div>
                ` : ''}

                ${indicators.whales ? `
                <div class="trade-setup" style="margin-top: 20px; background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 165, 0, 0.1)); border: 2px solid rgba(255, 215, 0, 0.5);">
                    <div class="setup-title" style="font-size: 1.4em; color: #ffd700; margin-bottom: 20px;">
                        ðŸ‹ WHALE ANALÄ°ZÄ° - BÃ¼yÃ¼k Oyuncu Takibi
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="color: #ffd700; font-weight: bold;">ðŸ‹ Whale Aktivite Durumu</span>
                            <span style="color: ${indicators.whales.status === 'VERY ACTIVE' ? '#4ecdc4' : indicators.whales.status === 'ACTIVE' ? '#ffd700' : indicators.whales.status === 'MODERATE' ? '#ff9500' : '#aaa'}; font-weight: bold; font-size: 1.1em;">
                                ${indicators.whales.status || 'N/A'}
                            </span>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); border-radius: 10px; overflow: hidden; height: 12px;">
                            <div style="height: 100%; background: linear-gradient(90deg, ${indicators.whales.status === 'VERY ACTIVE' ? '#4ecdc4' : indicators.whales.status === 'ACTIVE' ? '#ffd700' : indicators.whales.status === 'MODERATE' ? '#ff9500' : '#666'}, ${indicators.whales.status === 'VERY ACTIVE' ? '#2a9d8f' : indicators.whales.status === 'ACTIVE' ? '#ffaa00' : indicators.whales.status === 'MODERATE' ? '#cc7700' : '#444'}); width: ${indicators.whales.status === 'VERY ACTIVE' ? '90' : indicators.whales.status === 'ACTIVE' ? '70' : indicators.whales.status === 'MODERATE' ? '50' : '20'}%;"></div>
                        </div>
                        <div style="font-size: 0.75em; color: #aaa; margin-top: 5px;">Toplam Orders: ${indicators.whales.orders || 0} | Son 10 Candle: ${indicators.whales.recentOrders || 0} | Buys/Sells: ${indicators.whales.buys || 0}/${indicators.whales.sells || 0}</div>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="color: #ffd700; font-weight: bold;">ðŸ“Š Whale Sentiment & Flow</span>
                            <span style="color: ${indicators.whales.sentiment?.includes('BULLISH') ? '#4ecdc4' : indicators.whales.sentiment?.includes('BEARISH') ? '#ff6b6b' : '#aaa'}; font-weight: bold; font-size: 1.1em;">
                                ${indicators.whales.sentiment || 'N/A'}
                            </span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
                            <div style="background: rgba(78, 205, 196, 0.15); border: 1px solid rgba(78, 205, 196, 0.5); padding: 12px; border-radius: 8px;">
                                <div style="color: #4ecdc4; font-size: 0.85em; margin-bottom: 5px;">ðŸ“ˆ Accumulation</div>
                                <div style="color: #4ecdc4; font-size: 1.3em; font-weight: bold;">${indicators.whales.accumulation || '0'}%</div>
                                <div style="background: rgba(0,0,0,0.3); border-radius: 5px; overflow: hidden; height: 8px; margin-top: 8px;">
                                    <div style="height: 100%; background: linear-gradient(90deg, #4ecdc4, #2a9d8f); width: ${indicators.whales.accumulation || 0}%;"></div>
                                </div>
                            </div>
                            <div style="background: rgba(255, 107, 107, 0.15); border: 1px solid rgba(255, 107, 107, 0.5); padding: 12px; border-radius: 8px;">
                                <div style="color: #ff6b6b; font-size: 0.85em; margin-bottom: 5px;">ðŸ“‰ Distribution</div>
                                <div style="color: #ff6b6b; font-size: 1.3em; font-weight: bold;">${indicators.whales.distribution || '0'}%</div>
                                <div style="background: rgba(0,0,0,0.3); border-radius: 5px; overflow: hidden; height: 8px; margin-top: 8px;">
                                    <div style="height: 100%; background: linear-gradient(90deg, #ff6b6b, #e74c3c); width: ${indicators.whales.distribution || 0}%;"></div>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(255, 215, 0, 0.1); border-radius: 8px; border-left: 3px solid #ffd700;">
                            <div style="color: #ffd700; font-size: 0.85em; font-weight: bold;">Net Flow: ${parseFloat(indicators.whales.accumulation || 0) > parseFloat(indicators.whales.distribution || 0) ? '+' : ''}${((parseFloat(indicators.whales.accumulation || 0) - parseFloat(indicators.whales.distribution || 0)).toFixed(1))}%</div>
                            <div style="color: #ddd; font-size: 0.75em; margin-top: 3px;">Toplam Net Volume Flow: ${indicators.whales.netFlow || '0'}</div>
                        </div>
                    </div>

                    <div style="background: rgba(255, 215, 0, 0.1); border-left: 4px solid #ffd700; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <div style="color: #ffd700; font-weight: bold; margin-bottom: 8px;">ðŸ’¡ Whale Analiz Ã–zeti</div>
                        <div style="color: #ddd; font-size: 0.9em; line-height: 1.6;">
                            ${indicators.whales.status === 'VERY ACTIVE' ? 'âš¡ <strong>Kritik Aktivite:</strong> Whaleler Ã§ok aktif. BÃ¼yÃ¼k hareketler beklenebilir.' : ''}
                            ${indicators.whales.sentiment?.includes('STRONG BULLISH') ? 'ðŸ“ˆ <strong>GÃ¼Ã§lÃ¼ YÃ¼kseliÅŸ:</strong> Whale sentiment Ã§ok bullish. Accumulation devam ediyor.' : indicators.whales.sentiment?.includes('STRONG BEARISH') ? 'ðŸ“‰ <strong>GÃ¼Ã§lÃ¼ DÃ¼ÅŸÃ¼ÅŸ:</strong> Whale sentiment bearish. Distribution riski yÃ¼ksek.' : ''}
                            ${parseFloat(indicators.whales.accumulation || 0) > 60 ? 'ðŸŽ¯ <strong>YÃ¼ksek Accumulation:</strong> Whaleler topluyor. YÃ¼kseliÅŸ potansiyeli yÃ¼ksek.' : ''}
                            ${parseFloat(indicators.whales.distribution || 0) > 60 ? 'âš ï¸ <strong>YÃ¼ksek Distribution:</strong> Whaleler daÄŸÄ±tÄ±yor. DÃ¼ÅŸÃ¼ÅŸ riski var.' : ''}
                        </div>
                    </div>
                </div>
                ` : ''}

                ${indicators.marketMakers ? `
                <div class="trade-setup" style="margin-top: 20px; background: linear-gradient(135deg, rgba(255, 149, 0, 0.1), rgba(255, 107, 107, 0.1)); border: 2px solid rgba(255, 149, 0, 0.5);">
                    <div class="setup-title" style="font-size: 1.4em; color: #ff9500; margin-bottom: 20px;">
                        ðŸŽ¯ PÄ°YASA YAPICILARI - Wyckoff & VSA Analizi
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <span style="color: #ff9500; font-weight: bold;">ðŸ“Š Wyckoff FazÄ± Analizi</span>
                            <span style="color: ${indicators.marketMakers.wyckoff?.phase?.includes('ACCUMULATION') ? '#4ecdc4' : indicators.marketMakers.wyckoff?.phase?.includes('MARKUP') ? '#ffd700' : indicators.marketMakers.wyckoff?.phase?.includes('DISTRIBUTION') ? '#ff6b6b' : '#aaa'}; font-weight: bold; font-size: 1.2em;">
                                ${indicators.marketMakers.wyckoff?.phase || 'N/A'}
                            </span>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="color: #aaa; font-size: 0.85em;">Pozisyon</span>
                                <span style="color: #ffd700; font-weight: bold;">${indicators.marketMakers.wyckoff?.position || 'N/A'}%</span>
                            </div>
                            <div style="background: rgba(255, 149, 0, 0.2); border-radius: 10px; overflow: hidden; height: 16px; position: relative;">
                                <div style="position: absolute; left: ${indicators.marketMakers.wyckoff?.position || 50}%; top: 0; bottom: 0; width: 2px; background: #ffd700; z-index: 2;"></div>
                                <div style="height: 100%; display: flex; align-items: center; padding: 0 5px; color: #fff; font-size: 0.7em; font-weight: bold;">
                                    <div style="flex: 1; text-align: center; color: ${parseFloat(indicators.marketMakers.wyckoff?.position || 50) < 25 ? '#4ecdc4' : parseFloat(indicators.marketMakers.wyckoff?.position || 50) < 50 ? '#44a08d' : parseFloat(indicators.marketMakers.wyckoff?.position || 50) < 75 ? '#ffd700' : '#ff6b6b'};">
                                        ${parseFloat(indicators.marketMakers.wyckoff?.position || 50) < 25 ? 'DISCOUNT' : parseFloat(indicators.marketMakers.wyckoff?.position || 50) < 50 ? 'ACCUMULATION' : parseFloat(indicators.marketMakers.wyckoff?.position || 50) < 75 ? 'MARKUP' : 'PREMIUM'}
                                    </div>
                                </div>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-top: 10px; font-size: 0.7em;">
                                <div style="color: ${parseFloat(indicators.marketMakers.wyckoff?.position || 50) < 25 ? '#4ecdc4' : '#666'}; text-align: center;">0-25%<br>Discount</div>
                                <div style="color: ${parseFloat(indicators.marketMakers.wyckoff?.position || 50) >= 25 && parseFloat(indicators.marketMakers.wyckoff?.position || 50) < 50 ? '#44a08d' : '#666'}; text-align: center;">25-50%<br>Accumulation</div>
                                <div style="color: ${parseFloat(indicators.marketMakers.wyckoff?.position || 50) >= 50 && parseFloat(indicators.marketMakers.wyckoff?.position || 50) < 75 ? '#ffd700' : '#666'}; text-align: center;">50-75%<br>Markup</div>
                                <div style="color: ${parseFloat(indicators.marketMakers.wyckoff?.position || 50) >= 75 ? '#ff6b6b' : '#666'}; text-align: center;">75-100%<br>Distribution</div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <span style="color: #ff9500; font-weight: bold;">ðŸ“ˆ CVD (Cumulative Volume Delta)</span>
                            <span style="color: ${indicators.marketMakers.cvd?.trend?.includes('BULLISH') ? '#4ecdc4' : indicators.marketMakers.cvd?.trend?.includes('BEARISH') ? '#ff6b6b' : '#aaa'}; font-weight: bold; font-size: 1.1em;">
                                ${indicators.marketMakers.cvd?.trend || 'N/A'}
                            </span>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="color: #aaa; font-size: 0.85em;">CVD DeÄŸeri</span>
                                <span style="color: ${parseFloat(indicators.marketMakers.cvd?.value || 0) > 0 ? '#4ecdc4' : parseFloat(indicators.marketMakers.cvd?.value || 0) < 0 ? '#ff6b6b' : '#aaa'}; font-weight: bold; font-size: 1.1em;">
                                    ${parseFloat(indicators.marketMakers.cvd?.value || 0) >= 0 ? '+' : ''}${(parseFloat(indicators.marketMakers.cvd?.value || 0) / 1000000).toFixed(2)}M
                                </span>
                            </div>
                            <div style="background: rgba(0,0,0,0.5); border-radius: 10px; overflow: hidden; height: 20px; position: relative;">
                                <div style="position: absolute; left: 50%; top: 0; bottom: 0; width: 2px; background: #666; z-index: 1;"></div>
                                <div style="height: 100%; background: linear-gradient(90deg, ${parseFloat(indicators.marketMakers.cvd?.value || 0) >= 0 ? '#4ecdc4' : '#ff6b6b'}, ${parseFloat(indicators.marketMakers.cvd?.value || 0) >= 0 ? '#2a9d8f' : '#e74c3c'}); width: ${Math.min(100, Math.max(0, 50 + (parseFloat(indicators.marketMakers.cvd?.value || 0) / 10000000)))}%; margin-left: ${parseFloat(indicators.marketMakers.cvd?.value || 0) >= 0 ? '50' : (50 - Math.abs(parseFloat(indicators.marketMakers.cvd?.value || 0) / 10000000))}%;"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-top: 8px; font-size: 0.75em;">
                                <span style="color: #666;">GÃ¼Ã§: ${indicators.marketMakers.cvd?.strength || '0'}</span>
                                <span style="color: #aaa;">Neutral</span>
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <span style="color: #ff9500; font-weight: bold;">ðŸ” VSA (Volume Spread Analysis)</span>
                            <span style="color: ${indicators.marketMakers.vsa?.includes('BULLISH') || indicators.marketMakers.vsa?.includes('ABSORPTION') ? '#4ecdc4' : indicators.marketMakers.vsa?.includes('BEARISH') ? '#ff6b6b' : '#aaa'}; font-weight: bold; font-size: 1.1em;">
                                ${indicators.marketMakers.vsa || 'N/A'}
                            </span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div style="background: rgba(78, 205, 196, 0.15); border: 1px solid rgba(78, 205, 196, 0.5); padding: 12px; border-radius: 8px;">
                                <div style="color: #4ecdc4; font-size: 0.85em; margin-bottom: 5px;">ðŸ“Š Mevcut Volume</div>
                                <div style="color: #4ecdc4; font-size: 1.3em; font-weight: bold;">${indicators.marketMakers.volumeProfile?.current || '0'}</div>
                            </div>
                            <div style="background: rgba(255, 107, 107, 0.15); border: 1px solid rgba(255, 107, 107, 0.5); padding: 12px; border-radius: 8px;">
                                <div style="color: #ff6b6b; font-size: 0.85em; margin-bottom: 5px;">ðŸ“ˆ Ortalama Volume</div>
                                <div style="color: #ff6b6b; font-size: 1.3em; font-weight: bold;">${indicators.marketMakers.volumeProfile?.average || '0'}</div>
                            </div>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(255, 149, 0, 0.1); border-radius: 8px; border-left: 3px solid #ff9500;">
                            <div style="color: #ff9500; font-size: 0.85em; font-weight: bold;">Volume Ratio: ${indicators.marketMakers.volumeProfile?.ratio || '1.0'}x</div>
                            <div style="color: #ddd; font-size: 0.75em; margin-top: 3px;">${parseFloat(indicators.marketMakers.volumeProfile?.ratio || 1) > 2 ? 'Kritik seviye - Ã‡ok yÃ¼ksek volume' : parseFloat(indicators.marketMakers.volumeProfile?.ratio || 1) > 1.5 ? 'YÃ¼ksek volume - GÃ¼Ã§lÃ¼ hareket' : parseFloat(indicators.marketMakers.volumeProfile?.ratio || 1) < 0.5 ? 'DÃ¼ÅŸÃ¼k volume - ZayÄ±f hareket' : 'Normal volume'}</div>
                        </div>
                    </div>

                    <div style="background: rgba(255, 149, 0, 0.1); border-left: 4px solid #ff9500; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <div style="color: #ff9500; font-weight: bold; margin-bottom: 8px;">ðŸ’¡ Piyasa YapÄ±cÄ± Analiz Ã–zeti</div>
                        <div style="color: #ddd; font-size: 0.9em; line-height: 1.6;">
                            ${indicators.marketMakers.wyckoff?.phase?.includes('ACCUMULATION') ? 'ðŸ“ˆ <strong>Accumulation FazÄ±:</strong> Market makerler topluyor. YÃ¼kseliÅŸ hazÄ±rlÄ±ÄŸÄ± gÃ¶rÃ¼lÃ¼yor.' : indicators.marketMakers.wyckoff?.phase?.includes('DISTRIBUTION') ? 'ðŸ“‰ <strong>Distribution FazÄ±:</strong> Market makerler daÄŸÄ±tÄ±yor. DÃ¼ÅŸÃ¼ÅŸ riski artÄ±yor.' : ''}
                            ${indicators.marketMakers.cvd?.trend?.includes('STRONG BULLISH') ? 'âš¡ <strong>GÃ¼Ã§lÃ¼ CVD:</strong> AlÄ±m baskÄ±sÄ± Ã§ok yÃ¼ksek. YÃ¼kseliÅŸ momentumu gÃ¼Ã§lÃ¼.' : indicators.marketMakers.cvd?.trend?.includes('STRONG BEARISH') ? 'âš ï¸ <strong>Negatif CVD:</strong> SatÄ±ÅŸ baskÄ±sÄ± yÃ¼ksek. Dikkatli olunmalÄ±.' : ''}
                            ${indicators.marketMakers.vsa?.includes('STRONG ABSORPTION') ? 'ðŸŽ¯ <strong>Absorption:</strong> GÃ¼Ã§lÃ¼ absorption tespit edildi. BÃ¼yÃ¼k hareket Ã¶ncesi sinyal.' : indicators.marketMakers.vsa?.includes('STRONG BULLISH') ? 'ðŸ“ˆ <strong>Bullish VSA:</strong> Volume ve spread analizi yÃ¼kseliÅŸi destekliyor.' : ''}
                        </div>
                    </div>
                </div>
                ` : ''}

                ${indicators.traders ? `
                <div class="trade-setup" style="margin-top: 20px; background: linear-gradient(135deg, rgba(103, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border: 2px solid rgba(103, 126, 234, 0.5);">
                    <div class="setup-title" style="font-size: 1.4em; color: #667eea; margin-bottom: 20px;">
                        ðŸ‘¥ TRADER ANALÄ°ZÄ° - Retail vs Institutional
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <span style="color: #667eea; font-weight: bold;">ðŸ“Š Volume DaÄŸÄ±lÄ±mÄ±</span>
                            <span style="color: ${indicators.traders.dominance === 'INSTITUTIONAL' ? '#4ecdc4' : '#ff9500'}; font-weight: bold; font-size: 1.1em;">
                                ${indicators.traders.dominance === 'INSTITUTIONAL' ? 'ðŸ¢ Kurumsal Dominant' : 'ðŸ‘¤ Retail Dominant'}
                            </span>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; margin-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                                    <span style="color: #ff9500; font-size: 0.9em; font-weight: bold;">ðŸ‘¤ Retail Traders</span>
                                    <span style="color: #ff9500; font-weight: bold; font-size: 1.1em;">${indicators.traders.retailRatio || '0'}%</span>
                                </div>
                                <div style="background: rgba(255, 149, 0, 0.2); border-radius: 10px; overflow: hidden; height: 20px; position: relative;">
                                    <div style="height: 100%; background: linear-gradient(90deg, #ff9500, #ff7700); width: ${indicators.traders.retailRatio || 0}%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px; color: #000; font-weight: bold; font-size: 0.75em; transition: width 0.5s;"></div>
                                </div>
                                <div style="font-size: 0.75em; color: #aaa; margin-top: 5px;">Toplam Volume: ${indicators.traders.retail || '0'}</div>
                            </div>
                            
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                                    <span style="color: #4ecdc4; font-size: 0.9em; font-weight: bold;">ðŸ¢ Institutional Traders</span>
                                    <span style="color: #4ecdc4; font-weight: bold; font-size: 1.1em;">${indicators.traders.ratio || '0'}%</span>
                                </div>
                                <div style="background: rgba(78, 205, 196, 0.2); border-radius: 10px; overflow: hidden; height: 20px; position: relative;">
                                    <div style="height: 100%; background: linear-gradient(90deg, #4ecdc4, #2a9d8f); width: ${indicators.traders.ratio || 0}%; display: flex; align-items: center; justify-content: flex-end; padding-right: 8px; color: #000; font-weight: bold; font-size: 0.75em; transition: width 0.5s;"></div>
                                </div>
                                <div style="font-size: 0.75em; color: #aaa; margin-top: 5px;">Toplam Volume: ${indicators.traders.institutional || '0'}</div>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                            <div style="background: rgba(103, 126, 234, 0.15); border: 1px solid rgba(103, 126, 234, 0.5); padding: 12px; border-radius: 8px;">
                                <div style="color: #667eea; font-size: 0.85em; margin-bottom: 5px;">ðŸ“Š Market Sentiment</div>
                                <div style="color: ${indicators.traders.sentiment?.includes('BULLISH') ? '#4ecdc4' : indicators.traders.sentiment?.includes('BEARISH') ? '#ff6b6b' : '#aaa'}; font-size: 1.1em; font-weight: bold;">
                                    ${indicators.traders.sentiment || 'N/A'}
                                </div>
                            </div>
                            <div style="background: rgba(103, 126, 234, 0.15); border: 1px solid rgba(103, 126, 234, 0.5); padding: 12px; border-radius: 8px;">
                                <div style="color: #667eea; font-size: 0.85em; margin-bottom: 5px;">ðŸ’° Smart Money Flow</div>
                                <div style="color: ${indicators.traders.smartMoney?.includes('BUYING') ? '#4ecdc4' : '#ff6b6b'}; font-size: 1.1em; font-weight: bold;">
                                    ${indicators.traders.smartMoney || 'N/A'}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="background: rgba(103, 126, 234, 0.1); border-left: 4px solid #667eea; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <div style="color: #667eea; font-weight: bold; margin-bottom: 8px;">ðŸ’¡ Trader Analiz Ã–zeti</div>
                        <div style="color: #ddd; font-size: 0.9em; line-height: 1.6;">
                            ${indicators.traders.dominance === 'INSTITUTIONAL' ? 'ðŸ¢ <strong>Kurumsal Dominans:</strong> BÃ¼yÃ¼k oyuncular kontrolÃ¼ ele almÄ±ÅŸ. Profesyonel hareketler beklenebilir.' : 'ðŸ‘¤ <strong>Retail Dominans:</strong> KÃ¼Ã§Ã¼k yatÄ±rÄ±mcÄ±lar aktif. Volatilite artabilir.'}
                            ${parseFloat(indicators.traders.ratio || 0) > 60 ? 'ðŸ“ˆ <strong>YÃ¼ksek Kurumsal Oran:</strong> BÃ¼yÃ¼k oyuncularÄ±n payÄ± Ã§ok yÃ¼ksek. GÃ¼venilir sinyaller.' : parseFloat(indicators.traders.retailRatio || 0) > 60 ? 'âš ï¸ <strong>YÃ¼ksek Retail Oran:</strong> KÃ¼Ã§Ã¼k yatÄ±rÄ±mcÄ±larÄ±n payÄ± yÃ¼ksek. Dikkatli olunmalÄ±.' : ''}
                            ${indicators.traders.sentiment?.includes('STRONG BULLISH') ? 'ðŸ“ˆ <strong>GÃ¼Ã§lÃ¼ Bullish Sentiment:</strong> Piyasa Ã§ok bullish. YÃ¼kseliÅŸ potansiyeli yÃ¼ksek.' : indicators.traders.sentiment?.includes('STRONG BEARISH') ? 'ðŸ“‰ <strong>GÃ¼Ã§lÃ¼ Bearish Sentiment:</strong> Piyasa bearish. DÃ¼ÅŸÃ¼ÅŸ riski var.' : ''}
                            ${indicators.traders.smartMoney?.includes('STRONG BUYING') ? 'âš¡ <strong>Smart Money AlÄ±mÄ±:</strong> Profesyonel oyuncular topluyor. YÃ¼kseliÅŸ sinyali gÃ¼Ã§lÃ¼.' : indicators.traders.smartMoney?.includes('STRONG SELLING') ? 'âš ï¸ <strong>Smart Money SatÄ±ÅŸÄ±:</strong> Profesyonel oyuncular daÄŸÄ±tÄ±yor. Dikkat edilmeli.' : ''}
                        </div>
                    </div>
                </div>
                ` : ''}

                ${indicators.smartMoneyConcepts ? `
                <div class="trade-setup">
                    <div class="setup-title">ðŸ’Ž Smart Money Concepts</div>
                    <div class="setup-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                        <div class="setup-item">
                            <div class="setup-label">BOS</div>
                            <div class="setup-value ${indicators.smartMoneyConcepts.bos?.includes('BULLISH') ? 'value-long' : indicators.smartMoneyConcepts.bos?.includes('BEARISH') ? 'value-short' : 'value-neutral'}">${indicators.smartMoneyConcepts.bos || 'N/A'}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">CHoCH</div>
                            <div class="setup-value ${indicators.smartMoneyConcepts.choch?.includes('BULLISH') ? 'value-long' : indicators.smartMoneyConcepts.choch?.includes('BEARISH') ? 'value-short' : 'value-neutral'}">${indicators.smartMoneyConcepts.choch || 'N/A'}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">Zone</div>
                            <div class="setup-value ${indicators.smartMoneyConcepts.zone === 'DISCOUNT' ? 'value-long' : indicators.smartMoneyConcepts.zone === 'PREMIUM' ? 'value-short' : 'value-neutral'}">${indicators.smartMoneyConcepts.zone || 'N/A'}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">Position</div>
                            <div class="setup-value value-neutral">${indicators.smartMoneyConcepts.position || 'N/A'}%</div>
                        </div>
                    </div>
                </div>
                ` : ''}

                ${indicators.pumpDump || indicators.trendBreak || indicators.peaksAndDips ? `
                <div class="trade-setup">
                    <div class="setup-title">ðŸŽ¯ Stratejik Sinyaller</div>
                    <div class="setup-grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
                        ${indicators.pumpDump ? `
                        <div class="setup-item">
                            <div class="setup-label">Pump & Dump</div>
                            <div class="setup-value ${indicators.pumpDump.strength > 70 ? 'value-long' : indicators.pumpDump.strength < 30 ? 'value-short' : 'value-neutral'}">${indicators.pumpDump.signal || 'N/A'}</div>
                            <div style="font-size: 0.8em; color: #aaa;">Strength: ${indicators.pumpDump.strength || 0}/100 | Vol: ${indicators.pumpDump.volSpike || 'N/A'}x</div>
                        </div>
                        ` : ''}
                        ${indicators.trendBreak ? `
                        <div class="setup-item">
                            <div class="setup-label">Trend Break</div>
                            <div class="setup-value ${indicators.trendBreak.signal?.includes('BULLISH') ? 'value-long' : indicators.trendBreak.signal?.includes('BEARISH') ? 'value-short' : 'value-neutral'}">${indicators.trendBreak.signal || 'N/A'}</div>
                            <div style="font-size: 0.8em; color: #aaa;">Pivots: ${indicators.trendBreak.pivotHighs || 0}H/${indicators.trendBreak.pivotLows || 0}L</div>
                        </div>
                        ` : ''}
                        ${indicators.peaksAndDips ? `
                        <div class="setup-item">
                            <div class="setup-label">Peaks & Dips</div>
                            <div class="setup-value ${indicators.peaksAndDips.signal?.includes('BUY') ? 'value-long' : indicators.peaksAndDips.signal?.includes('SELL') ? 'value-short' : 'value-neutral'}">${indicators.peaksAndDips.signal || 'N/A'}</div>
                            <div style="font-size: 0.8em; color: #aaa;">Confidence: ${indicators.peaksAndDips.confidence || 0}% | RSI: ${indicators.peaksAndDips.rsi || 'N/A'}</div>
                        </div>
                        ` : ''}
                    </div>
                </div>
                ` : ''}

                ${indicators.indicators90 ? `
                <div class="trade-setup">
                    <div class="setup-title">ðŸ“Š Premium Ä°ndikatÃ¶r Ã–zeti (50+ Optimize)</div>
                    <div class="setup-grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));">
                        <div class="setup-item">
                            <div class="setup-label">Bull Signals</div>
                            <div class="setup-value value-long" style="font-size: 1.5em;">${indicators.indicators90.bull || 0}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">Bear Signals</div>
                            <div class="setup-value value-short" style="font-size: 1.5em;">${indicators.indicators90.bear || 0}</div>
                        </div>
                        ${indicators.indicators90.scores ? `
                        <div class="setup-item">
                            <div class="setup-label">Trend</div>
                            <div class="setup-value value-neutral">${indicators.indicators90.scores.trend?.bull || 0}/${indicators.indicators90.scores.trend?.bear || 0}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">Momentum</div>
                            <div class="setup-value value-neutral">${indicators.indicators90.scores.momentum?.bull || 0}/${indicators.indicators90.scores.momentum?.bear || 0}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">Volume</div>
                            <div class="setup-value value-neutral">${indicators.indicators90.scores.volume?.bull || 0}/${indicators.indicators90.scores.volume?.bear || 0}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">Volatility</div>
                            <div class="setup-value value-neutral">${indicators.indicators90.scores.volatility?.bull || 0}/${indicators.indicators90.scores.volatility?.bear || 0}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">Institutional</div>
                            <div class="setup-value value-neutral">${indicators.indicators90.scores.institutional?.bull || 0}/${indicators.indicators90.scores.institutional?.bear || 0}</div>
                        </div>
                        ` : ''}
                    </div>
                </div>
                ` : ''}

                <div class="ai-analysis" id="ai-analysis-${coin.replace('/', '-')}">
                    <div class="ai-header">
                        <div class="ai-logo">ðŸ¤–</div>
                        <div>
                            <div style="font-size: 1.3em; font-weight: bold; color: #ffd700;">GROQ AI Analizi</div>
                            <div style="font-size: 0.9em; color: #aaa;">Llama 3.3 70B - DetaylÄ± Analiz</div>
                        </div>
                    </div>
                    <div class="ai-content" id="ai-content-${coin.replace('/', '-')}" style="text-align: center; padding: 40px;">
                        <button onclick="analyzeWithAIDetailed('${coin}')" 
                                id="ai-button-${coin.replace('/', '-')}"
                                style="width: 100%; padding: 20px; background: linear-gradient(45deg, #4ecdc4, #44a08d); 
                                       border: none; border-radius: 15px; cursor: pointer; font-weight: bold; 
                                       font-size: 1.2em; color: #fff; box-shadow: 0 4px 15px rgba(78, 205, 196, 0.4);
                                       transition: all 0.3s;">
                            ðŸ¤– AI Analizi BaÅŸlat
                        </button>
                        <div id="ai-loading-${coin.replace('/', '-')}" style="display: none; margin-top: 20px;">
                            <div style="color: #ffd700; font-size: 1.1em;">â³ Analiz ediliyor...</div>
                        </div>
                        <div id="ai-result-${coin.replace('/', '-')}" style="display: none; margin-top: 20px; text-align: left;"></div>
                    </div>
                </div>

                <button onclick="window.open('https://www.tradingview.com/chart/?symbol=BINANCE:${coin.replace('/', '')}', '_blank')" 
                        style="width: 100%; margin-top: 10px; padding: 15px; background: linear-gradient(45deg, #ffd700, #4ecdc4); 
                               border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 1.1em; color: #000;">
                    ðŸ“Š TradingView'de AÃ§
                </button>
            `;
            
            return card;
        }

        // ===== DETAYLI AI ANALÄ°Z FONKSÄ°YONU =====
        async function analyzeWithAIDetailed(coin) {
            const buttonId = `ai-button-${coin.replace('/', '-')}`;
            const loadingId = `ai-loading-${coin.replace('/', '-')}`;
            const resultId = `ai-result-${coin.replace('/', '-')}`;
            const contentId = `ai-content-${coin.replace('/', '-')}`;
            
            const button = document.getElementById(buttonId);
            const loading = document.getElementById(loadingId);
            const result = document.getElementById(resultId);
            const content = document.getElementById(contentId);
            
            if (!button || !loading || !result || !content) return;
            
            // Butonu devre dÄ±ÅŸÄ± bÄ±rak ve loading gÃ¶ster
            button.disabled = true;
            button.style.opacity = '0.5';
            loading.style.display = 'block';
            result.style.display = 'none';
            
            try {
                const priceData = realPrices[coin];
                const indicators = technicalIndicators[coin];
                
                if (!priceData) {
                    throw new Error('Fiyat verisi bulunamadÄ±');
                }
                
                // DetaylÄ± AI analizi
                const aiResult = await getAIAnalysis(coin, priceData, indicators);
                
                // Sonucu gÃ¶ster
                result.innerHTML = `
                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                        <div style="white-space: pre-wrap; line-height: 1.8; font-size: 0.95em; color: #fff;">
${aiResult.analysis}
                        </div>
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 2px solid rgba(255, 215, 0, 0.3);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong style="color: #ffd700;">Ã–NERÄ°:</strong> 
                                    <span style="color: ${aiResult.recommendation === 'LONG' ? '#4ecdc4' : aiResult.recommendation === 'SHORT' ? '#ff6b6b' : '#ffd700'}; font-weight: bold;">
                                        ${aiResult.recommendation}
                                    </span>
                                </div>
                                <div>
                                    <strong style="color: #ffd700;">GÃœVEN:</strong> 
                                    <span style="color: ${aiResult.confidence === 'HIGH' ? '#4ecdc4' : aiResult.confidence === 'MEDIUM' ? '#ffd700' : '#ff6b6b'};">
                                        ${aiResult.confidence}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-top: 15px;">
                        <button onclick="sendDetailedTelegram('${coin}', ${JSON.stringify(priceData).replace(/"/g, '&quot;')}, ${JSON.stringify(indicators || {}).replace(/"/g, '&quot;')}, ${JSON.stringify(aiResult.analysis).replace(/"/g, '&quot;')})" 
                                style="padding: 12px; background: linear-gradient(45deg, #25d366, #128c7e); 
                                       border: none; border-radius: 10px; cursor: pointer; font-weight: bold; 
                                       color: #fff; font-size: 0.9em;">
                            ðŸ“± Telegram'a GÃ¶nder
                        </button>
                        <button onclick="navigator.clipboard.writeText(\`${aiResult.analysis.replace(/`/g, '\\`').replace(/\$/g, '\\$')}\`) && alert('âœ… KopyalandÄ±!')" 
                                style="padding: 12px; background: linear-gradient(45deg, #667eea, #764ba2); 
                                       border: none; border-radius: 10px; cursor: pointer; font-weight: bold; 
                                       color: #fff; font-size: 0.9em;">
                            ðŸ“‹ Kopyala
                        </button>
                    </div>
                `;
                
                result.style.display = 'block';
                loading.style.display = 'none';
                
            } catch (error) {
                console.error('AI analiz hatasÄ±:', error);
                result.innerHTML = `
                    <div style="background: rgba(255, 0, 0, 0.2); padding: 20px; border-radius: 10px; color: #ff6b6b;">
                        <strong>âŒ Hata:</strong> ${error.message}<br>
                        <button onclick="analyzeWithAIDetailed('${coin}')" 
                                style="margin-top: 10px; padding: 10px 20px; background: #4ecdc4; 
                                       border: none; border-radius: 8px; cursor: pointer; font-weight: bold; color: #000;">
                            ðŸ”„ Tekrar Dene
                        </button>
                    </div>
                `;
                result.style.display = 'block';
                loading.style.display = 'none';
                button.disabled = false;
                button.style.opacity = '1';
            }
        }

        // ===== 15 YENÄ° FEATURE FONKSIYONLARI =====
        function switchNewFeature(feature, event) {
            document.querySelectorAll('.new-feature-btn').forEach(btn => btn.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            // TÃ¼m feature iÃ§eriklerini gizle
            document.querySelectorAll('.new-feature-content').forEach(c => {
                c.style.display = 'none';
                c.classList.remove('active');
            });
            
            // SeÃ§ili feature'Ä± gÃ¶ster
            const el = document.getElementById(`feature-${feature}`);
            if (el) {
                el.style.display = 'block';
                el.classList.add('active');
                
                // Feature'a gÃ¶re iÃ§eriÄŸi gÃ¼ncelle
                updateFeatureContent(feature);
            }
        }

        // Feature iÃ§eriklerini gÃ¼ncelle
        function updateFeatureContent(feature) {
            switch(feature) {
                case 'heatmap':
                    updateHeatmap();
                    break;
                case 'smartmoney':
                    updateSmartMoney();
                    break;
                case 'liquidation':
                    updateLiquidationFeature();
                    break;
                case 'funding':
                    updateFundingRatesDisplay();
                    break;
                case 'onchain':
                    updateOnChain();
                    break;
                case 'fear':
                    updateFearGreed();
                    break;
            }
        }

        function generateHeatmap() { 
            // TÃ¼m coinleri al veya popÃ¼ler coinler
            const allCoins = Object.keys(realPrices);
            const coins = allCoins.length > 0 ? allCoins.slice(0, 50) : 
                ['BTC/USDT', 'ETH/USDT', 'BNB/USDT', 'SOL/USDT', 'ADA/USDT', 'XRP/USDT', 'DOGE/USDT', 'DOT/USDT', 
                 'LINK/USDT', 'AVAX/USDT', 'MATIC/USDT', 'UNI/USDT', 'ATOM/USDT', 'ETC/USDT', 'LTC/USDT', 'BCH/USDT'];
            
            return coins.map(coin => {
                const priceData = realPrices[coin];
                const change = priceData ? priceData.change : (Math.random() * 10 - 5); // Fallback
                const pos = change > 0;
                const displayCoin = coin.split('/')[0];
                const intensity = Math.min(100, Math.abs(change) * 10);
                return `
                    <div class="heatmap-cell ${pos ? 'heatmap-positive' : 'heatmap-negative'}" 
                         onclick="switchTab('results', event); startScan();"
                         style="opacity: ${0.5 + (intensity / 200)}; animation: fadeInUp 0.5s ease-out backwards;">
                        <div style="font-weight: bold; margin-bottom: 5px; font-size: 0.9em;">${displayCoin}</div>
                        <div style="font-size: 1.1em;">${change.toFixed(2)}%</div>
                        ${priceData ? `<div style="font-size: 0.75em; opacity: 0.7; margin-top: 3px;">$${formatPrice(priceData.price)}</div>` : ''}
                    </div>`;
            }).join(''); 
        }

        function updateHeatmap() {
            const container = document.querySelector('#feature-heatmap .heatmap-container');
            if (container) {
                container.innerHTML = generateHeatmap();
            }
        }

        function updateSmartMoney() {
            const container = document.querySelector('#feature-smartmoney .smart-money-grid');
            if (!container) return;
            
            // En yÃ¼ksek skorlu coinlerden Smart Money analizi
            const coins = Object.keys(realPrices)
                .map(coin => ({
                    coin,
                    priceData: realPrices[coin],
                    indicators: technicalIndicators[coin],
                    score: calculateRealScore(coin, realPrices[coin])
                }))
                .filter(item => item.score > 60)
                .sort((a, b) => b.score - a.score)
                .slice(0, 10);
            
            if (coins.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: #aaa;">ðŸ“Š Tarama yapÄ±ldÄ±ktan sonra Smart Money analizi gÃ¶rÃ¼necek</div>';
                return;
            }
            
            container.innerHTML = coins.map(item => {
                const indicators = item.indicators || {};
                const institutional = indicators.institutional || {};
                const whales = indicators.whales || {};
                const marketMakers = indicators.marketMakers || {};
                
                return `
                    <div class="result-card" style="margin-bottom: 20px; cursor: pointer;" onclick="showCoinDetailModal('${item.coin}', ${JSON.stringify(item.priceData).replace(/"/g, '&quot;')}, ${item.score}, '${determineRealSignal(item.coin, item.priceData, item.score)}', ${JSON.stringify(indicators).replace(/"/g, '&quot;')})">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3 style="font-size: 1.5em; color: #ffd700;">${item.coin}</h3>
                            <div style="font-size: 1.2em; font-weight: bold; color: #4ecdc4;">Skor: ${item.score}</div>
                        </div>
                        
                        ${institutional.darkPool ? `
                        <div style="background: rgba(78, 205, 196, 0.1); padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <div style="color: #4ecdc4; font-weight: bold; margin-bottom: 5px;">ðŸ¢ Dark Pool</div>
                            <div style="color: #fff;">${institutional.darkPool.status || 'N/A'}</div>
                        </div>
                        ` : ''}
                        
                        ${whales.activity ? `
                        <div style="background: rgba(155, 89, 182, 0.1); padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <div style="color: #9b59b6; font-weight: bold; margin-bottom: 5px;">ðŸ‹ Whale Aktivite</div>
                            <div style="color: #fff;">${whales.activity.status || 'N/A'}</div>
                        </div>
                        ` : ''}
                        
                        ${marketMakers.wyckoff ? `
                        <div style="background: rgba(255, 149, 0, 0.1); padding: 10px; border-radius: 8px;">
                            <div style="color: #ff9500; font-weight: bold; margin-bottom: 5px;">ðŸ“Š Wyckoff FazÄ±</div>
                            <div style="color: #fff;">${marketMakers.wyckoff.phase || 'N/A'}</div>
                        </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function updateLiquidationFeature() {
            const container = document.querySelector('#feature-liquidation .liquidation-list');
            if (!container) return;
            
            // Top 10 coin iÃ§in liquidation verileri
            const coins = Object.keys(realPrices)
                .slice(0, 10)
                .map(coin => ({
                    coin,
                    priceData: realPrices[coin],
                    liquidation: liquidationData[coin.replace('/USDT', 'USDT')]
                }));
            
            container.innerHTML = coins.map(item => {
                const symbol = item.coin.replace('/USDT', 'USDT');
                const liq = item.liquidation || {};
                const totalLiq = liq.total || 0;
                const longLiq = liq.longLiquidation || 0;
                const shortLiq = liq.shortLiquidation || 0;
                
                return `
                    <div style="background: rgba(255, 107, 107, 0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #ff6b6b; margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: bold; font-size: 1.2em; color: #fff; margin-bottom: 5px;">${item.coin}</div>
                                <div style="color: #aaa; font-size: 0.9em;">Fiyat: $${formatPrice(item.priceData.price)}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: #ff6b6b; font-weight: bold; font-size: 1.1em;">$${(totalLiq / 1000000).toFixed(2)}M</div>
                                <div style="font-size: 0.85em; color: #aaa;">
                                    <span style="color: #4ecdc4;">ðŸŸ¢ ${(longLiq / 1000000).toFixed(2)}M</span> | 
                                    <span style="color: #ff6b6b;">ðŸ”´ ${(shortLiq / 1000000).toFixed(2)}M</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateOnChain() {
            const container = document.getElementById('feature-onchain');
            if (!container) return;
            
            const btcData = onChainData['BTC'] || {};
            const ethData = onChainData['ETH'] || {};
            
            container.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div style="background: rgba(255, 215, 0, 0.1); padding: 20px; border-radius: 15px; border: 2px solid rgba(255, 215, 0, 0.3);">
                        <h3 style="color: #ffd700; margin-bottom: 15px;">â‚¿ Bitcoin (BTC)</h3>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <div><strong>Market Cap:</strong> $${(btcData.marketCap / 1e9).toFixed(2)}B</div>
                            <div><strong>Hash Rate:</strong> ${(btcData.hashRate / 1e18).toFixed(2)} EH/s</div>
                            <div><strong>Total BTC:</strong> ${(btcData.totalBitcoins / 1e6).toFixed(2)}M</div>
                            <div><strong>Transactions:</strong> ${(btcData.transactions / 1000).toFixed(1)}K</div>
                        </div>
                    </div>
                    <div style="background: rgba(78, 205, 196, 0.1); padding: 20px; border-radius: 15px; border: 2px solid rgba(78, 205, 196, 0.3);">
                        <h3 style="color: #4ecdc4; margin-bottom: 15px;">Îž Ethereum (ETH)</h3>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <div><strong>Market Cap:</strong> $${(ethData.marketCap / 1e9).toFixed(2)}B</div>
                            <div><strong>TVL:</strong> $${(ethData.tvl / 1e9).toFixed(2)}B</div>
                            <div><strong>Supply:</strong> ${(ethData.totalSupply / 1e6).toFixed(2)}M</div>
                            <div><strong>Circulating:</strong> ${(ethData.circulatingSupply / 1e6).toFixed(2)}M</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function updateFearGreed() {
            const container = document.getElementById('feature-fear');
            if (!container) return;
            
            const index = fearGreedIndex.value || 50;
            const status = fearGreedIndex.status || 'Neutral';
            const level = index < 25 ? 'Ekstrem Korku' : index < 45 ? 'Korku' : index < 55 ? 'NÃ¶tr' : index < 75 ? 'AÃ§gÃ¶zlÃ¼lÃ¼k' : 'Ekstrem AÃ§gÃ¶zlÃ¼lÃ¼k';
            const color = index < 25 ? '#ff6b6b' : index < 45 ? '#ff9500' : index < 55 ? '#ffd700' : index < 75 ? '#4ecdc4' : '#9b59b6';
            
            container.innerHTML = `
                <div style="text-align: center; padding: 30px;">
                    <div style="font-size: 5em; margin-bottom: 20px;">${index}</div>
                    <div style="font-size: 2em; font-weight: bold; color: ${color}; margin-bottom: 20px;">${level}</div>
                    <div style="background: rgba(0,0,0,0.3); border-radius: 15px; padding: 20px; margin: 20px 0;">
                        <div style="background: rgba(0,0,0,0.3); border-radius: 10px; overflow: hidden; height: 40px; position: relative;">
                            <div style="height: 100%; background: linear-gradient(90deg, #ff6b6b 0%, #ff9500 25%, #ffd700 50%, #4ecdc4 75%, #9b59b6 100%); width: ${index}%; transition: width 1s ease-out;"></div>
                        </div>
                        <div style="margin-top: 15px; color: #aaa;">${status}</div>
                    </div>
                    <div style="margin-top: 20px; font-size: 0.9em; color: #aaa;">
                        Son GÃ¼ncelleme: ${new Date().toLocaleString('tr-TR')}
                    </div>
                </div>
            `;
        }

        function showNewFeatures() {
            const home = document.getElementById('home');
            if (!home) return;
            const btn = home.querySelector('.scan-button');
            if (!btn) return;
            
            const html = `<div style="margin-top:30px;">
                <div id="feature-heatmap" class="new-feature-content active"><h3>ðŸŒ¡ï¸ Heatmap</h3><div class="heatmap-container">${generateHeatmap()}</div></div>
                <div id="feature-smartmoney" class="new-feature-content" style="display:none;"><h3>ðŸ‹ Smart Money</h3><div class="smart-money-grid"></div></div>
                <div id="feature-liquidation" class="new-feature-content" style="display:none;"><h3>âš ï¸ Liquidation</h3><div class="liquidation-list"></div></div>
                <div id="feature-onchain" class="new-feature-content" style="display:none;"><h3>â›“ï¸ On-Chain</h3></div>
                <div id="feature-funding" class="new-feature-content" style="display:none;">
                    <h3>ðŸ“Š Funding Rates - GerÃ§ek ZamanlÄ±</h3>
                    <div id="funding-rates-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;"></div>
                </div>
                <div id="feature-sr" class="new-feature-content" style="display:none;"><h3>ðŸ“ S/R</h3></div>
                <div id="feature-divergence" class="new-feature-content" style="display:none;"><h3>ðŸ”€ Divergence</h3></div>
                <div id="feature-volume" class="new-feature-content" style="display:none;"><h3>ðŸ“ˆ Volume</h3></div>
                <div id="feature-session" class="new-feature-content" style="display:none;"><h3>ðŸŒ Session</h3></div>
                <div id="feature-risk" class="new-feature-content" style="display:none;"><h3>ðŸ’Ž Risk</h3></div>
                <div id="feature-backtest" class="new-feature-content" style="display:none;"><h3>âš™ï¸ Backtest</h3></div>
                <div id="feature-news" class="new-feature-content" style="display:none;"><h3>ðŸ“° News</h3></div>
                <div id="feature-options" class="new-feature-content" style="display:none;"><h3>ðŸ“ž Options</h3></div>
                <div id="feature-fear" class="new-feature-content" style="display:none;"><h3>ðŸ˜¨ Fear & Greed</h3></div>
                <div id="feature-multitf" class="new-feature-content" style="display:none;"><h3>â±ï¸ Multi-TF</h3></div>
            </div>`;
            
            btn.insertAdjacentHTML('afterend', html);
        }

        // ===== DETAYLI COIN ANALÄ°Z MODAL FONKSÄ°YONU =====
        function showCoinDetailModal(coin, priceData, score, signal, indicators) {
            const modal = document.getElementById('coinDetailModal');
            const content = document.getElementById('coinDetailContent');
            
            if (!modal || !content) return;
            
            // Modal'Ä± gÃ¶ster
            modal.classList.add('active');
            
            // Fibonacci seviyelerini hesapla
            const fibLevels = calculateFibonacciLevels(coin, priceData.price);
            
            // Ä°ndikatÃ¶r Ã¶zetini hesapla
            const indicatorSummary = calculateIndicatorSummary(indicators);
            
            // Trade seviyelerini hesapla
            const tradeLevels = calculateTradeLevels(coin, priceData, signal, indicators);
            
            // Ä°Ã§eriÄŸi oluÅŸtur
            const lang = currentLanguage === 'de' ? 'de' : 'tr';
            const texts = lang === 'de' ? {
                title: 'ðŸ“Š DETAILLIERTE ANALYSE',
                close: 'SchlieÃŸen',
                masterSignal: 'HAUPTSIGNAL',
                recommendation: 'EMPFOHLUNG',
                long: 'LONG',
                short: 'SHORT',
                wait: 'WARTEN',
                entry: 'EINTRITT',
                stopLoss: 'STOP LOSS',
                takeProfit: 'TAKE PROFIT',
                fibonacci: 'FIBONACCI SEVIYELERI',
                indicators: 'INDIKATOREN ÃœBERSICHT',
                institutional: 'INSTITUTIONELLE ANALYSE',
                whales: 'WAL-ANALYSE',
                marketMakers: 'MARKTMAKER-ANALYSE',
                traders: 'HÃ„NDLER-ANALYSE',
                liquidation: 'LIQUIDATIONS-LEVELS',
                aiAnalysis: 'KI-ANALYSE STARTEN'
            } : {
                title: 'ðŸ“Š DETAYLI ANALÄ°Z',
                close: 'Kapat',
                masterSignal: 'MASTER SÄ°NYAL',
                recommendation: 'Ã–NERÄ°',
                long: 'LONG',
                short: 'SHORT',
                wait: 'BEKLE',
                entry: 'GÄ°RÄ°Åž',
                stopLoss: 'STOP LOSS',
                takeProfit: 'TAKE PROFIT',
                fibonacci: 'FÄ°BONACCÄ° SEVÄ°YELERÄ°',
                indicators: 'Ä°NDÄ°KATÃ–R Ã–ZETÄ°',
                institutional: 'KURUMSAL ANALÄ°Z',
                whales: 'BALÄ°NA ANALÄ°ZÄ°',
                marketMakers: 'PÄ°YASA YAPICI ANALÄ°ZÄ°',
                traders: 'TRADER ANALÄ°ZÄ°',
                liquidation: 'LÄ°KÄ°DASYON SEVÄ°YELERÄ°',
                aiAnalysis: 'AI ANALÄ°ZÄ° BAÅžLAT'
            };
            
            content.innerHTML = `
                <div class="modal-close" onclick="document.getElementById('coinDetailModal').classList.remove('active')">Ã—</div>
                
                <div style="text-align: center; margin-bottom: 30px;">
                    <h1 style="font-size: 2.5em; color: #ffd700; margin-bottom: 10px;">${coin}</h1>
                    <div style="font-size: 1.5em; color: #4ecdc4; font-weight: bold;">
                        $${formatPrice(priceData.price)}
                    </div>
                    <div style="font-size: 1.1em; color: ${priceData.change >= 0 ? '#4ecdc4' : '#ff6b6b'}; margin-top: 5px;">
                        ${priceData.change >= 0 ? 'â–²' : 'â–¼'} ${Math.abs(priceData.change).toFixed(2)}%
                    </div>
                </div>

                <!-- MASTER SÄ°NYAL -->
                <div class="detail-section" style="border-left-color: ${signal === 'long' ? '#4ecdc4' : signal === 'short' ? '#ff6b6b' : '#ffd700'};">
                    <div class="detail-title">${texts.masterSignal}</div>
                    <div style="text-align: center; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 12px;">
                        <div style="font-size: 2.5em; font-weight: bold; color: ${signal === 'long' ? '#4ecdc4' : signal === 'short' ? '#ff6b6b' : '#ffd700'}; margin-bottom: 10px;">
                            ${signal === 'long' ? 'ðŸŸ¢ LONG' : signal === 'short' ? 'ðŸ”´ SHORT' : 'âšª BEKLE'}
                        </div>
                        <div style="font-size: 1.5em; color: #ffd700;">Skor: ${score}/100</div>
                        <div style="margin-top: 15px; font-size: 1.1em; color: #aaa;">
                            ${lang === 'de' ? 
                                `Empfehlung: <strong style="color: ${signal === 'long' ? '#4ecdc4' : signal === 'short' ? '#ff6b6b' : '#ffd700'}">${signal === 'long' ? 'LONG Position empfohlen' : signal === 'short' ? 'SHORT Position empfohlen' : 'Warten auf bessere Einstiegspunkte'}</strong>` :
                                `Ã–neri: <strong style="color: ${signal === 'long' ? '#4ecdc4' : signal === 'short' ? '#ff6b6b' : '#ffd700'}">${signal === 'long' ? 'LONG pozisyon Ã¶nerilir' : signal === 'short' ? 'SHORT pozisyon Ã¶nerilir' : 'Daha iyi giriÅŸ noktalarÄ± iÃ§in bekleyin'}</strong>`
                            }
                        </div>
                    </div>
                </div>

                <!-- TRADE SEVÄ°YELERÄ° -->
                <div class="detail-section">
                    <div class="detail-title">ðŸ“‹ ${texts.entry} / ${texts.takeProfit} / ${texts.stopLoss}</div>
                    ${tradeLevels.map(level => `
                        <div class="trade-level ${level.type}-level">
                            <div>
                                <div style="font-weight: bold; color: ${level.color}; font-size: 1.2em;">${level.label}</div>
                                <div style="color: #aaa; font-size: 0.9em; margin-top: 5px;">${level.description}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 1.5em; font-weight: bold; color: ${level.color};">$${formatPrice(level.price)}</div>
                                <div style="font-size: 0.9em; color: #aaa;">${level.distance}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>

                <!-- FÄ°BONACCÄ° SEVÄ°YELERÄ° -->
                <div class="detail-section">
                    <div class="detail-title">ðŸ“ ${texts.fibonacci}</div>
                    <div class="fibonacci-levels">
                        ${fibLevels.map(fib => `
                            <div class="fib-level fib-${fib.level}">
                                <div style="font-weight: bold; color: ${fib.color}; font-size: 1.1em; margin-bottom: 5px;">
                                    ${fib.level}% - ${fib.name}
                                </div>
                                <div style="font-size: 1.3em; font-weight: bold; color: #fff; margin-bottom: 5px;">
                                    $${formatPrice(fib.price)}
                                </div>
                                <div style="font-size: 0.85em; color: #aaa;">
                                    ${fib.description}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Ä°NDÄ°KATÃ–R Ã–ZETÄ° -->
                <div class="detail-section">
                    <div class="detail-title">ðŸ“Š ${texts.indicators}</div>
                    <div class="indicator-summary-grid">
                        <div class="indicator-summary-card summary-long">
                            <div style="font-size: 1.2em; color: #4ecdc4; margin-bottom: 10px;">ðŸŸ¢ LONG</div>
                            <div class="summary-number" style="color: #4ecdc4;">${indicatorSummary.long}</div>
                            <div class="summary-label">Ä°ndikatÃ¶r LONG Sinyali Veriyor</div>
                            <div style="margin-top: 10px; max-height: 200px; overflow-y: auto; font-size: 0.85em; color: #aaa; padding: 10px; background: rgba(78, 205, 196, 0.05); border-radius: 8px;">
                                ${indicatorSummary.longDetails.length > 0 ? 
                                    indicatorSummary.longDetails.map(ind => `<div style="margin: 5px 0; padding: 5px; background: rgba(78, 205, 196, 0.1); border-radius: 5px; border-left: 3px solid #4ecdc4;">âœ“ ${ind}</div>`).join('') 
                                    : '<div style="color: #666;">Detay yok</div>'}
                            </div>
                        </div>
                        <div class="indicator-summary-card summary-neutral">
                            <div style="font-size: 1.2em; color: #ffd700; margin-bottom: 10px;">âšª KARARSIZ</div>
                            <div class="summary-number" style="color: #ffd700;">${indicatorSummary.neutral}</div>
                            <div class="summary-label">Ä°ndikatÃ¶r KararsÄ±z</div>
                            <div style="margin-top: 10px; max-height: 200px; overflow-y: auto; font-size: 0.85em; color: #aaa; padding: 10px; background: rgba(255, 215, 0, 0.05); border-radius: 8px;">
                                ${indicatorSummary.neutralDetails.length > 0 ? 
                                    indicatorSummary.neutralDetails.map(ind => `<div style="margin: 5px 0; padding: 5px; background: rgba(255, 215, 0, 0.1); border-radius: 5px; border-left: 3px solid #ffd700;">â—‹ ${ind}</div>`).join('') 
                                    : '<div style="color: #666;">Detay yok</div>'}
                            </div>
                        </div>
                        <div class="indicator-summary-card summary-short">
                            <div style="font-size: 1.2em; color: #ff6b6b; margin-bottom: 10px;">ðŸ”´ SHORT</div>
                            <div class="summary-number" style="color: #ff6b6b;">${indicatorSummary.short}</div>
                            <div class="summary-label">Ä°ndikatÃ¶r SHORT Sinyali Veriyor</div>
                            <div style="margin-top: 10px; max-height: 200px; overflow-y: auto; font-size: 0.85em; color: #aaa; padding: 10px; background: rgba(255, 107, 107, 0.05); border-radius: 8px;">
                                ${indicatorSummary.shortDetails.length > 0 ? 
                                    indicatorSummary.shortDetails.map(ind => `<div style="margin: 5px 0; padding: 5px; background: rgba(255, 107, 107, 0.1); border-radius: 5px; border-left: 3px solid #ff6b6b;">âœ— ${ind}</div>`).join('') 
                                    : '<div style="color: #666;">Detay yok</div>'}
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                        <div style="color: #ffd700; font-weight: bold; margin-bottom: 10px;">ðŸ“ˆ TOPLAM: ${indicatorSummary.total} Premium Ä°ndikatÃ¶r Analiz Edildi</div>
                        <div style="color: #aaa; font-size: 0.85em; margin-bottom: 10px;">âœ¨ Gereksiz tekrarlar Ã§Ä±karÄ±ldÄ±, sadece en gÃ¼venilir ve etkili indikatÃ¶rler kullanÄ±lÄ±yor</div>
                        <div style="margin-top: 10px; font-size: 0.9em; color: #aaa;">
                            <strong>DetaylÄ± Ä°ndikatÃ¶r Listesi:</strong><br>
                            <div style="margin-top: 10px; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px; max-height: 300px; overflow-y: auto;">
                                ${indicatorSummary.longDetails.length + indicatorSummary.neutralDetails.length + indicatorSummary.shortDetails.length > 0 ?
                                    `<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px;">
                                        <div>
                                            <div style="color: #4ecdc4; font-weight: bold; margin-bottom: 5px;">ðŸŸ¢ LONG (${indicatorSummary.longDetails.length}):</div>
                                            ${indicatorSummary.longDetails.map(ind => `<div style="font-size: 0.8em; margin: 3px 0; padding: 3px 8px; background: rgba(78, 205, 196, 0.1); border-radius: 4px; border-left: 2px solid #4ecdc4;">${ind}</div>`).join('')}
                                        </div>
                                        <div>
                                            <div style="color: #ffd700; font-weight: bold; margin-bottom: 5px;">âšª NEUTRAL (${indicatorSummary.neutralDetails.length}):</div>
                                            ${indicatorSummary.neutralDetails.map(ind => `<div style="font-size: 0.8em; margin: 3px 0; padding: 3px 8px; background: rgba(255, 215, 0, 0.1); border-radius: 4px; border-left: 2px solid #ffd700;">${ind}</div>`).join('')}
                                        </div>
                                        <div>
                                            <div style="color: #ff6b6b; font-weight: bold; margin-bottom: 5px;">ðŸ”´ SHORT (${indicatorSummary.shortDetails.length}):</div>
                                            ${indicatorSummary.shortDetails.map(ind => `<div style="font-size: 0.8em; margin: 3px 0; padding: 3px 8px; background: rgba(255, 107, 107, 0.1); border-radius: 4px; border-left: 2px solid #ff6b6b;">${ind}</div>`).join('')}
                                        </div>
                                    </div>` 
                                    : '<div style="color: #666;">Ä°ndikatÃ¶r detaylarÄ± henÃ¼z hesaplanmadÄ±</div>'}
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <div style="flex: 1; text-align: center; padding: 10px; background: rgba(78, 205, 196, 0.1); border-radius: 8px;">
                                <div style="color: #4ecdc4; font-size: 1.5em; font-weight: bold;">${((indicatorSummary.long / indicatorSummary.total) * 100).toFixed(1)}%</div>
                                <div style="color: #aaa; font-size: 0.9em;">LONG OranÄ±</div>
                            </div>
                            <div style="flex: 1; text-align: center; padding: 10px; background: rgba(255, 215, 0, 0.1); border-radius: 8px;">
                                <div style="color: #ffd700; font-size: 1.5em; font-weight: bold;">${((indicatorSummary.neutral / indicatorSummary.total) * 100).toFixed(1)}%</div>
                                <div style="color: #aaa; font-size: 0.9em;">KararsÄ±z OranÄ±</div>
                            </div>
                            <div style="flex: 1; text-align: center; padding: 10px; background: rgba(255, 107, 107, 0.1); border-radius: 8px;">
                                <div style="color: #ff6b6b; font-size: 1.5em; font-weight: bold;">${((indicatorSummary.short / indicatorSummary.total) * 100).toFixed(1)}%</div>
                                <div style="color: #aaa; font-size: 0.9em;">SHORT OranÄ±</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- KURUMSAL, BALÄ°NA, MARKET MAKER, TRADER ANALÄ°ZLERÄ° -->
                ${indicators?.institutional ? `
                <div class="detail-section" style="border-left-color: #4ecdc4;">
                    <div class="detail-title">ðŸ¢ ${texts.institutional}</div>
                    ${generateInstitutionalDetailHTML(indicators.institutional, lang)}
                </div>
                ` : ''}

                ${indicators?.whales ? `
                <div class="detail-section" style="border-left-color: #9b59b6;">
                    <div class="detail-title">ðŸ‹ ${texts.whales}</div>
                    ${generateWhaleDetailHTML(indicators.whales, lang)}
                </div>
                ` : ''}

                ${indicators?.marketMakers ? `
                <div class="detail-section" style="border-left-color: #ff9500;">
                    <div class="detail-title">ðŸ¦ ${texts.marketMakers}</div>
                    ${generateMarketMakerDetailHTML(indicators.marketMakers, lang)}
                </div>
                ` : ''}

                ${indicators?.traders ? `
                <div class="detail-section" style="border-left-color: #667eea;">
                    <div class="detail-title">ðŸ‘¥ ${texts.traders}</div>
                    ${generateTraderDetailHTML(indicators.traders, lang)}
                </div>
                ` : ''}

                <!-- LÄ°KÄ°DASYON SEVÄ°YELERÄ° -->
                <div class="detail-section" style="border-left-color: #ff6b6b;">
                    <div class="detail-title">âš ï¸ ${texts.liquidation}</div>
                    ${generateLiquidationHTML(coin, priceData.price)}
                </div>

                <!-- AI ANALÄ°Z BUTONU -->
                <div class="detail-section" style="border-left-color: #ffd700;">
                    <div class="detail-title">ðŸ¤– GROQ AI - ${texts.aiAnalysis}</div>
                    <div style="text-align: center; padding: 30px;">
                        <button onclick="analyzeCoinWithAIComprehensive('${coin}')" 
                                id="modal-ai-button-${coin.replace('/', '-')}"
                                style="width: 100%; max-width: 500px; padding: 25px; 
                                       background: linear-gradient(45deg, #4ecdc4, #44a08d); 
                                       border: none; border-radius: 15px; cursor: pointer; 
                                       font-weight: bold; font-size: 1.3em; color: #fff; 
                                       box-shadow: 0 4px 20px rgba(78, 205, 196, 0.4);
                                       transition: all 0.3s;">
                            ðŸ¤– GROQ AI - Genel Piyasa Analizi BaÅŸlat
                        </button>
                        <div id="modal-ai-loading-${coin.replace('/', '-')}" style="display: none; margin-top: 20px;">
                            <div style="color: #ffd700; font-size: 1.1em;">â³ AI analiz ediyor (haberler, piyasa, mumlar, her ÅŸey)...</div>
                        </div>
                        <div id="modal-ai-result-${coin.replace('/', '-')}" style="display: none; margin-top: 20px; text-align: left; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 15px;"></div>
                    </div>
                </div>
            `;
            
            // Modal dÄ±ÅŸÄ±na tÄ±klanÄ±nca kapat
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
        }

        // ===== FÄ°BONACCÄ° SEVÄ°YELERÄ° HESAPLAMA =====
        function calculateFibonacciLevels(coin, currentPrice) {
            // Son 100 mumdan high ve low bul
            const symbol = coin.replace('/USDT', 'USDT');
            // GerÃ§ek veriler iÃ§in API'den al, ÅŸimdilik tahmin
            const recentHigh = currentPrice * 1.15; // %15 yukarÄ±
            const recentLow = currentPrice * 0.85;   // %15 aÅŸaÄŸÄ±
            const range = recentHigh - recentLow;
            
            const fibLevels = [
                { level: '236', name: 'Fib 23.6%', price: recentHigh - (range * 0.236), color: '#ff6b6b', description: 'Ä°lk geri Ã§ekilme seviyesi - GÃ¼Ã§lÃ¼ destek/direnÃ§' },
                { level: '382', name: 'Fib 38.2%', price: recentHigh - (range * 0.382), color: '#ff9500', description: 'Orta seviye geri Ã§ekilme - Ã–nemli seviye' },
                { level: '500', name: 'Fib 50.0%', price: recentHigh - (range * 0.500), color: '#ffd700', description: 'Merkez seviye - Ã‡ok gÃ¼Ã§lÃ¼ destek/direnÃ§' },
                { level: '618', name: 'Fib 61.8%', price: recentHigh - (range * 0.618), color: '#4ecdc4', description: 'AltÄ±n oran - En Ã¶nemli Fibonacci seviyesi' },
                { level: '786', name: 'Fib 78.6%', price: recentHigh - (range * 0.786), color: '#9b59b6', description: 'Son geri Ã§ekilme seviyesi - Kritik' }
            ];
            
            return fibLevels;
        }

        // ===== Ä°NDÄ°KATÃ–R Ã–ZETÄ° HESAPLAMA (OPTÄ°MÄ°ZE EDÄ°LMÄ°Åž) =====
        function calculateIndicatorSummary(indicators) {
            if (!indicators) {
                return { long: 0, neutral: 0, short: 0, total: 50, longDetails: [], neutralDetails: [], shortDetails: [] };
            }
            
            let long = 0, neutral = 0, short = 0;
            const longDetails = [], neutralDetails = [], shortDetails = [];
            
            // 90 Ä°ndikatÃ¶r Ã¶zeti varsa Ã–NCE onu kullan (en Ã¶nemli)
            if (indicators.indicators90) {
                const bullCount = indicators.indicators90.bull || 0;
                const bearCount = indicators.indicators90.bear || 0;
                const neutralCount = indicators.indicators90.neutral || 0;
                
                long += bullCount;
                short += bearCount;
                neutral += neutralCount;
                
                // 90 indikatÃ¶rÃ¼n detaylarÄ±nÄ± ekle (indicatorDetails varsa)
                if (indicators.indicators90.indicatorDetails) {
                    longDetails.push(...indicators.indicators90.indicatorDetails.long);
                    shortDetails.push(...indicators.indicators90.indicatorDetails.short);
                    neutralDetails.push(...indicators.indicators90.indicatorDetails.neutral);
                }
                if (indicators.indicators90.scores) {
                    if (indicators.indicators90.scores.trend) {
                        longDetails.push(`Trend: ${indicators.indicators90.scores.trend.bull || 0} Bull`);
                        shortDetails.push(`Trend: ${indicators.indicators90.scores.trend.bear || 0} Bear`);
                    }
                    if (indicators.indicators90.scores.momentum) {
                        longDetails.push(`Momentum: ${indicators.indicators90.scores.momentum.bull || 0} Bull`);
                        shortDetails.push(`Momentum: ${indicators.indicators90.scores.momentum.bear || 0} Bear`);
                    }
                    if (indicators.indicators90.scores.volume) {
                        longDetails.push(`Volume: ${indicators.indicators90.scores.volume.bull || 0} Bull`);
                        shortDetails.push(`Volume: ${indicators.indicators90.scores.volume.bear || 0} Bear`);
                    }
                    if (indicators.indicators90.scores.volatility) {
                        longDetails.push(`Volatility: ${indicators.indicators90.scores.volatility.bull || 0} Bull`);
                        shortDetails.push(`Volatility: ${indicators.indicators90.scores.volatility.bear || 0} Bear`);
                    }
                    if (indicators.indicators90.scores.institutional) {
                        longDetails.push(`Institutional: ${indicators.indicators90.scores.institutional.bull || 0} Bull`);
                        shortDetails.push(`Institutional: ${indicators.indicators90.scores.institutional.bear || 0} Bear`);
                    }
                }
                
                // Toplam premium indikatÃ¶rlerden Ã§Ä±kan neutral
                const totalPremium = bullCount + bearCount + neutralCount;
                
                // EÄŸer premium indikatÃ¶rler varsa, diÄŸer analizleri de ekle ama toplam 50+ gÃ¼venilir indikatÃ¶r
                const remainingNeeded = 50 - totalPremium;
                
                // RSI (1 indikatÃ¶r)
                if (indicators.rsi !== undefined && remainingNeeded > 0) {
                    if (indicators.rsi < 30) { long++; longDetails.push('RSI Oversold'); }
                    else if (indicators.rsi > 70) { short++; shortDetails.push('RSI Overbought'); }
                    else { neutral++; neutralDetails.push('RSI Neutral'); }
                }
                
                // MACD (2 indikatÃ¶r - MACD ve Histogram)
                if (indicators.macd !== undefined && indicators.macdSignal !== undefined && remainingNeeded > 0) {
                    if (indicators.macd > indicators.macdSignal && indicators.macdHistogram > 0) { 
                        long++; longDetails.push('MACD Bullish'); 
                    } else if (indicators.macd < indicators.macdSignal && indicators.macdHistogram < 0) { 
                        short++; shortDetails.push('MACD Bearish'); 
                    } else { 
                        neutral++; neutralDetails.push('MACD Neutral'); 
                    }
                }
                
                // Stochastic (2 indikatÃ¶r)
                if (indicators.stochastic !== undefined && remainingNeeded > 0) {
                    if (indicators.stochastic < 20) { long++; longDetails.push('Stochastic Oversold'); }
                    else if (indicators.stochastic > 80) { short++; shortDetails.push('Stochastic Overbought'); }
                    else { neutral++; neutralDetails.push('Stochastic Neutral'); }
                }
                
                // ADX
                if (indicators.adx !== undefined && remainingNeeded > 0) {
                    if (indicators.adx > 25 && indicators.trend === 'UP') { long++; longDetails.push('ADX Strong UP'); }
                    else if (indicators.adx > 25 && indicators.trend === 'DOWN') { short++; shortDetails.push('ADX Strong DOWN'); }
                    else { neutral++; neutralDetails.push('ADX Weak'); }
                }
                
                // CVD
                if (indicators.cvdTrend && remainingNeeded > 0) {
                    if (indicators.cvdTrend === 'BULLISH') { long++; longDetails.push('CVD Bullish'); }
                    else if (indicators.cvdTrend === 'BEARISH') { short++; shortDetails.push('CVD Bearish'); }
                    else { neutral++; neutralDetails.push('CVD Neutral'); }
                }
                
                // Volume
                if (indicators.volumeRatio !== undefined && remainingNeeded > 0) {
                    if (indicators.volumeRatio > 1.5) { long++; longDetails.push('High Volume'); }
                    else if (indicators.volumeRatio < 0.5) { short++; shortDetails.push('Low Volume'); }
                    else { neutral++; neutralDetails.push('Normal Volume'); }
                }
            } else {
                // 90 indikatÃ¶r yoksa, mevcut indikatÃ¶rleri detaylÄ± say
                // RSI
                if (indicators.rsi !== undefined) {
                    if (indicators.rsi < 30) { long++; longDetails.push('RSI Oversold'); }
                    else if (indicators.rsi > 70) { short++; shortDetails.push('RSI Overbought'); }
                    else { neutral++; neutralDetails.push('RSI Neutral'); }
                }
                
                // MACD
                if (indicators.macd !== undefined && indicators.macdSignal !== undefined) {
                    if (indicators.macd > indicators.macdSignal && indicators.macdHistogram > 0) { 
                        long++; longDetails.push('MACD Bullish'); 
                    } else if (indicators.macd < indicators.macdSignal && indicators.macdHistogram < 0) { 
                        short++; shortDetails.push('MACD Bearish'); 
                    } else { 
                        neutral++; neutralDetails.push('MACD Neutral'); 
                    }
                }
                
                // EMA Trend
                if (indicators.ema9 !== undefined && indicators.ema21 !== undefined) {
                    if (indicators.ema9 > indicators.ema21) { long++; longDetails.push('EMA 9>21'); }
                    else { short++; shortDetails.push('EMA 9<21'); }
                }
                
                if (indicators.ema21 !== undefined && indicators.ema50 !== undefined) {
                    if (indicators.ema21 > indicators.ema50) { long++; longDetails.push('EMA 21>50'); }
                    else { short++; shortDetails.push('EMA 21<50'); }
                }
                
                // Bollinger Bands
                if (indicators.bbLower !== undefined && indicators.bbUpper !== undefined) {
                    neutral++; neutralDetails.push('BB Analiz');
                }
                
                // Stochastic
                if (indicators.stochastic !== undefined) {
                    if (indicators.stochastic < 20) { long++; longDetails.push('Stochastic Oversold'); }
                    else if (indicators.stochastic > 80) { short++; shortDetails.push('Stochastic Overbought'); }
                    else { neutral++; neutralDetails.push('Stochastic Neutral'); }
                }
                
                // ADX
                if (indicators.adx !== undefined) {
                    if (indicators.adx > 25 && indicators.trend === 'UP') { long++; longDetails.push('ADX Strong UP'); }
                    else if (indicators.adx > 25 && indicators.trend === 'DOWN') { short++; shortDetails.push('ADX Strong DOWN'); }
                    else { neutral++; neutralDetails.push('ADX Weak'); }
                }
                
                // CVD
                if (indicators.cvdTrend) {
                    if (indicators.cvdTrend === 'BULLISH') { long++; longDetails.push('CVD Bullish'); }
                    else if (indicators.cvdTrend === 'BEARISH') { short++; shortDetails.push('CVD Bearish'); }
                    else { neutral++; neutralDetails.push('CVD Neutral'); }
                }
                
                // Volume
                if (indicators.volumeRatio !== undefined) {
                    if (indicators.volumeRatio > 1.5) { long++; longDetails.push('High Volume'); }
                    else if (indicators.volumeRatio < 0.5) { short++; shortDetails.push('Low Volume'); }
                    else { neutral++; neutralDetails.push('Normal Volume'); }
                }
            }
            
            // Toplam: Optimize edilmiÅŸ premium indikatÃ¶r sayÄ±sÄ± (50+ en gÃ¼venilir indikatÃ¶r)
            const total = Math.max(50, long + neutral + short);
            
            return { long, neutral, short, total, longDetails, neutralDetails, shortDetails };
        }

        // ===== DÄ°NAMÄ°K FÄ°YAT FORMATLAMA FONKSÄ°YONU =====
        function formatPrice(price) {
            if (!price || isNaN(price) || price <= 0) return '0.00';
            
            // Fiyat deÄŸerine gÃ¶re uygun ondalÄ±k basamak sayÄ±sÄ±nÄ± belirle
            if (price >= 1) {
                return price.toFixed(2);
            } else if (price >= 0.1) {
                return price.toFixed(3);
            } else if (price >= 0.01) {
                return price.toFixed(4);
            } else if (price >= 0.001) {
                return price.toFixed(5);
            } else if (price >= 0.0001) {
                return price.toFixed(6);
            } else if (price >= 0.00001) {
                return price.toFixed(7);
            } else {
                return price.toFixed(8);
            }
        }

        // ===== TRADE SEVÄ°YELERÄ° HESAPLAMA =====
        function calculateTradeLevels(coin, priceData, signal, indicators) {
            const entry = priceData.price;
            
            // ATR'yi doÄŸru hesapla - array ise son deÄŸeri al, deÄŸilse hesapla
            let atr = entry * 0.02; // VarsayÄ±lan %2
            if (indicators?.atr) {
                if (Array.isArray(indicators.atr) && indicators.atr.length > 0) {
                    atr = indicators.atr[indicators.atr.length - 1];
                } else if (typeof indicators.atr === 'number') {
                    atr = indicators.atr;
                }
            }
            
            // ATR Ã§ok kÃ¼Ã§Ã¼k veya Ã§ok bÃ¼yÃ¼kse mantÄ±klÄ± bir deÄŸere ayarla
            if (atr < entry * 0.005) atr = entry * 0.01; // Minimum %1
            if (atr > entry * 0.1) atr = entry * 0.05;   // Maximum %5
            
            const lang = currentLanguage === 'de' ? 'de' : 'tr';
            
            const levels = [];
            
            // GiriÅŸ seviyesi
            levels.push({
                type: 'entry',
                label: lang === 'de' ? 'Eintritt' : 'GiriÅŸ Seviyesi',
                price: entry,
                color: '#4ecdc4',
                distance: lang === 'de' ? 'Aktueller Preis' : 'Mevcut Fiyat',
                description: lang === 'de' ? 
                    'Ideal Einstiegspunkt fÃ¼r die Position' : 
                    'Pozisyon iÃ§in ideal giriÅŸ seviyesi'
            });
            
            if (signal === 'long') {
                // LONG pozisyon seviyeleri
                levels.push({
                    type: 'tp',
                    label: lang === 'de' ? 'Take Profit 1' : 'Take Profit 1',
                    price: entry + (atr * 1.0),
                    color: '#4ecdc4',
                    distance: `+${((atr * 1.0 / entry) * 100).toFixed(2)}%`,
                    description: lang === 'de' ? 
                        'Erste Gewinnmitnahme - %50 pozisyon kapat' : 
                        'Ä°lk kar alma - Pozisyonun %50\'sini kapat'
                });
                levels.push({
                    type: 'tp',
                    label: lang === 'de' ? 'Take Profit 2' : 'Take Profit 2',
                    price: entry + (atr * 2.0),
                    color: '#4ecdc4',
                    distance: `+${((atr * 2.0 / entry) * 100).toFixed(2)}%`,
                    description: lang === 'de' ? 
                        'Zweite Gewinnmitnahme - %30 pozisyon kapat' : 
                        'Ä°kinci kar alma - Pozisyonun %30\'unu kapat'
                });
                levels.push({
                    type: 'tp',
                    label: lang === 'de' ? 'Take Profit 3' : 'Take Profit 3',
                    price: entry + (atr * 3.0),
                    color: '#4ecdc4',
                    distance: `+${((atr * 3.0 / entry) * 100).toFixed(2)}%`,
                    description: lang === 'de' ? 
                        'Finale Gewinnmitnahme - %20 pozisyon kapat' : 
                        'Son kar alma - Pozisyonun %20\'sini kapat'
                });
                levels.push({
                    type: 'sl',
                    label: lang === 'de' ? 'Stop Loss' : 'Stop Loss',
                    price: entry - (atr * 1.5),
                    color: '#ff6b6b',
                    distance: `-${((atr * 1.5 / entry) * 100).toFixed(2)}%`,
                    description: lang === 'de' ? 
                        'Risikomanagement - TÃ¼m pozisyonu kapat' : 
                        'Risk yÃ¶netimi - TÃ¼m pozisyonu kapat'
                });
            } else if (signal === 'short') {
                // SHORT pozisyon seviyeleri
                levels.push({
                    type: 'tp',
                    label: lang === 'de' ? 'Take Profit 1' : 'Take Profit 1',
                    price: entry - (atr * 1.0),
                    color: '#4ecdc4',
                    distance: `-${((atr * 1.0 / entry) * 100).toFixed(2)}%`,
                    description: lang === 'de' ? 
                        'Erste Gewinnmitnahme - %50 pozisyon kapat' : 
                        'Ä°lk kar alma - Pozisyonun %50\'sini kapat'
                });
                levels.push({
                    type: 'tp',
                    label: lang === 'de' ? 'Take Profit 2' : 'Take Profit 2',
                    price: entry - (atr * 2.0),
                    color: '#4ecdc4',
                    distance: `-${((atr * 2.0 / entry) * 100).toFixed(2)}%`,
                    description: lang === 'de' ? 
                        'Zweite Gewinnmitnahme - %30 pozisyon kapat' : 
                        'Ä°kinci kar alma - Pozisyonun %30\'unu kapat'
                });
                levels.push({
                    type: 'tp',
                    label: lang === 'de' ? 'Take Profit 3' : 'Take Profit 3',
                    price: entry - (atr * 3.0),
                    color: '#4ecdc4',
                    distance: `-${((atr * 3.0 / entry) * 100).toFixed(2)}%`,
                    description: lang === 'de' ? 
                        'Finale Gewinnmitnahme - %20 pozisyon kapat' : 
                        'Son kar alma - Pozisyonun %20\'sini kapat'
                });
                levels.push({
                    type: 'sl',
                    label: lang === 'de' ? 'Stop Loss' : 'Stop Loss',
                    price: entry + (atr * 1.5),
                    color: '#ff6b6b',
                    distance: `+${((atr * 1.5 / entry) * 100).toFixed(2)}%`,
                    description: lang === 'de' ? 
                        'Risikomanagement - TÃ¼m pozisyonu kapat' : 
                        'Risk yÃ¶netimi - TÃ¼m pozisyonu kapat'
                });
            }
            
            return levels;
        }

        // ===== DETAY HTML GENERATÃ–RLERÄ° =====
        function generateInstitutionalDetailHTML(institutional, lang) {
            return `
                <div style="padding: 15px; background: rgba(78, 205, 196, 0.1); border-radius: 10px; margin-bottom: 15px;">
                    <div style="color: #4ecdc4; font-weight: bold; margin-bottom: 10px;">ðŸ¢ Dark Pool AktivitÃ¤t</div>
                    <div style="color: #fff; font-size: 1.2em; margin-bottom: 5px;">${institutional.darkPool?.status || 'N/A'}</div>
                    <div style="color: #aaa; font-size: 0.9em;">${lang === 'de' ? 'Block Trades:' : 'Blok Ä°ÅŸlemler:'} ${institutional.darkPool?.blocks || 0}</div>
                </div>
                <div style="padding: 15px; background: rgba(78, 205, 196, 0.1); border-radius: 10px;">
                    <div style="color: #4ecdc4; font-weight: bold; margin-bottom: 10px;">ðŸ“Š Order Flow</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div style="background: rgba(78, 205, 196, 0.2); padding: 10px; border-radius: 8px;">
                            <div style="color: #4ecdc4; font-size: 0.9em;">ðŸŸ¢ ${lang === 'de' ? 'Kaufdruck' : 'AlÄ±m BaskÄ±sÄ±'}</div>
                            <div style="color: #fff; font-size: 1.1em; font-weight: bold;">${institutional.orderFlow?.buyPressure || 'N/A'}</div>
                        </div>
                        <div style="background: rgba(255, 107, 107, 0.2); padding: 10px; border-radius: 8px;">
                            <div style="color: #ff6b6b; font-size: 0.9em;">ðŸ”´ ${lang === 'de' ? 'Verkaufsdruck' : 'SatÄ±ÅŸ BaskÄ±sÄ±'}</div>
                            <div style="color: #fff; font-size: 1.1em; font-weight: bold;">${institutional.orderFlow?.sellPressure || 'N/A'}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateWhaleDetailHTML(whales, lang) {
            return `
                <div style="padding: 15px; background: rgba(155, 89, 182, 0.1); border-radius: 10px; margin-bottom: 15px;">
                    <div style="color: #9b59b6; font-weight: bold; margin-bottom: 10px;">ðŸ‹ ${lang === 'de' ? 'WalaktivitÃ¤t' : 'Balina Aktivitesi'}</div>
                    <div style="color: #fff; font-size: 1.2em; margin-bottom: 5px;">${whales.activity?.status || 'N/A'}</div>
                    <div style="color: #aaa; font-size: 0.9em;">${lang === 'de' ? 'Gesamt AuftrÃ¤ge:' : 'Toplam SipariÅŸler:'} ${whales.activity?.total || 0}</div>
                </div>
                <div style="padding: 15px; background: rgba(155, 89, 182, 0.1); border-radius: 10px;">
                    <div style="color: #9b59b6; font-weight: bold; margin-bottom: 10px;">ðŸ’° ${lang === 'de' ? 'Sentiment' : 'Sentiment'}</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div style="background: rgba(78, 205, 196, 0.2); padding: 10px; border-radius: 8px;">
                            <div style="color: #4ecdc4; font-size: 0.9em;">ðŸ“ˆ ${lang === 'de' ? 'Akkumulation' : 'Birikim'}</div>
                            <div style="color: #fff; font-size: 1.1em; font-weight: bold;">${whales.sentiment?.accumulation || '0'}%</div>
                        </div>
                        <div style="background: rgba(255, 107, 107, 0.2); padding: 10px; border-radius: 8px;">
                            <div style="color: #ff6b6b; font-size: 0.9em;">ðŸ“‰ ${lang === 'de' ? 'Distribution' : 'DaÄŸÄ±tÄ±m'}</div>
                            <div style="color: #fff; font-size: 1.1em; font-weight: bold;">${whales.sentiment?.distribution || '0'}%</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateMarketMakerDetailHTML(marketMakers, lang) {
            return `
                <div style="padding: 15px; background: rgba(255, 149, 0, 0.1); border-radius: 10px; margin-bottom: 15px;">
                    <div style="color: #ff9500; font-weight: bold; margin-bottom: 10px;">ðŸ“Š ${lang === 'de' ? 'Wyckoff Phase' : 'Wyckoff FazÄ±'}</div>
                    <div style="color: #fff; font-size: 1.2em; margin-bottom: 5px;">${marketMakers.wyckoff?.phase || 'N/A'}</div>
                    <div style="color: #aaa; font-size: 0.9em;">${lang === 'de' ? 'Position:' : 'Pozisyon:'} ${marketMakers.wyckoff?.position || '0'}%</div>
                </div>
                <div style="padding: 15px; background: rgba(255, 149, 0, 0.1); border-radius: 10px;">
                    <div style="color: #ff9500; font-weight: bold; margin-bottom: 10px;">ðŸ“ˆ CVD Trend</div>
                    <div style="color: #fff; font-size: 1.1em;">${marketMakers.cvd?.trend || 'N/A'}</div>
                    <div style="color: #aaa; font-size: 0.9em; margin-top: 5px;">${lang === 'de' ? 'Wert:' : 'DeÄŸer:'} ${marketMakers.cvd?.value || '0'}</div>
                </div>
            `;
        }

        function generateTraderDetailHTML(traders, lang) {
            return `
                <div style="padding: 15px; background: rgba(103, 126, 234, 0.1); border-radius: 10px;">
                    <div style="color: #667eea; font-weight: bold; margin-bottom: 10px;">ðŸ“Š ${lang === 'de' ? 'Volume Verteilung' : 'Volume DaÄŸÄ±lÄ±mÄ±'}</div>
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="color: #ff9500;">ðŸ‘¤ ${lang === 'de' ? 'Retail' : 'Retail'}</span>
                            <span style="color: #fff; font-weight: bold;">${traders.retailRatio || '0'}%</span>
                        </div>
                        <div style="background: rgba(255, 149, 0, 0.2); border-radius: 8px; overflow: hidden; height: 20px;">
                            <div style="height: 100%; background: #ff9500; width: ${traders.retailRatio || 0}%;"></div>
                        </div>
                    </div>
                    <div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="color: #4ecdc4;">ðŸ¢ ${lang === 'de' ? 'Institutional' : 'Kurumsal'}</span>
                            <span style="color: #fff; font-weight: bold;">${traders.ratio || '0'}%</span>
                        </div>
                        <div style="background: rgba(78, 205, 196, 0.2); border-radius: 8px; overflow: hidden; height: 20px;">
                            <div style="height: 100%; background: #4ecdc4; width: ${traders.ratio || 0}%;"></div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ===== GELÄ°ÅžTÄ°RÄ°LMÄ°Åž AI ANALÄ°Z (HABERLER, PÄ°YASA, GENEL) =====
        async function analyzeCoinWithAIComprehensive(coin) {
            const buttonId = `modal-ai-button-${coin.replace('/', '-')}`;
            const loadingId = `modal-ai-loading-${coin.replace('/', '-')}`;
            const resultId = `modal-ai-result-${coin.replace('/', '-')}`;
            
            const button = document.getElementById(buttonId);
            const loading = document.getElementById(loadingId);
            const result = document.getElementById(resultId);
            
            if (!button || !loading || !result) return;
            
            button.disabled = true;
            button.style.opacity = '0.5';
            loading.style.display = 'block';
            result.style.display = 'none';
            
            try {
                const priceData = realPrices[coin];
                const indicators = technicalIndicators[coin];
                
                if (!priceData) {
                    throw new Error('Fiyat verisi bulunamadÄ±');
                }
                
                // GeliÅŸtirilmiÅŸ AI analizi (haberler, piyasa, mumlar, genel)
                const comprehensiveAnalysis = await getAIAnalysisComprehensive(coin, priceData, indicators);
                
                result.innerHTML = `
                    <div style="background: rgba(0,0,0,0.5); padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                        <div style="white-space: pre-wrap; line-height: 2; font-size: 1em; color: #fff; text-align: left;">
${comprehensiveAnalysis}
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                        <button onclick="sendDetailedTelegram('${coin}', ${JSON.stringify(priceData).replace(/"/g, '&quot;')}, ${JSON.stringify(indicators || {}).replace(/"/g, '&quot;')}, ${JSON.stringify(comprehensiveAnalysis).replace(/"/g, '&quot;').replace(/\n/g, '\\n')})" 
                                style="padding: 15px; background: linear-gradient(45deg, #25d366, #128c7e); 
                                       border: none; border-radius: 10px; cursor: pointer; font-weight: bold; 
                                       color: #fff; font-size: 1em;">
                            ðŸ“± Telegram'a GÃ¶nder (DetaylÄ±)
                        </button>
                        <button onclick="navigator.clipboard.writeText(\`${comprehensiveAnalysis.replace(/`/g, '\\`').replace(/\$/g, '\\$')}\`) && alert('âœ… KopyalandÄ±!')" 
                                style="padding: 15px; background: linear-gradient(45deg, #667eea, #764ba2); 
                                       border: none; border-radius: 10px; cursor: pointer; font-weight: bold; 
                                       color: #fff; font-size: 1em;">
                            ðŸ“‹ Analizi Kopyala
                        </button>
                    </div>
                `;
                
                result.style.display = 'block';
                loading.style.display = 'none';
                
            } catch (error) {
                console.error('KapsamlÄ± AI analiz hatasÄ±:', error);
                result.innerHTML = `
                    <div style="background: rgba(255, 0, 0, 0.2); padding: 20px; border-radius: 10px; color: #ff6b6b;">
                        <strong>âŒ Hata:</strong> ${error.message}<br>
                        <button onclick="analyzeCoinWithAIComprehensive('${coin}')" 
                                style="margin-top: 10px; padding: 10px 20px; background: #4ecdc4; 
                                       border: none; border-radius: 8px; cursor: pointer; font-weight: bold; color: #000;">
                            ðŸ”„ Tekrar Dene
                        </button>
                    </div>
                `;
                result.style.display = 'block';
                loading.style.display = 'none';
                button.disabled = false;
                button.style.opacity = '1';
            }
        }

        // ===== GELÄ°ÅžTÄ°RÄ°LMÄ°Åž AI ANALÄ°Z PROMPT (HABERLER, PÄ°YASA, MUM, GENEL) =====
        async function getAIAnalysisComprehensive(coin, priceData, indicators) {
            const lang = currentLanguage === 'de' ? 'de' : 'tr';
            
            // DetaylÄ± prompt oluÅŸtur
            const prompt = lang === 'de' ? `
Du bist ein professioneller Krypto-Analyst. Analysiere ${coin} UMFASSEND:

AKTUELLE SITUATION:
- Preis: $${priceData.price.toFixed(2)}
- 24h Ã„nderung: ${priceData.change.toFixed(2)}%
- Volume: ${priceData.volume?.toFixed(0) || 'N/A'}
- High 24h: $${priceData.high24h?.toFixed(2) || 'N/A'}
- Low 24h: $${priceData.low24h?.toFixed(2) || 'N/A'}

TECHNISCHE INDIKATOREN:
${indicators ? `
- RSI: ${indicators.rsi?.toFixed(1) || 'N/A'}
- MACD: ${indicators.macd?.toFixed(2) || 'N/A'} (Signal: ${indicators.macdSignal?.toFixed(2) || 'N/A'})
- EMA Trend: ${indicators.trend || 'N/A'}
- Stochastic: ${indicators.stochastic?.toFixed(1) || 'N/A'} / ${indicators.stochasticD?.toFixed(1) || 'N/A'}
- ADX: ${indicators.adx?.toFixed(1) || 'N/A'}
- CVD Trend: ${indicators.cvdTrend || 'N/A'}
- Volume Ratio: ${indicators.volumeRatio?.toFixed(2) || 'N/A'}
- Order Blocks: ${indicators.orderBlocks || 0}
- Fair Value Gaps: ${indicators.fvg || 0}
` : 'Keine Indikatoren verfÃ¼gbar'}

UMFASSENDE ANALYSE ERFORDERLICH:
1. **MARKT-UMLAGE**: Aktuelle Krypto-Markttrends, BTC-Korrelation, Gesamtmarkt-Sentiment
2. **NACHRICHTEN & FUNDAMENTALE**: Aktuelle Nachrichten, Entwicklungs-Updates, Partnerschaften, regulatorische Ã„nderungen
3. **KERZEN-ANALYSE**: Muster, Formationen, UnterstÃ¼tzung/Widerstand, Momentum
4. **VOLUMEN-ANALYSE**: UngewÃ¶hnliche Volumenbewegungen, LiquiditÃ¤tsniveaus
5. **WHALE & INSTITUTIONAL**: GroÃŸe Transaktionen, Smart Money Flow
6. **RISIKO-BEWERTUNG**: Liquidationsrisiken, VolatilitÃ¤t, technische Risiken
7. **TRADING-EMPFEHLUNG**: KLARE HANDLUNGSANWEISUNG (LONG/SHORT/WARTEN) mit BegrÃ¼ndung
8. **EINTRITTS-PUNKTE**: Spezifische Preisniveaus fÃ¼r Einstieg
9. **RISIKO-MANAGEMENT**: Stop-Loss, Take-Profit, Position Sizing

Gib eine DETAILLIERTE, PROFESSIONELLE Analyse auf DEUTSCH.
Formatiere mit Emojis fÃ¼r bessere Lesbarkeit.
` : `
Sen profesyonel bir kripto analizcisin. ${coin} coin'ini KAPSAMLI olarak analiz et:

MEVCUT DURUM:
- Fiyat: $${priceData.price.toFixed(2)}
- 24s DeÄŸiÅŸim: ${priceData.change.toFixed(2)}%
- Volume: ${priceData.volume?.toFixed(0) || 'N/A'}
- 24s YÃ¼ksek: $${priceData.high24h?.toFixed(2) || 'N/A'}
- 24s DÃ¼ÅŸÃ¼k: $${priceData.low24h?.toFixed(2) || 'N/A'}

TEKNÄ°K Ä°NDÄ°KATÃ–RLER:
${indicators ? `
- RSI: ${indicators.rsi?.toFixed(1) || 'N/A'}
- MACD: ${indicators.macd?.toFixed(2) || 'N/A'} (Signal: ${indicators.macdSignal?.toFixed(2) || 'N/A'})
- EMA Trend: ${indicators.trend || 'N/A'}
- Stochastic: ${indicators.stochastic?.toFixed(1) || 'N/A'} / ${indicators.stochasticD?.toFixed(1) || 'N/A'}
- ADX: ${indicators.adx?.toFixed(1) || 'N/A'}
- CVD Trend: ${indicators.cvdTrend || 'N/A'}
- Volume Ratio: ${indicators.volumeRatio?.toFixed(2) || 'N/A'}
- Order Blocks: ${indicators.orderBlocks || 0}
- Fair Value Gaps: ${indicators.fvg || 0}
` : 'Ä°ndikatÃ¶r verisi yok'}

KAPSAMLI ANALÄ°Z Ä°STENÄ°YOR:
1. **PÄ°YASA ANALÄ°ZÄ°**: Genel kripto piyasa trendleri, BTC korelasyonu, genel piyasa sentimenti
2. **HABERLER & FUNDAMENTALLER**: GÃ¼ncel haberler, geliÅŸtirme gÃ¼ncellemeleri, ortaklÄ±klar, dÃ¼zenlemeler
3. **MUM ANALÄ°ZÄ°**: Mum desenleri, formasyonlar, destek/direnÃ§ seviyeleri, momentum
4. **VOLUME ANALÄ°ZÄ°**: OlaÄŸandÄ±ÅŸÄ± volume hareketleri, likidite seviyeleri
5. **BALÄ°NA & KURUMSAL**: BÃ¼yÃ¼k iÅŸlemler, Smart Money akÄ±ÅŸÄ±
6. **RÄ°SK DEÄžERLENDÄ°RMESÄ°**: Likidasyon riskleri, volatilite, teknik riskler
7. **TRADÄ°NG Ã–NERÄ°SÄ°**: NET KARAR (LONG/SHORT/BEKLE) ve gerekÃ§esi
8. **GÄ°RÄ°Åž SEVÄ°YELERÄ°**: Spesifik fiyat seviyeleri iÃ§in giriÅŸ noktalarÄ±
9. **RÄ°SK YÃ–NETÄ°MÄ°**: Stop-Loss, Take-Profit, pozisyon boyutlandÄ±rma

DETAYLI, PROFESYONEL bir analiz ver. Emojiler kullanarak daha okunabilir hale getir.
`;

            try {
                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEYS.GROQ}`
                    },
                    body: JSON.stringify({
                        model: 'llama-3.3-70b-versatile',
                        messages: [
                            {
                                role: 'system',
                                content: lang === 'de' ? 
                                    'Du bist ein professioneller Krypto-Analyst mit Expertise in technischer Analyse, Fundamentalanalyse und Marktpsychologie.' :
                                    'Sen kripto piyasalarÄ±nda teknik analiz, fundamental analiz ve piyasa psikolojisi konularÄ±nda uzman bir analizcisin.'
                            },
                            {
                                role: 'user',
                                content: prompt
                            }
                        ],
                        max_tokens: 4000,
                        temperature: 0.7
                    })
                });
                
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(`Groq API hatasÄ±: ${data.error?.message || 'Bilinmeyen hata'}`);
                }
                
                return data.choices[0].message.content;
                
            } catch (error) {
                console.error('Groq API hatasÄ±:', error);
                throw error;
            }
        }

        window.addEventListener('load', showNewFeatures);

        // ===== TRADING TOOLS FONKSÄ°YONLARI =====
        
        // Position Size Calculator
        function calculatePositionSize() {
            const portfolioValue = parseFloat(document.getElementById('portfolioValue').value) || 0;
            const riskPercent = parseFloat(document.getElementById('riskPercent').value) || 0;
            const entryPrice = parseFloat(document.getElementById('entryPrice').value) || 0;
            const stopLossPrice = parseFloat(document.getElementById('stopLossPrice').value) || 0;
            const leverage = parseFloat(document.getElementById('leverage').value) || 1;
            
            if (!portfolioValue || !riskPercent || !entryPrice || !stopLossPrice) {
                document.getElementById('positionSizeResult').innerHTML = 
                    '<div style="color: #ff6b6b;">âš ï¸ LÃ¼tfen tÃ¼m alanlarÄ± doldurun!</div>';
                document.getElementById('positionSizeResult').style.display = 'block';
                return;
            }
            
            const riskAmount = portfolioValue * (riskPercent / 100);
            const priceRisk = Math.abs(entryPrice - stopLossPrice);
            const riskPerUnit = priceRisk;
            
            const positionSize = (riskAmount / riskPerUnit) * leverage;
            const positionValue = positionSize * entryPrice;
            const marginRequired = positionValue / leverage;
            
            const result = `
                <div style="color: #4ecdc4; font-weight: bold; font-size: 1.2em; margin-bottom: 15px;">ðŸ’° Position Size SonuÃ§larÄ±</div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                    <div style="padding: 15px; background: rgba(78, 205, 196, 0.1); border-radius: 8px;">
                        <div style="color: #4ecdc4; font-weight: bold; margin-bottom: 5px;">Pozisyon Boyutu</div>
                        <div style="color: #fff; font-size: 1.3em;">${positionSize.toFixed(4)}</div>
                    </div>
                    <div style="padding: 15px; background: rgba(255, 215, 0, 0.1); border-radius: 8px;">
                        <div style="color: #ffd700; font-weight: bold; margin-bottom: 5px;">Pozisyon DeÄŸeri</div>
                        <div style="color: #fff; font-size: 1.3em;">$${positionValue.toFixed(2)}</div>
                    </div>
                    <div style="padding: 15px; background: rgba(255, 107, 107, 0.1); border-radius: 8px;">
                        <div style="color: #ff6b6b; font-weight: bold; margin-bottom: 5px;">Gerekli Margin</div>
                        <div style="color: #fff; font-size: 1.3em;">$${marginRequired.toFixed(2)}</div>
                    </div>
                    <div style="padding: 15px; background: rgba(155, 89, 182, 0.1); border-radius: 8px;">
                        <div style="color: #9b59b6; font-weight: bold; margin-bottom: 5px;">Risk MiktarÄ±</div>
                        <div style="color: #fff; font-size: 1.3em;">$${riskAmount.toFixed(2)}</div>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                    <div style="color: #aaa; font-size: 0.9em;">
                        <strong>Hesaplama DetaylarÄ±:</strong><br>
                        â€¢ Risk YÃ¼zdesi: %${riskPercent} ($${riskAmount.toFixed(2)})<br>
                        â€¢ Stop Loss Mesafesi: ${priceRisk.toFixed(2)} USDT (%${((priceRisk/entryPrice)*100).toFixed(2)})<br>
                        â€¢ Leverage: ${leverage}x<br>
                        â€¢ Her bir birim baÅŸÄ±na risk: $${riskPerUnit.toFixed(2)}
                    </div>
                </div>
            `;
            
            document.getElementById('positionSizeResult').innerHTML = result;
            document.getElementById('positionSizeResult').style.display = 'block';
        }

        // Risk/Reward Calculator
        function calculateRiskReward() {
            const entry = parseFloat(document.getElementById('rrEntry').value) || 0;
            const stopLoss = parseFloat(document.getElementById('rrStopLoss').value) || 0;
            const tp1 = parseFloat(document.getElementById('rrTP1').value) || 0;
            const tp2 = parseFloat(document.getElementById('rrTP2').value) || 0;
            const positionType = document.getElementById('positionType').value;
            
            if (!entry || !stopLoss || !tp1 || !tp2) {
                document.getElementById('riskRewardResult').innerHTML = 
                    '<div style="color: #ff6b6b;">âš ï¸ LÃ¼tfen tÃ¼m alanlarÄ± doldurun!</div>';
                document.getElementById('riskRewardResult').style.display = 'block';
                return;
            }
            
            const risk = Math.abs(entry - stopLoss);
            const reward1 = positionType === 'long' ? tp1 - entry : entry - tp1;
            const reward2 = positionType === 'long' ? tp2 - entry : entry - tp2;
            
            const rr1 = reward1 / risk;
            const rr2 = reward2 / risk;
            
            const result = `
                <div style="color: #ffd700; font-weight: bold; font-size: 1.2em; margin-bottom: 15px;">ðŸ“ˆ Risk/Reward Analizi</div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                    <div style="padding: 15px; background: rgba(255, 107, 107, 0.1); border-radius: 8px;">
                        <div style="color: #ff6b6b; font-weight: bold; margin-bottom: 5px;">Risk</div>
                        <div style="color: #fff; font-size: 1.3em;">$${risk.toFixed(2)}</div>
                        <div style="color: #aaa; font-size: 0.8em;">${((risk/entry)*100).toFixed(2)}%</div>
                    </div>
                    <div style="padding: 15px; background: rgba(78, 205, 196, 0.1); border-radius: 8px;">
                        <div style="color: #4ecdc4; font-weight: bold; margin-bottom: 5px;">TP1 Reward</div>
                        <div style="color: #fff; font-size: 1.3em;">$${reward1.toFixed(2)}</div>
                        <div style="color: #4ecdc4; font-size: 0.8em;">RR: 1:${rr1.toFixed(2)}</div>
                    </div>
                    <div style="padding: 15px; background: rgba(78, 205, 196, 0.1); border-radius: 8px;">
                        <div style="color: #4ecdc4; font-weight: bold; margin-bottom: 5px;">TP2 Reward</div>
                        <div style="color: #fff; font-size: 1.3em;">$${reward2.toFixed(2)}</div>
                        <div style="color: #4ecdc4; font-size: 0.8em;">RR: 1:${rr2.toFixed(2)}</div>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                    <div style="color: ${rr1 >= 2 ? '#4ecdc4' : rr1 >= 1 ? '#ffd700' : '#ff6b6b'}; font-weight: bold; font-size: 1.1em;">
                        TP1 Risk/Reward: ${rr1 >= 2 ? 'âœ… Ä°deal' : rr1 >= 1 ? 'âš ï¸ Makul' : 'âŒ DÃ¼ÅŸÃ¼k'}
                    </div>
                    <div style="color: ${rr2 >= 3 ? '#4ecdc4' : rr2 >= 2 ? '#ffd700' : '#ff6b6b'}; font-weight: bold; font-size: 1.1em; margin-top: 10px;">
                        TP2 Risk/Reward: ${rr2 >= 3 ? 'âœ… MÃ¼kemmel' : rr2 >= 2 ? 'âš ï¸ Ä°yi' : 'âŒ DÃ¼ÅŸÃ¼k'}
                    </div>
                </div>
            `;
            
            document.getElementById('riskRewardResult').innerHTML = result;
            document.getElementById('riskRewardResult').style.display = 'block';
        }

        // Leverage Calculator
        function calculateLeverage() {
            const margin = parseFloat(document.getElementById('marginAmount').value) || 0;
            const leverage = parseFloat(document.getElementById('leverageAmount').value) || 1;
            const entryPrice = parseFloat(document.getElementById('levEntryPrice').value) || 0;
            
            if (!margin || !leverage || !entryPrice) {
                document.getElementById('leverageResult').innerHTML = 
                    '<div style="color: #ff6b6b;">âš ï¸ LÃ¼tfen tÃ¼m alanlarÄ± doldurun!</div>';
                document.getElementById('leverageResult').style.display = 'block';
                return;
            }
            
            const positionValue = margin * leverage;
            const positionSize = positionValue / entryPrice;
            
            // Liquidation hesaplamasÄ± (basitleÅŸtirilmiÅŸ)
            const liquidationPercent = 100 / leverage;
            const liquidationPriceLong = entryPrice * (1 - liquidationPercent / 100);
            const liquidationPriceShort = entryPrice * (1 + liquidationPercent / 100);
            
            const result = `
                <div style="color: #ff6b6b; font-weight: bold; font-size: 1.2em; margin-bottom: 15px;">âš¡ Leverage Hesaplama</div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                    <div style="padding: 15px; background: rgba(255, 107, 107, 0.1); border-radius: 8px;">
                        <div style="color: #ff6b6b; font-weight: bold; margin-bottom: 5px;">Pozisyon DeÄŸeri</div>
                        <div style="color: #fff; font-size: 1.3em;">$${positionValue.toFixed(2)}</div>
                    </div>
                    <div style="padding: 15px; background: rgba(255, 215, 0, 0.1); border-radius: 8px;">
                        <div style="color: #ffd700; font-weight: bold; margin-bottom: 5px;">Pozisyon Boyutu</div>
                        <div style="color: #fff; font-size: 1.3em;">${positionSize.toFixed(4)}</div>
                    </div>
                    <div style="padding: 15px; background: rgba(78, 205, 196, 0.1); border-radius: 8px;">
                        <div style="color: #4ecdc4; font-weight: bold; margin-bottom: 5px;">Leverage</div>
                        <div style="color: #fff; font-size: 1.3em;">${leverage}x</div>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: rgba(255,107,107,0.1); border-radius: 8px;">
                    <div style="color: #ff6b6b; font-weight: bold; margin-bottom: 10px;">âš ï¸ Likidasyon Seviyeleri</div>
                    <div style="color: #fff;">LONG Liquidation: $${liquidationPriceLong.toFixed(2)} (${liquidationPercent.toFixed(2)}% dÃ¼ÅŸÃ¼ÅŸ)</div>
                    <div style="color: #fff; margin-top: 5px;">SHORT Liquidation: $${liquidationPriceShort.toFixed(2)} (${liquidationPercent.toFixed(2)}% yÃ¼kseliÅŸ)</div>
                    <div style="color: #aaa; font-size: 0.85em; margin-top: 10px;">
                        âš ï¸ YÃ¼ksek leverage yÃ¼ksek risk demektir! Dikkatli kullanÄ±n.
                    </div>
                </div>
            `;
            
            document.getElementById('leverageResult').innerHTML = result;
            document.getElementById('leverageResult').style.display = 'block';
        }

        // Correlation Analyzer
        async function analyzeCorrelation() {
            const baseCoin = document.getElementById('baseCoin').value;
            const compareCoinsText = document.getElementById('compareCoins').value;
            const period = parseInt(document.getElementById('correlationPeriod').value) || 30;
            
            if (!compareCoinsText) {
                document.getElementById('correlationResult').innerHTML = 
                    '<div style="color: #ff6b6b;">âš ï¸ LÃ¼tfen karÅŸÄ±laÅŸtÄ±rÄ±lacak coinleri girin!</div>';
                document.getElementById('correlationResult').style.display = 'block';
                return;
            }
            
            const compareCoins = compareCoinsText.split(',').map(c => c.trim());
            const resultDiv = document.getElementById('correlationResult');
            resultDiv.innerHTML = '<div style="color: #ffd700;">â³ Korelasyon analizi hesaplanÄ±yor...</div>';
            resultDiv.style.display = 'block';
            
            try {
                // BasitleÅŸtirilmiÅŸ korelasyon hesaplamasÄ± (gerÃ§ek veri yerine Ã¶rnek)
                // GerÃ§ek implementasyonda CoinGecko API'den fiyat verileri Ã§ekilmeli
                let resultHTML = `
                    <div style="color: #9b59b6; font-weight: bold; font-size: 1.2em; margin-bottom: 15px;">ðŸ”— Korelasyon Analizi</div>
                    <div style="margin-bottom: 15px; color: #aaa;">
                        Ana Coin: <strong style="color: #fff;">${baseCoin}</strong><br>
                        Periyot: <strong style="color: #fff;">${period} gÃ¼n</strong>
                    </div>
                `;
                
                for (const coin of compareCoins) {
                    if (!realPrices[coin]) {
                        resultHTML += `
                            <div style="padding: 10px; background: rgba(255,107,107,0.1); border-radius: 8px; margin-bottom: 10px;">
                                <div style="color: #ff6b6b;">âš ï¸ ${coin} iÃ§in veri bulunamadÄ±</div>
                            </div>
                        `;
                        continue;
                    }
                    
                    // Basit korelasyon hesaplamasÄ± (Ã¶rnek)
                    const baseChange = realPrices[baseCoin]?.change || 0;
                    const coinChange = realPrices[coin]?.change || 0;
                    
                    // Basit korelasyon skoru
                    const correlation = Math.abs(baseChange - coinChange) < 2 ? 0.8 : 
                                      Math.abs(baseChange - coinChange) < 5 ? 0.5 : 0.2;
                    
                    const correlationColor = correlation > 0.7 ? '#4ecdc4' : correlation > 0.4 ? '#ffd700' : '#ff6b6b';
                    const correlationText = correlation > 0.7 ? 'YÃ¼ksek' : correlation > 0.4 ? 'Orta' : 'DÃ¼ÅŸÃ¼k';
                    
                    resultHTML += `
                        <div style="padding: 15px; background: rgba(155,89,182,0.1); border-radius: 8px; margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="color: #fff; font-weight: bold; font-size: 1.1em;">${coin}</div>
                                    <div style="color: #aaa; font-size: 0.9em;">DeÄŸiÅŸim: ${coinChange.toFixed(2)}%</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="color: ${correlationColor}; font-size: 1.5em; font-weight: bold;">${(correlation * 100).toFixed(0)}%</div>
                                    <div style="color: ${correlationColor}; font-size: 0.9em;">${correlationText} Korelasyon</div>
                                </div>
                            </div>
                            <div style="margin-top: 10px; background: rgba(0,0,0,0.2); border-radius: 5px; overflow: hidden; height: 10px;">
                                <div style="height: 100%; background: linear-gradient(90deg, ${correlationColor}, ${correlationColor}88); width: ${correlation * 100}%; transition: width 0.5s;"></div>
                            </div>
                        </div>
                    `;
                }
                
                resultDiv.innerHTML = resultHTML;
            } catch (error) {
                resultDiv.innerHTML = `<div style="color: #ff6b6b;">âŒ Hata: ${error.message}</div>`;
            }
        }

        // Portfolio Tracker
        let portfolioData = JSON.parse(localStorage.getItem('portfolioData') || '[]');
        
        function addToPortfolio() {
            const coin = document.getElementById('portfolioCoin').value.trim();
            const amount = parseFloat(document.getElementById('portfolioAmount').value) || 0;
            const entryPrice = parseFloat(document.getElementById('portfolioEntry').value) || 0;
            const positionType = document.getElementById('portfolioType').value;
            
            if (!coin || !amount || !entryPrice) {
                alert('âš ï¸ LÃ¼tfen tÃ¼m alanlarÄ± doldurun!');
                return;
            }
            
            const entry = {
                coin,
                amount,
                entryPrice,
                positionType,
                timestamp: new Date().toISOString()
            };
            
            portfolioData.push(entry);
            localStorage.setItem('portfolioData', JSON.stringify(portfolioData));
            
            updatePortfolioList();
            
            // Formu temizle
            document.getElementById('portfolioCoin').value = '';
            document.getElementById('portfolioAmount').value = '';
            document.getElementById('portfolioEntry').value = '';
        }
        
        function updatePortfolioList() {
            const container = document.getElementById('portfolioList');
            if (!container) return;
            
            if (portfolioData.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #aaa; padding: 40px;">PortfÃ¶yÃ¼nÃ¼zde henÃ¼z pozisyon yok</div>';
                return;
            }
            
            let totalPnL = 0;
            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">';
            
            portfolioData.forEach((entry, index) => {
                const currentPrice = realPrices[entry.coin]?.price || entry.entryPrice;
                const pnl = entry.positionType === 'long' 
                    ? (currentPrice - entry.entryPrice) * entry.amount
                    : (entry.entryPrice - currentPrice) * entry.amount;
                const pnlPercent = entry.positionType === 'long'
                    ? ((currentPrice - entry.entryPrice) / entry.entryPrice) * 100
                    : ((entry.entryPrice - currentPrice) / entry.entryPrice) * 100;
                
                totalPnL += pnl;
                
                const pnlColor = pnl >= 0 ? '#4ecdc4' : '#ff6b6b';
                const pnlIcon = pnl >= 0 ? 'ðŸ“ˆ' : 'ðŸ“‰';
                
                html += `
                    <div style="padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px; border: 2px solid ${pnlColor}33;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <div>
                                <div style="color: #fff; font-weight: bold; font-size: 1.2em;">${entry.coin}</div>
                                <div style="color: #aaa; font-size: 0.9em;">${entry.positionType === 'long' ? 'ðŸŸ¢ LONG' : 'ðŸ”´ SHORT'}</div>
                            </div>
                            <button onclick="removePortfolioEntry(${index})" style="padding: 5px 10px; background: rgba(255,107,107,0.2); border: 1px solid #ff6b6b; border-radius: 5px; color: #ff6b6b; cursor: pointer;">ðŸ—‘ï¸</button>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <div style="color: #aaa; font-size: 0.85em;">Miktar: <span style="color: #fff;">${entry.amount}</span></div>
                            <div style="color: #aaa; font-size: 0.85em;">Entry: <span style="color: #fff;">$${entry.entryPrice.toFixed(2)}</span></div>
                            <div style="color: #aaa; font-size: 0.85em;">GÃ¼ncel: <span style="color: #fff;">$${currentPrice.toFixed(2)}</span></div>
                        </div>
                        <div style="padding: 10px; background: rgba(${pnl >= 0 ? '78, 205, 196' : '255, 107, 107'}, 0.1); border-radius: 8px;">
                            <div style="color: ${pnlColor}; font-weight: bold; font-size: 1.1em;">
                                ${pnlIcon} P&L: $${pnl.toFixed(2)} (${pnlPercent >= 0 ? '+' : ''}${pnlPercent.toFixed(2)}%)
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            
            html += `
                <div style="margin-top: 20px; padding: 20px; background: rgba(255,215,0,0.1); border-radius: 10px; text-align: center;">
                    <div style="color: #ffd700; font-weight: bold; font-size: 1.3em; margin-bottom: 5px;">Toplam P&L</div>
                    <div style="color: ${totalPnL >= 0 ? '#4ecdc4' : '#ff6b6b'}; font-size: 2em; font-weight: bold;">
                        ${totalPnL >= 0 ? 'ðŸ“ˆ' : 'ðŸ“‰'} $${totalPnL.toFixed(2)}
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }
        
        function removePortfolioEntry(index) {
            portfolioData.splice(index, 1);
            localStorage.setItem('portfolioData', JSON.stringify(portfolioData));
            updatePortfolioList();
        }
        
        // Sayfa yÃ¼klendiÄŸinde portfÃ¶yÃ¼ gÃ¼ncelle
        if (document.getElementById('portfolioList')) {
            updatePortfolioList();
            setInterval(updatePortfolioList, 30000); // Her 30 saniyede bir gÃ¼ncelle
        }

        // ===== COIN ARAMA FONKSÄ°YONLARI =====
        let allAvailableCoins = [];
        let coinSearchCache = {};

        // TÃ¼m mevcut coinleri yÃ¼kle
        async function loadAllAvailableCoins() {
            try {
                // Ã–nce 7 borsadan coinleri al
                const exchanges = ['binance', 'okx', 'bybit', 'mexc', 'kucoin', 'gate', 'huobi'];
                const coinSet = new Set();
                
                for (const exchange of exchanges) {
                    try {
                        let symbols = [];
                        
                        if (exchange === 'binance') {
                            const response = await fetch('https://api.binance.com/api/v3/exchangeInfo');
                            const data = await response.json();
                            symbols = data.symbols
                                .filter(s => s.quoteAsset === 'USDT' && s.status === 'TRADING')
                                .map(s => `${s.baseAsset}/USDT`);
                        } else if (exchange === 'okx') {
                            const response = await fetch('https://www.okx.com/api/v5/public/instruments?instType=SPOT');
                            const data = await response.json();
                            symbols = (data.data || [])
                                .filter(s => s.settleCcy === 'USDT' && s.state === 'live')
                                .map(s => s.instId.replace('-', '/'));
                        } else if (exchange === 'bybit') {
                            const response = await fetch('https://api.bybit.com/v5/market/instruments-info?category=spot');
                            const data = await response.json();
                            symbols = (data.result?.list || [])
                                .filter(s => s.quoteCoin === 'USDT' && s.status === 'Trading')
                                .map(s => `${s.baseCoin}/USDT`);
                        } else if (exchange === 'mexc') {
                            const response = await fetch('https://api.mexc.com/api/v3/exchangeInfo');
                            const data = await response.json();
                            symbols = (data.symbols || [])
                                .filter(s => s.symbol.endsWith('USDT') && s.status === 'ENABLED')
                                .map(s => s.symbol.replace('USDT', '/USDT'));
                        } else if (exchange === 'kucoin') {
                            const response = await fetch('https://api.kucoin.com/api/v1/symbols');
                            const data = await response.json();
                            symbols = (data.data || [])
                                .filter(s => s.quoteCurrency === 'USDT' && s.enableTrading)
                                .map(s => `${s.baseCurrency}/USDT`);
                        } else if (exchange === 'gate') {
                            const response = await fetch('https://api.gateio.ws/api/v4/spot/currency_pairs');
                            const data = await response.json();
                            symbols = (data || [])
                                .filter(s => s.quote === 'USDT' && s.trade_status === 'tradable')
                                .map(s => `${s.base}/USDT`);
                        } else if (exchange === 'huobi') {
                            // Huobi API (eÄŸer eriÅŸilebilirse)
                            try {
                                const response = await fetch('https://api.huobi.pro/v1/common/symbols');
                                const data = await response.json();
                                symbols = (data.data || [])
                                    .filter(s => s.quoteCurrency === 'usdt' && s.state === 'online')
                                    .map(s => `${s.baseCurrency.toUpperCase()}/USDT`);
                            } catch (e) {
                                symbols = [];
                            }
                        }
                        
                        symbols.forEach(coin => coinSet.add(coin.toUpperCase()));
                        console.log(`âœ… ${exchange}: ${symbols.length} coin eklendi`);
                    } catch (error) {
                        console.log(`âš ï¸ ${exchange} API hatasÄ±:`, error);
                    }

                }
                
                // RealPrices'dan da ekle
                Object.keys(realPrices).forEach(coin => coinSet.add(coin.toUpperCase()));
                
                allAvailableCoins = Array.from(coinSet).sort();
                console.log(`âœ… ${allAvailableCoins.length} coin yÃ¼klendi`);
                
                return allAvailableCoins;
            } catch (error) {
                console.error('âŒ Coin yÃ¼kleme hatasÄ±:', error);
                return Object.keys(realPrices).map(c => c.toUpperCase());
            }
        }

        // Coin arama filtreleme
        function filterCoinSearch(query) {
            const resultsDiv = document.getElementById('coinSearchResults');
            if (!resultsDiv) return;
            
            if (!query || query.length < 1) {
                resultsDiv.style.display = 'none';
                return;
            }
            
            const queryUpper = query.toUpperCase();
            const matches = allAvailableCoins
                .filter(coin => coin.includes(queryUpper) || coin.replace('/USDT', '').includes(queryUpper))
                .slice(0, 10);
            
            if (matches.length === 0) {
                resultsDiv.innerHTML = '<div style="padding: 15px; text-align: center; color: #aaa;">Coin bulunamadÄ±</div>';
                resultsDiv.style.display = 'block';
                return;
            }
            
            resultsDiv.innerHTML = matches.map(coin => `
                <div onclick="selectCoinFromSearch('${coin}')" 
                     style="padding: 12px; margin: 5px 0; background: rgba(255,215,0,0.1); 
                            border-radius: 8px; cursor: pointer; transition: all 0.3s;
                            border: 1px solid rgba(255,215,0,0.2);"
                     onmouseover="this.style.background='rgba(255,215,0,0.2)'; this.style.transform='translateX(5px)'"
                     onmouseout="this.style.background='rgba(255,215,0,0.1)'; this.style.transform='translateX(0)'">
                    <div style="font-weight: bold; color: #ffd700;">${coin}</div>
                    ${realPrices[coin] ? `<div style="font-size: 0.85em; color: #aaa;">$${realPrices[coin].price.toFixed(4)}</div>` : ''}
                </div>
            `).join('');
            
            resultsDiv.style.display = 'block';
        }

        // Arama sonuÃ§larÄ±ndan coin seÃ§me
        function selectCoinFromSearch(coin) {
            document.getElementById('coinSearchInput').value = coin;
            document.getElementById('coinSearchResults').style.display = 'none';
            searchAndAnalyzeCoin();
        }

        // Coin arama ve analiz - GeliÅŸtirilmiÅŸ versiyon
        async function searchAndAnalyzeCoin(event) {
            if (event) event.preventDefault();
            
            const searchInput = document.getElementById('coinSearchInput');
            const query = (searchInput?.value || '').trim().toUpperCase();
            
            if (!query) {
                alert('âš ï¸ LÃ¼tfen bir coin adÄ± girin!');
                return;
            }
            
            // Coin formatÄ±nÄ± dÃ¼zelt (USDT ekle)
            let coinSymbol = query;
            if (!coinSymbol.includes('/')) {
                coinSymbol = `${coinSymbol}/USDT`;
            }
            
            // Results tab'Ä±na geÃ§
            switchTab('results', event);
            
            // Loading gÃ¶ster
            const loadingSection = document.getElementById('loadingSection');
            if (loadingSection) {
                loadingSection.style.display = 'block';
            }
            
            try {
                let priceData = null;
                let foundExchange = null;
                
                // Ã–nce tÃ¼m borsalardan coin'i ara
                const exchanges = [
                    { name: 'BINANCE', symbol: coinSymbol.replace('/USDT', 'USDT'), api: 'https://api.binance.com/api/v3/ticker/24hr?symbol=' },
                    { name: 'OKX', symbol: coinSymbol.replace('/USDT', '-USDT'), api: 'https://www.okx.com/api/v5/market/ticker?instId=' },
                    { name: 'BYBIT', symbol: coinSymbol.replace('/USDT', 'USDT'), api: 'https://api.bybit.com/v5/market/tickers?category=spot&symbol=' },
                    { name: 'MEXC', symbol: coinSymbol.replace('/USDT', '_USDT'), api: 'https://api.mexc.com/api/v3/ticker/24hr?symbol=' },
                    { name: 'KUCOIN', symbol: coinSymbol.replace('/USDT', '-USDT'), api: 'https://api.kucoin.com/api/v1/market/stats?symbol=' },
                    { name: 'GATE', symbol: coinSymbol.replace('/USDT', '_USDT'), api: 'https://api.gateio.ws/api/v4/spot/tickers?currency_pair=' },
                    { name: 'HUOBI', symbol: coinSymbol.replace('/USDT', 'usdt').toLowerCase(), api: 'https://api.huobi.pro/market/detail/merged?symbol=' }
                ];
                
                // Her borsadan dene
                for (const exchange of exchanges) {
                    try {
                        let response;
                        let data;
                        
                        if (exchange.name === 'OKX') {
                            response = await fetch(`${exchange.api}${exchange.symbol}`);
                            const result = await response.json();
                            if (result.data && result.data[0]) {
                                data = result.data[0];
                                priceData = {
                                    price: parseFloat(data.last),
                                    change: parseFloat(data.lastPx) || 0,
                                    volume: parseFloat(data.vol24h || data.volCcy24h) || 0,
                                    high24h: parseFloat(data.high24h) || 0,
                                    low24h: parseFloat(data.low24h) || 0,
                                    source: exchange.name
                                };
                                foundExchange = exchange.name;
                                break;
                            }
                        } else if (exchange.name === 'BYBIT') {
                            response = await fetch(`${exchange.api}${exchange.symbol}`);
                            const result = await response.json();
                            if (result.result && result.result.list && result.result.list.length > 0) {
                                data = result.result.list[0];
                                priceData = {
                                    price: parseFloat(data.lastPrice),
                                    change: parseFloat(data.price24hPcnt) * 100 || 0,
                                    volume: parseFloat(data.volume24h) || 0,
                                    high24h: parseFloat(data.highPrice24h) || 0,
                                    low24h: parseFloat(data.lowPrice24h) || 0,
                                    source: exchange.name
                                };
                                foundExchange = exchange.name;
                                break;
                            }
                        } else if (exchange.name === 'KUCOIN') {
                            response = await fetch(`${exchange.api}${exchange.symbol}`);
                            const result = await response.json();
                            if (result.data) {
                                data = result.data;
                                priceData = {
                                    price: parseFloat(data.last),
                                    change: parseFloat(data.changeRate) * 100 || 0,
                                    volume: parseFloat(data.vol) || 0,
                                    high24h: parseFloat(data.high) || 0,
                                    low24h: parseFloat(data.low) || 0,
                                    source: exchange.name
                                };
                                foundExchange = exchange.name;
                                break;
                            }
                        } else if (exchange.name === 'GATE') {
                            response = await fetch(`${exchange.api}${exchange.symbol}`);
                            const result = await response.json();
                            if (result && result.length > 0) {
                                data = result[0];
                                priceData = {
                                    price: parseFloat(data.last),
                                    change: parseFloat(data.change_percentage) || 0,
                                    volume: parseFloat(data.base_volume) || 0,
                                    high24h: parseFloat(data.high_24h) || 0,
                                    low24h: parseFloat(data.low_24h) || 0,
                                    source: exchange.name
                                };
                                foundExchange = exchange.name;
                                break;
                            }
                        } else if (exchange.name === 'HUOBI') {
                            response = await fetch(`${exchange.api}${exchange.symbol}`);
                            const result = await response.json();
                            if (result && result.status === 'ok' && result.tick) {
                                data = result.tick;
                                priceData = {
                                    price: parseFloat(data.close),
                                    change: 0,
                                    volume: parseFloat(data.vol) || 0,
                                    high24h: parseFloat(data.high) || 0,
                                    low24h: parseFloat(data.low) || 0,
                                    source: exchange.name
                                };
                                foundExchange = exchange.name;
                                break;
                            }
                        } else {
                            // Binance ve MEXC iÃ§in standart format
                            response = await fetch(`${exchange.api}${exchange.symbol}`);
                            data = await response.json();
                            
                            if (data && data.lastPrice) {
                                priceData = {
                                    price: parseFloat(data.lastPrice),
                                    change: parseFloat(data.priceChangePercent || data.priceChangePercent || 0),
                                    volume: parseFloat(data.volume || 0),
                                    high24h: parseFloat(data.highPrice || data.high || 0),
                                    low24h: parseFloat(data.lowPrice || data.low || 0),
                                    source: exchange.name
                                };
                                foundExchange = exchange.name;
                                break;
                            }
                        }
                    } catch (error) {
                        console.log(`âš ï¸ ${exchange.name} denemesi baÅŸarÄ±sÄ±z:`, error);
                        continue;
                    }
                }
                
                // EÄŸer hiÃ§bir borsada bulunamadÄ±ysa
                if (!priceData) {
                    throw new Error(`âŒ "${query}" coin'i hiÃ§bir borsada bulunamadÄ±. LÃ¼tfen coin adÄ±nÄ± kontrol edin.`);
                }
                
                // RealPrices'a ekle
                realPrices[coinSymbol] = priceData;
                
                // Coin'i allAvailableCoins'e ekle (yoksa)
                if (!allAvailableCoins.includes(coinSymbol.toUpperCase())) {
                    allAvailableCoins.push(coinSymbol.toUpperCase());
                    allAvailableCoins.sort();
                }
                
                // Teknik analiz hesapla - Ã–nce Binance formatÄ±nÄ± dene, yoksa bulunduÄŸu borsadan
                let symbol = coinSymbol.replace('/USDT', 'USDT');
                if (foundExchange === 'OKX') {
                    symbol = coinSymbol.replace('/USDT', '-USDT');
                } else if (foundExchange === 'MEXC') {
                    symbol = coinSymbol.replace('/USDT', '_USDT');
                } else if (foundExchange === 'KUCOIN' || foundExchange === 'GATE') {
                    symbol = coinSymbol.replace('/USDT', '-USDT');
                }
                
                try {
                    await calculateTechnicalIndicatorsForCoin(coinSymbol, coinSymbol.replace('/USDT', 'USDT'));
                } catch (techError) {
                    console.warn('âš ï¸ Teknik analiz hatasÄ±, devam ediliyor:', techError);
                }
                
                // SonuÃ§larÄ± gÃ¶ster
                const indicators = technicalIndicators[coinSymbol] || {};
                const score = calculateRealScore(coinSymbol, priceData);
                const signal = determineRealSignal(coinSymbol, priceData, score);
                
                // Modal'Ä± aÃ§
                showCoinDetailModal(coinSymbol, priceData, score, signal, indicators);
                
                // SonuÃ§larÄ± results container'a ekle
                const resultsContainer = signal === 'long' ? 
                    document.getElementById('longResultsContainer') : 
                    signal === 'short' ? 
                    document.getElementById('shortResultsContainer') : 
                    document.getElementById('waitResultsContainer');
                
                if (resultsContainer) {
                    const card = createCompleteResultCard(coinSymbol, priceData, score, signal);
                    resultsContainer.innerHTML = card;
                }
                
                // BaÅŸarÄ± mesajÄ±
                console.log(`âœ… Coin bulundu: ${coinSymbol} - ${foundExchange}`);
                
                // Loading'i gizle
                if (loadingSection) {
                    loadingSection.style.display = 'none';
                }
                
            } catch (error) {
                console.error('âŒ Coin analiz hatasÄ±:', error);
                alert(`âŒ ${error.message}`);
                
                if (loadingSection) {
                    loadingSection.style.display = 'none';
                }
            }
        }

        // Tek bir coin iÃ§in teknik analiz
        async function calculateTechnicalIndicatorsForCoin(coin, symbol) {
            try {
                const timeframe = selectedTimeframe || '15m';
                const interval = timeframe === '1m' ? '1m' : 
                               timeframe === '5m' ? '5m' :
                               timeframe === '15m' ? '15m' :
                               timeframe === '30m' ? '30m' :
                               timeframe === '1h' ? '1h' :
                               timeframe === '4h' ? '4h' : '1d';
                
                // Binance'den klines al
                const response = await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=${interval}&limit=200`);
                const klines = await response.json();
                
                if (!klines || klines.length < 50) {
                    throw new Error('Yeterli mum verisi yok');
                }
                
                const volumes = klines.map(k => parseFloat(k[5]));
                const avgVolume = volumes.reduce((a, b) => a + b, 0) / volumes.length;
                const currentVolume = volumes[volumes.length - 1];
                
                // TÃ¼m indikatÃ¶rleri hesapla
                const indicators90 = calculate90Indicators(klines, currentVolume, avgVolume);
                const institutional = analyzeInstitutional(klines, volumes);
                const whales = analyzeWhales(klines, avgVolume);
                const marketMakers = analyzeMarketMakers(klines);
                const smartMoneyConcepts = analyzeSmartMoneyConcepts(klines);
                const traders = analyzeTraders(klines, institutional);
                const pumpDump = analyzePumpDump(klines, calculateBollingerBands(klines.map(k => parseFloat(k[4])), 20), currentVolume, avgVolume);
                const trendBreak = analyzeTrendBreak(klines);
                const peaksAndDips = analyzePeaksAndDips(klines);
                
                // Temel indikatÃ¶rler
                const closes = klines.map(k => parseFloat(k[4]));
                const highs = klines.map(k => parseFloat(k[2]));
                const lows = klines.map(k => parseFloat(k[3]));
                
                technicalIndicators[coin] = {
                    ...calculateTechnicalIndicatorsBasic(klines, highs, lows, closes, volumes),
                    indicators90,
                    institutional,
                    whales,
                    marketMakers,
                    smartMoneyConcepts,
                    traders,
                    pumpDump,
                    trendBreak,
                    peaksAndDips
                };
                
            } catch (error) {
                console.error(`âŒ ${coin} teknik analiz hatasÄ±:`, error);
                throw error;
            }
        }

        // Temel teknik indikatÃ¶rler
        function calculateTechnicalIndicatorsBasic(klines, highs, lows, closes, volumes) {
            const rsi = calculateRSI(closes, 14);
            const macd = calculateMACD(closes);
            const ema9 = calculateEMA(closes, 9);
            const ema21 = calculateEMA(closes, 21);
            const ema50 = calculateEMA(closes, 50);
            const bb = calculateBollingerBands(closes, 20);
            const stoch = calculateStochastic(highs, lows, closes, 14);
            const adx = calculateADX(highs, lows, closes, 14);
            const atr = calculateATR(highs, lows, closes, 14);
            const vwap = calculateVWAP(klines);
            const cvd = calculateCVD(klines);
            
            return {
                rsi: rsi[rsi.length - 1],
                macd: macd.macd[macd.macd.length - 1],
                macdSignal: macd.signal[macd.signal.length - 1],
                macdHistogram: macd.histogram[macd.histogram.length - 1],
                ema9: ema9[ema9.length - 1],
                ema21: ema21[ema21.length - 1],
                ema50: ema50[ema50.length - 1],
                trend: ema9[ema9.length - 1] > ema50[ema50.length - 1] ? 'UP' : 'DOWN',
                bbUpper: bb.upper[bb.upper.length - 1],
                bbMiddle: bb.middle[bb.middle.length - 1],
                bbLower: bb.lower[bb.lower.length - 1],
                stochastic: stoch.k[stoch.k.length - 1],
                stochasticD: stoch.d[stoch.d.length - 1],
                adx: adx[adx.length - 1],
                atr: atr,
                vwap: vwap[vwap.length - 1],
                cvdTrend: cvd > 0 ? 'BULLISH' : cvd < 0 ? 'BEARISH' : 'NEUTRAL',
                volumeRatio: volumes[volumes.length - 1] / (volumes.reduce((a, b) => a + b, 0) / volumes.length)
            };
        }

        // Sayfa yÃ¼klendiÄŸinde tÃ¼m coinleri yÃ¼kle
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => loadAllAvailableCoins(), 2000);
        });
    </script>

    <!-- DetaylÄ± Coin Analiz Modal -->
    <div id="coinDetailModal" class="coin-detail-modal">
        <div class="modal-content" id="coinDetailContent">
            <!-- Ä°Ã§erik JavaScript ile doldurulacak -->
        </div>
    </div>
</body>
</html>


